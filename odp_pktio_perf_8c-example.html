<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>API Reference Manual: odp_pktio_perf.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="odpdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ODP-Logo-HQ.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">API Reference Manual
   &#160;<span id="projectnumber">1.48.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('odp_pktio_perf_8c-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">odp_pktio_perf.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Packet IO basic performance test application. Runs a number of transmit and receive workers on separate cores, the transmitters generate packets at a defined rate and the receivers consume them. Generated packets are UDP and each packet is marked with a magic number in the UDP payload allowing receiver to distinguish them from other traffic.</p>
<p>Each test iteration runs for a fixed period, at the end of the iteration it is verified that the number of packets transmitted was as expected and that all transmitted packets were received.</p>
<p>The default mode is to run multiple test iterations at different rates to determine the maximum rate at which no packet loss occurs. Alternatively a single packet rate can be specified on the command line.</p>
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2015-2018 Linaro Limited</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="odp__api_8h.html">odp_api.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;odp/helper/odph_api.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TEST_SKIP 77</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define PKT_BUF_NUM       (32 * 1024)</span></div>
<div class="line"><span class="preprocessor">#define MAX_NUM_IFACES    2</span></div>
<div class="line"><span class="preprocessor">#define TEST_HDR_MAGIC    0x92749451</span></div>
<div class="line"><span class="preprocessor">#define MAX_WORKERS       (ODP_THREAD_COUNT_MAX - 1)</span></div>
<div class="line"><span class="preprocessor">#define BATCH_LEN_MAX     32</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Packet rate at which to start when using binary search */</span></div>
<div class="line"><span class="preprocessor">#define RATE_SEARCH_INITIAL_PPS 1000000</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* When using the binary search method to determine the maximum</span></div>
<div class="line"><span class="comment"> * achievable packet rate, this value specifies how close the pass</span></div>
<div class="line"><span class="comment"> * and fail measurements must be before the test is terminated. */</span></div>
<div class="line"><span class="preprocessor">#define RATE_SEARCH_ACCURACY_PPS 100000</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Amount of time to wait, in nanoseconds, between the transmitter(s)</span></div>
<div class="line"><span class="comment"> * completing and the receiver(s) being shutdown. Any packets not</span></div>
<div class="line"><span class="comment"> * received by this time will be assumed to have been lost. */</span></div>
<div class="line"><span class="preprocessor">#define SHUTDOWN_DELAY_NS (ODP_TIME_MSEC_IN_NS * 100)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Number of duration units in a second. */</span></div>
<div class="line"><span class="preprocessor">#define T_SCALE 10</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Default test duration in T_SCALE units */</span></div>
<div class="line"><span class="preprocessor">#define DEFAULT_DURATION 1</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define PKT_HDR_LEN (sizeof(pkt_head_t) + ODPH_UDPHDR_LEN + \</span></div>
<div class="line"><span class="preprocessor">             ODPH_IPV4HDR_LEN + ODPH_ETHHDR_LEN)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cpu_count; <span class="comment">/* CPU count */</span></div>
<div class="line">    <span class="keywordtype">int</span>      num_tx_workers;<span class="comment">/* Number of CPUs to use for transmit */</span></div>
<div class="line">    <span class="keywordtype">int</span>      duration;  <span class="comment">/* Time to run each iteration of the test for */</span></div>
<div class="line">    uint32_t tx_batch_len;  <span class="comment">/* Number of packets to send in a single</span></div>
<div class="line"><span class="comment">                   batch */</span></div>
<div class="line">    <span class="keywordtype">int</span>      schedule;  <span class="comment">/* 1: receive packets via scheduler</span></div>
<div class="line"><span class="comment">                   0: receive packets via direct deq */</span></div>
<div class="line">    uint32_t rx_batch_len;  <span class="comment">/* Number of packets to receive in a single</span></div>
<div class="line"><span class="comment">                   batch */</span></div>
<div class="line">    uint64_t pps;       <span class="comment">/* Attempted packet rate */</span></div>
<div class="line">    <span class="keywordtype">int</span>      verbose;   <span class="comment">/* Print verbose information, such as per</span></div>
<div class="line"><span class="comment">                   thread statistics */</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> pkt_len;   <span class="comment">/* Packet payload length in bytes (not</span></div>
<div class="line"><span class="comment">                   including headers) */</span></div>
<div class="line">    <span class="keywordtype">int</span>      search;    <span class="comment">/* Set implicitly when pps is not configured.</span></div>
<div class="line"><span class="comment">                   Perform a search at different packet rates</span></div>
<div class="line"><span class="comment">                   to determine the maximum rate at which no</span></div>
<div class="line"><span class="comment">                   packet loss occurs. */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span>     *if_str;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *ifaces[MAX_NUM_IFACES];</div>
<div class="line">    <span class="keywordtype">int</span>      num_ifaces;</div>
<div class="line">} test_args_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a name="a0"></a><a class="code" href="group__odp__compiler__optim.html#ga205a8257879c02657e7c39ee7ad5e40a">ODP_ALIGNED_CACHE</a> {</div>
<div class="line">    uint64_t rx_cnt;    <span class="comment">/* Valid packets received */</span></div>
<div class="line">    uint64_t rx_ignore; <span class="comment">/* Ignored packets */</span></div>
<div class="line">} pkt_rx_stats_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="group__odp__compiler__optim.html#ga205a8257879c02657e7c39ee7ad5e40a">ODP_ALIGNED_CACHE</a> {</div>
<div class="line">    uint64_t tx_cnt;    <span class="comment">/* Packets transmitted */</span></div>
<div class="line">    uint64_t alloc_failures;<span class="comment">/* Packet allocation failures */</span></div>
<div class="line">    uint64_t enq_failures;  <span class="comment">/* Enqueue failures */</span></div>
<div class="line">    <a name="_a1"></a><a class="code" href="structodp__time__s.html">odp_time_t</a> idle_ticks;  <span class="comment">/* Idle ticks count in TX loop */</span></div>
<div class="line">} pkt_tx_stats_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Test global variables */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <a class="code" href="group__odp__initialization.html#ga8d362bd3c7c87ab5892ca63b15c375c0">odp_instance_t</a> instance;</div>
<div class="line">    test_args_t args;</div>
<div class="line">    <a name="_a2"></a><a class="code" href="structodp__barrier__s.html">odp_barrier_t</a> rx_barrier;</div>
<div class="line">    <a class="code" href="structodp__barrier__s.html">odp_barrier_t</a> tx_barrier;</div>
<div class="line">    <a name="_a3"></a><a class="code" href="struct__odp__abi__pktio__t.html">odp_pktio_t</a> pktio_tx;</div>
<div class="line">    <a class="code" href="struct__odp__abi__pktio__t.html">odp_pktio_t</a> pktio_rx;</div>
<div class="line">    <span class="comment">/* Pool from which transmitted packets are allocated */</span></div>
<div class="line">    <a name="_a4"></a><a class="code" href="struct__odp__abi__pool__t.html">odp_pool_t</a> transmit_pkt_pool;</div>
<div class="line">    pkt_rx_stats_t *rx_stats;</div>
<div class="line">    pkt_tx_stats_t *tx_stats;</div>
<div class="line">    uint8_t src_mac[ODPH_ETHADDR_LEN];</div>
<div class="line">    uint8_t dst_mac[ODPH_ETHADDR_LEN];</div>
<div class="line">    uint32_t rx_stats_size;</div>
<div class="line">    uint32_t tx_stats_size;</div>
<div class="line">    <span class="comment">/* Indicate to the receivers to shutdown */</span></div>
<div class="line">    <a name="_a5"></a><a class="code" href="structodp__atomic__u32__s.html">odp_atomic_u32_t</a> shutdown;</div>
<div class="line">    <span class="comment">/* Sequence number of IP packets */</span></div>
<div class="line">    <a class="code" href="structodp__atomic__u32__s.html">odp_atomic_u32_t</a> ip_seq <a class="code" href="group__odp__compiler__optim.html#ga205a8257879c02657e7c39ee7ad5e40a">ODP_ALIGNED_CACHE</a>;</div>
<div class="line">} test_globals_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Status of max rate search */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint64_t pps_curr; <span class="comment">/* Current attempted PPS */</span></div>
<div class="line">    uint64_t pps_pass; <span class="comment">/* Highest passing PPS */</span></div>
<div class="line">    uint64_t pps_fail; <span class="comment">/* Lowest failing PPS */</span></div>
<div class="line">    <span class="keywordtype">int</span>      warmup;   <span class="comment">/* Warmup stage - ignore results */</span></div>
<div class="line">} test_status_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Thread specific arguments */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keywordtype">int</span> batch_len; <span class="comment">/* Number of packets per transmit batch */</span></div>
<div class="line">    <span class="keywordtype">int</span> duration;  <span class="comment">/* Run duration in scaled time units */</span></div>
<div class="line">    uint64_t pps;  <span class="comment">/* Packets per second for this thread */</span></div>
<div class="line">} thread_args_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <a class="code" href="group__odp__compiler__optim.html#ga2b6519f1042fc82dd7361061f27a6fe1">odp_u32be_t</a> magic; <span class="comment">/* Packet header magic number */</span></div>
<div class="line">} pkt_head_t;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Application global data */</span></div>
<div class="line"><span class="keyword">static</span> test_globals_t *gbl_args;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Generate a single test packet for transmission.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <a name="_a6"></a><a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pktio_create_packet(uint32_t seq)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt;</div>
<div class="line">    odph_ethhdr_t *eth;</div>
<div class="line">    odph_ipv4hdr_t *ip;</div>
<div class="line">    odph_udphdr_t *udp;</div>
<div class="line">    <span class="keywordtype">char</span> *buf;</div>
<div class="line">    uint32_t offset;</div>
<div class="line">    pkt_head_t pkt_hdr;</div>
<div class="line">    <span class="keywordtype">size_t</span> payload_len;</div>
<div class="line"> </div>
<div class="line">    payload_len = <span class="keyword">sizeof</span>(pkt_hdr) + gbl_args-&gt;args.pkt_len;</div>
<div class="line"> </div>
<div class="line">    pkt = <a name="a7"></a><a class="code" href="group__odp__packet.html#ga7528dda77d71a9dbfe563dffb62d8318">odp_packet_alloc</a>(gbl_args-&gt;transmit_pkt_pool,</div>
<div class="line">                   payload_len + ODPH_UDPHDR_LEN +</div>
<div class="line">                   ODPH_IPV4HDR_LEN + ODPH_ETHHDR_LEN);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pkt == <a name="a8"></a><a class="code" href="group__odp__packet.html#gaba8cf39480fb133ab8299155d4ef63dc">ODP_PACKET_INVALID</a>)</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="group__odp__packet.html#gaba8cf39480fb133ab8299155d4ef63dc">ODP_PACKET_INVALID</a>;</div>
<div class="line"> </div>
<div class="line">    buf = <a name="a9"></a><a class="code" href="group__odp__packet.html#ga433ba21e3c83c6d4d9831c9e732b63de">odp_packet_data</a>(pkt);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Ethernet */</span></div>
<div class="line">    offset = 0;</div>
<div class="line">    <a name="a10"></a><a class="code" href="group__odp__packet.html#ga79bdc8c991e23c5e676b31e630bc31f3">odp_packet_l2_offset_set</a>(pkt, offset);</div>
<div class="line">    eth = (odph_ethhdr_t *)buf;</div>
<div class="line">    memcpy(eth-&gt;src.addr, gbl_args-&gt;src_mac, ODPH_ETHADDR_LEN);</div>
<div class="line">    memcpy(eth-&gt;dst.addr, gbl_args-&gt;dst_mac, ODPH_ETHADDR_LEN);</div>
<div class="line">    eth-&gt;type = <a name="a11"></a><a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(ODPH_ETHTYPE_IPV4);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* IP */</span></div>
<div class="line">    offset += ODPH_ETHHDR_LEN;</div>
<div class="line">    <a name="a12"></a><a class="code" href="group__odp__packet.html#ga1b1c25d6a81b1f3c2cb82188b3721a6f">odp_packet_l3_offset_set</a>(pkt, ODPH_ETHHDR_LEN);</div>
<div class="line">    ip = (odph_ipv4hdr_t *)(buf + ODPH_ETHHDR_LEN);</div>
<div class="line">    ip-&gt;dst_addr = <a name="a13"></a><a class="code" href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a>(0);</div>
<div class="line">    ip-&gt;src_addr = <a class="code" href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a>(0);</div>
<div class="line">    ip-&gt;ver_ihl = ODPH_IPV4 &lt;&lt; 4 | ODPH_IPV4HDR_IHL_MIN;</div>
<div class="line">    ip-&gt;tot_len = <a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(payload_len + ODPH_UDPHDR_LEN +</div>
<div class="line">                       ODPH_IPV4HDR_LEN);</div>
<div class="line">    ip-&gt;ttl = 128;</div>
<div class="line">    ip-&gt;proto = ODPH_IPPROTO_UDP;</div>
<div class="line">    ip-&gt;id = <a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(seq);</div>
<div class="line">    ip-&gt;chksum = 0;</div>
<div class="line">    odph_ipv4_csum_update(pkt);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* UDP */</span></div>
<div class="line">    offset += ODPH_IPV4HDR_LEN;</div>
<div class="line">    <a name="a14"></a><a class="code" href="group__odp__packet.html#ga4629db8bf7e9b378f8a83b7aabab8248">odp_packet_l4_offset_set</a>(pkt, offset);</div>
<div class="line">    udp = (odph_udphdr_t *)(buf + offset);</div>
<div class="line">    udp-&gt;src_port = <a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(0);</div>
<div class="line">    udp-&gt;dst_port = <a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(0);</div>
<div class="line">    udp-&gt;length = <a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(payload_len + ODPH_UDPHDR_LEN);</div>
<div class="line">    udp-&gt;chksum = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* payload */</span></div>
<div class="line">    offset += ODPH_UDPHDR_LEN;</div>
<div class="line">    pkt_hdr.magic = TEST_HDR_MAGIC;</div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a15"></a><a class="code" href="group__odp__packet.html#gab67164b42ca75ae96615af7cebbfc414">odp_packet_copy_from_mem</a>(pkt, offset, <span class="keyword">sizeof</span>(pkt_hdr),</div>
<div class="line">                     &amp;pkt_hdr) != 0)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Failed to generate test packet.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> pkt;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Check if a packet payload contains test payload magic number.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> pktio_pkt_has_magic(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> l4_off;</div>
<div class="line">    pkt_head_t pkt_hdr;</div>
<div class="line"> </div>
<div class="line">    l4_off = ODPH_ETHHDR_LEN + ODPH_IPV4HDR_LEN;</div>
<div class="line">    <span class="keywordtype">int</span> ret = <a name="a16"></a><a class="code" href="group__odp__packet.html#gadf9179122029a9dd7a000e050f68b357">odp_packet_copy_to_mem</a>(pkt,</div>
<div class="line">                     l4_off + ODPH_UDPHDR_LEN,</div>
<div class="line">                     <span class="keyword">sizeof</span>(pkt_hdr), &amp;pkt_hdr);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pkt_hdr.magic == TEST_HDR_MAGIC)</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Allocate packets for transmission.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> alloc_packets(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> *pkt_tbl, <span class="keywordtype">int</span> num_pkts)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> n;</div>
<div class="line">    uint16_t seq;</div>
<div class="line"> </div>
<div class="line">    seq = <a name="a17"></a><a class="code" href="group__odp__atomic.html#ga71a1eeba2eeafb1a0d09728f79a6a4c4">odp_atomic_fetch_add_u32</a>(&amp;gbl_args-&gt;ip_seq, num_pkts);</div>
<div class="line">    <span class="keywordflow">for</span> (n = 0; n &lt; num_pkts; ++n) {</div>
<div class="line">        pkt_tbl[n] = pktio_create_packet(seq + n);</div>
<div class="line">        <span class="keywordflow">if</span> (pkt_tbl[n] == <a class="code" href="group__odp__packet.html#gaba8cf39480fb133ab8299155d4ef63dc">ODP_PACKET_INVALID</a>)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> n;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> send_packets(<a name="_a18"></a><a class="code" href="structodp__pktout__queue__s.html">odp_pktout_queue_t</a> pktout,</div>
<div class="line">            <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> *pkt_tbl, <span class="keywordtype">unsigned</span> pkts)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> tx_drops;</div>
<div class="line">    <span class="keywordtype">unsigned</span> sent = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pkts == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (sent &lt; pkts) {</div>
<div class="line">        <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">        ret = <a name="a19"></a><a class="code" href="group__odp__packet__io.html#gacb5db3a908775522e316c8b8ccb36498">odp_pktout_send</a>(pktout, &amp;pkt_tbl[sent], pkts - sent);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a20"></a><a class="code" href="group__odp__compiler__optim.html#ga68d9a1bb3d2dcfdf476b2d9e16b89e4d">odp_likely</a>(ret &gt; 0))</div>
<div class="line">            sent += ret;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    tx_drops = pkts - sent;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a21"></a><a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(tx_drops))</div>
<div class="line">        <a name="a22"></a><a class="code" href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a>(&amp;pkt_tbl[sent], tx_drops);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> sent;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Main packet transmit routine. Transmit packets at a fixed rate for</span></div>
<div class="line"><span class="comment"> * specified length of time.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_thread_tx(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    test_globals_t *globals;</div>
<div class="line">    <span class="keywordtype">int</span> thr_id;</div>
<div class="line">    <a class="code" href="structodp__pktout__queue__s.html">odp_pktout_queue_t</a> pktout;</div>
<div class="line">    pkt_tx_stats_t *stats;</div>
<div class="line">    <a class="code" href="structodp__time__s.html">odp_time_t</a> cur_time, send_time_end, send_duration;</div>
<div class="line">    <a class="code" href="structodp__time__s.html">odp_time_t</a> burst_gap_end, burst_gap;</div>
<div class="line">    uint32_t batch_len;</div>
<div class="line">    <span class="keywordtype">int</span> unsent_pkts = 0;</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> tx_packet[BATCH_LEN_MAX];</div>
<div class="line">    <a class="code" href="structodp__time__s.html">odp_time_t</a> idle_start = <a name="a23"></a><a class="code" href="group__odp__time.html#ga67ec3be80e3d1b2b1294ae551f4def86">ODP_TIME_NULL</a>;</div>
<div class="line"> </div>
<div class="line">    thread_args_t *targs = arg;</div>
<div class="line"> </div>
<div class="line">    batch_len = targs-&gt;batch_len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (batch_len &gt; BATCH_LEN_MAX)</div>
<div class="line">        batch_len = BATCH_LEN_MAX;</div>
<div class="line"> </div>
<div class="line">    thr_id = <a name="a24"></a><a class="code" href="group__odp__thread.html#gad6562e7320d48463715bbf15748ae360">odp_thread_id</a>();</div>
<div class="line"> </div>
<div class="line">    globals = <a name="a25"></a><a class="code" href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a>(<a name="a26"></a><a class="code" href="group__odp__shared__memory.html#ga090e9d9d3076bfeb3d2cb60793829453">odp_shm_lookup</a>(<span class="stringliteral">&quot;test_globals&quot;</span>));</div>
<div class="line">    stats = &amp;globals-&gt;tx_stats[thr_id];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a27"></a><a class="code" href="group__odp__packet__io.html#ga41a3ebb7ac489b85a5f7560e4d4f77f5">odp_pktout_queue</a>(globals-&gt;pktio_tx, &amp;pktout, 1) != 1)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Failed to get output queue for thread %d\n&quot;</span>,</div>
<div class="line">               thr_id);</div>
<div class="line"> </div>
<div class="line">    burst_gap = <a name="a28"></a><a class="code" href="group__odp__time.html#ga4dfd390b895e6a63601a935db7621139">odp_time_local_from_ns</a>(</div>
<div class="line">            <a name="a29"></a><a class="code" href="group__odp__time.html#ga49ab6f8fe6c0aa5b820717fd91f16ab5">ODP_TIME_SEC_IN_NS</a> / (targs-&gt;pps / targs-&gt;batch_len));</div>
<div class="line">    send_duration =</div>
<div class="line">        <a class="code" href="group__odp__time.html#ga4dfd390b895e6a63601a935db7621139">odp_time_local_from_ns</a>(targs-&gt;duration * <a class="code" href="group__odp__time.html#ga49ab6f8fe6c0aa5b820717fd91f16ab5">ODP_TIME_SEC_IN_NS</a> / T_SCALE);</div>
<div class="line"> </div>
<div class="line">    <a name="a30"></a><a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;globals-&gt;tx_barrier);</div>
<div class="line"> </div>
<div class="line">    cur_time     = <a name="a31"></a><a class="code" href="group__odp__time.html#ga5d0b24d7dae739bac7585ed515bd60a8">odp_time_local</a>();</div>
<div class="line">    send_time_end = <a name="a32"></a><a class="code" href="group__odp__time.html#ga2cf6345917d31805746337cf3c4b9c53">odp_time_sum</a>(cur_time, send_duration);</div>
<div class="line">    burst_gap_end = cur_time;</div>
<div class="line">    <span class="keywordflow">while</span> (<a name="a33"></a><a class="code" href="group__odp__time.html#gac19fb35909fb3f7f3c7fadf0e5e6e0e4">odp_time_cmp</a>(send_time_end, cur_time) &gt; 0) {</div>
<div class="line">        <span class="keywordtype">unsigned</span> alloc_cnt = 0, tx_cnt;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__time.html#gac19fb35909fb3f7f3c7fadf0e5e6e0e4">odp_time_cmp</a>(burst_gap_end, cur_time) &gt; 0) {</div>
<div class="line">            cur_time = <a class="code" href="group__odp__time.html#ga5d0b24d7dae739bac7585ed515bd60a8">odp_time_local</a>();</div>
<div class="line">            <span class="keywordflow">if</span> (!<a class="code" href="group__odp__time.html#gac19fb35909fb3f7f3c7fadf0e5e6e0e4">odp_time_cmp</a>(idle_start, <a class="code" href="group__odp__time.html#ga67ec3be80e3d1b2b1294ae551f4def86">ODP_TIME_NULL</a>))</div>
<div class="line">                idle_start = cur_time;</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__time.html#gac19fb35909fb3f7f3c7fadf0e5e6e0e4">odp_time_cmp</a>(idle_start, <a class="code" href="group__odp__time.html#ga67ec3be80e3d1b2b1294ae551f4def86">ODP_TIME_NULL</a>) &gt; 0) {</div>
<div class="line">            <a class="code" href="structodp__time__s.html">odp_time_t</a> diff = <a name="a34"></a><a class="code" href="group__odp__time.html#ga1a5b41e057216483b4843120631f869a">odp_time_diff</a>(cur_time, idle_start);</div>
<div class="line"> </div>
<div class="line">            stats-&gt;idle_ticks =</div>
<div class="line">                <a class="code" href="group__odp__time.html#ga2cf6345917d31805746337cf3c4b9c53">odp_time_sum</a>(diff, stats-&gt;idle_ticks);</div>
<div class="line"> </div>
<div class="line">            idle_start = <a class="code" href="group__odp__time.html#ga67ec3be80e3d1b2b1294ae551f4def86">ODP_TIME_NULL</a>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        burst_gap_end = <a class="code" href="group__odp__time.html#ga2cf6345917d31805746337cf3c4b9c53">odp_time_sum</a>(burst_gap_end, burst_gap);</div>
<div class="line"> </div>
<div class="line">        alloc_cnt = alloc_packets(tx_packet, batch_len - unsent_pkts);</div>
<div class="line">        <span class="keywordflow">if</span> (alloc_cnt != batch_len)</div>
<div class="line">            stats-&gt;alloc_failures++;</div>
<div class="line"> </div>
<div class="line">        tx_cnt = send_packets(pktout, tx_packet, alloc_cnt);</div>
<div class="line">        unsent_pkts = alloc_cnt - tx_cnt;</div>
<div class="line">        stats-&gt;enq_failures += unsent_pkts;</div>
<div class="line">        stats-&gt;tx_cnt += tx_cnt;</div>
<div class="line"> </div>
<div class="line">        cur_time = <a class="code" href="group__odp__time.html#ga5d0b24d7dae739bac7585ed515bd60a8">odp_time_local</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.verbose)</div>
<div class="line">        printf(<span class="stringliteral">&quot; %02d: TxPkts %-8&quot;</span> PRIu64 <span class="stringliteral">&quot; EnqFail %-6&quot;</span> PRIu64</div>
<div class="line">               <span class="stringliteral">&quot; AllocFail %-6&quot;</span> PRIu64 <span class="stringliteral">&quot; Idle %&quot;</span> PRIu64 <span class="stringliteral">&quot;ms\n&quot;</span>,</div>
<div class="line">               thr_id, stats-&gt;tx_cnt, stats-&gt;enq_failures,</div>
<div class="line">               stats-&gt;alloc_failures,</div>
<div class="line">               <a name="a35"></a><a class="code" href="group__odp__time.html#ga04eed146c4559fb906766c4fbd4c2460">odp_time_to_ns</a>(stats-&gt;idle_ticks) /</div>
<div class="line">               (uint64_t)<a name="a36"></a><a class="code" href="group__odp__time.html#gabad65a44847cb6d46c2ae9cc96a80a4c">ODP_TIME_MSEC_IN_NS</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> receive_packets(<a name="_a37"></a><a class="code" href="struct__odp__abi__queue__t.html">odp_queue_t</a> queue,</div>
<div class="line">               <a name="_a38"></a><a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> *event_tbl, <span class="keywordtype">unsigned</span> num_pkts)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> n_ev = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (queue != <a name="a39"></a><a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (num_pkts == 1) {</div>
<div class="line">            event_tbl[0] = <a name="a40"></a><a class="code" href="group__odp__queue.html#ga8429f65feb58e20109d7f15a4dcfd08b">odp_queue_deq</a>(queue);</div>
<div class="line">            n_ev = event_tbl[0] != <a name="a41"></a><a class="code" href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            n_ev = <a name="a42"></a><a class="code" href="group__odp__queue.html#gaf75fc00e4a9cc4714bf311d9404fa0ad">odp_queue_deq_multi</a>(queue, event_tbl, num_pkts);</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (num_pkts == 1) {</div>
<div class="line">            event_tbl[0] = <a name="a43"></a><a class="code" href="group__odp__scheduler.html#gae4ca1012ebb16ff8b9752b958dc45ce6">odp_schedule</a>(NULL, <a name="a44"></a><a class="code" href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a>);</div>
<div class="line">            n_ev = event_tbl[0] != <a class="code" href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            n_ev = <a name="a45"></a><a class="code" href="group__odp__scheduler.html#ga34f1bae924466cc2b57563f8fe2dc0d1">odp_schedule_multi</a>(NULL, <a class="code" href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a>,</div>
<div class="line">                          event_tbl, num_pkts);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> n_ev;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_thread_rx(<span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    test_globals_t *globals;</div>
<div class="line">    <span class="keywordtype">int</span> thr_id, batch_len;</div>
<div class="line">    <a class="code" href="struct__odp__abi__queue__t.html">odp_queue_t</a> queue = <a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>;</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt;</div>
<div class="line"> </div>
<div class="line">    thread_args_t *targs = arg;</div>
<div class="line"> </div>
<div class="line">    batch_len = targs-&gt;batch_len;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (batch_len &gt; BATCH_LEN_MAX)</div>
<div class="line">        batch_len = BATCH_LEN_MAX;</div>
<div class="line"> </div>
<div class="line">    thr_id = <a class="code" href="group__odp__thread.html#gad6562e7320d48463715bbf15748ae360">odp_thread_id</a>();</div>
<div class="line"> </div>
<div class="line">    globals = <a class="code" href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a>(<a class="code" href="group__odp__shared__memory.html#ga090e9d9d3076bfeb3d2cb60793829453">odp_shm_lookup</a>(<span class="stringliteral">&quot;test_globals&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    pkt_rx_stats_t *stats = &amp;globals-&gt;rx_stats[thr_id];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.schedule == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a46"></a><a class="code" href="group__odp__packet__io.html#ga7a0b3f09fd55576daa9617dc29c60ace">odp_pktin_event_queue</a>(globals-&gt;pktio_rx, &amp;queue, 1) != 1)</div>
<div class="line">            ODPH_ABORT(<span class="stringliteral">&quot;No input queue.\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;globals-&gt;rx_barrier);</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> ev[BATCH_LEN_MAX];</div>
<div class="line">        <span class="keywordtype">int</span> i, n_ev;</div>
<div class="line"> </div>
<div class="line">        n_ev = receive_packets(queue, ev, batch_len);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_ev; ++i) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a47"></a><a class="code" href="group__odp__event.html#ga4bd59cdf228fe0c36b8e04fe122e047a">odp_event_type</a>(ev[i]) == ODP_EVENT_PACKET) {</div>
<div class="line">                pkt = <a name="a48"></a><a class="code" href="group__odp__packet.html#ga8605e7d4629a479f7b1a59da121c601c">odp_packet_from_event</a>(ev[i]);</div>
<div class="line">                <span class="keywordflow">if</span> (pktio_pkt_has_magic(pkt))</div>
<div class="line">                    stats-&gt;rx_cnt++;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                    stats-&gt;rx_ignore++;</div>
<div class="line">            }</div>
<div class="line">            <a name="a49"></a><a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev[i]);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (n_ev == 0 &amp;&amp; <a name="a50"></a><a class="code" href="group__odp__atomic.html#ga1ebc0fa6d690c24bd2bcc38bcb9a2276">odp_atomic_load_u32</a>(&amp;gbl_args-&gt;shutdown))</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Process the results from a single fixed rate test run to determine whether</span></div>
<div class="line"><span class="comment"> * it passed or failed. Pass criteria are that the requested transmit packet</span></div>
<div class="line"><span class="comment"> * rate was achieved and that all of the transmitted packets were received.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> process_results(uint64_t expected_tx_cnt,</div>
<div class="line">               test_status_t *status)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> fail = 0;</div>
<div class="line">    uint64_t drops = 0;</div>
<div class="line">    uint64_t rx_pkts = 0;</div>
<div class="line">    uint64_t tx_pkts = 0;</div>
<div class="line">    uint64_t attempted_pps;</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">char</span> str[512];</div>
<div class="line">    <span class="keywordtype">int</span> len = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a name="a51"></a><a class="code" href="group__odp__thread.html#gaa3b169c5b129a7306d4a941b15883833">odp_thread_count_max</a>(); ++i) {</div>
<div class="line">        rx_pkts += gbl_args-&gt;rx_stats[i].rx_cnt;</div>
<div class="line">        tx_pkts += gbl_args-&gt;tx_stats[i].tx_cnt;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (rx_pkts == 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;no packets received\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (tx_pkts &lt; (expected_tx_cnt - (expected_tx_cnt / 100))) {</div>
<div class="line">        <span class="comment">/* failed to transmit packets at (99% of) requested rate */</span></div>
<div class="line">        fail = 1;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tx_pkts &gt; rx_pkts) {</div>
<div class="line">        <span class="comment">/* failed to receive all of the transmitted packets */</span></div>
<div class="line">        fail = 1;</div>
<div class="line">        drops = tx_pkts - rx_pkts;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    attempted_pps = status-&gt;pps_curr;</div>
<div class="line"> </div>
<div class="line">    len += snprintf(&amp;str[len], <span class="keyword">sizeof</span>(str) - 1 - len,</div>
<div class="line">            <span class="stringliteral">&quot;PPS: %-8&quot;</span> PRIu64 <span class="stringliteral">&quot; &quot;</span>, attempted_pps);</div>
<div class="line">    len += snprintf(&amp;str[len], <span class="keyword">sizeof</span>(str) - 1 - len,</div>
<div class="line">            <span class="stringliteral">&quot;Succeeded: %-4s &quot;</span>, fail ? <span class="stringliteral">&quot;No&quot;</span> : <span class="stringliteral">&quot;Yes&quot;</span>);</div>
<div class="line">    len += snprintf(&amp;str[len], <span class="keyword">sizeof</span>(str) - 1 - len,</div>
<div class="line">            <span class="stringliteral">&quot;TxPkts: %-8&quot;</span> PRIu64 <span class="stringliteral">&quot; &quot;</span>, tx_pkts);</div>
<div class="line">    len += snprintf(&amp;str[len], <span class="keyword">sizeof</span>(str) - 1 - len,</div>
<div class="line">            <span class="stringliteral">&quot;RxPkts: %-8&quot;</span> PRIu64 <span class="stringliteral">&quot; &quot;</span>, rx_pkts);</div>
<div class="line">    len += snprintf(&amp;str[len], <span class="keyword">sizeof</span>(str) - 1 - len,</div>
<div class="line">            <span class="stringliteral">&quot;DropPkts: %-8&quot;</span> PRIu64 <span class="stringliteral">&quot; &quot;</span>, drops);</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s\n&quot;</span>, str);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.search == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Result: %s\n&quot;</span>, fail ? <span class="stringliteral">&quot;FAILED&quot;</span> : <span class="stringliteral">&quot;PASSED&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> fail ? -1 : 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (fail &amp;&amp; (status-&gt;pps_fail == 0 ||</div>
<div class="line">             attempted_pps &lt; status-&gt;pps_fail)) {</div>
<div class="line">        status-&gt;pps_fail = attempted_pps;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attempted_pps &gt; status-&gt;pps_pass) {</div>
<div class="line">        status-&gt;pps_pass = attempted_pps;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (status-&gt;pps_fail == 0) {</div>
<div class="line">        <span class="comment">/* ramping up, double the previously attempted pps */</span></div>
<div class="line">        status-&gt;pps_curr *= 2;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">/* set the new target to half way between the upper and lower</span></div>
<div class="line"><span class="comment">         * limits */</span></div>
<div class="line">        status-&gt;pps_curr = status-&gt;pps_pass +</div>
<div class="line">                   ((status-&gt;pps_fail - status-&gt;pps_pass) / 2);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* stop once the pass and fail measurements are within range */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((status-&gt;pps_fail - status-&gt;pps_pass) &lt; RATE_SEARCH_ACCURACY_PPS) {</div>
<div class="line">        <span class="keywordtype">unsigned</span> pkt_len = gbl_args-&gt;args.pkt_len + PKT_HDR_LEN;</div>
<div class="line">        <span class="keywordtype">int</span> mbps = (pkt_len * status-&gt;pps_pass * 8) / 1024 / 1024;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;Maximum packet rate: %&quot;</span> PRIu64 <span class="stringliteral">&quot; PPS (%d Mbps)\n&quot;</span>,</div>
<div class="line">               status-&gt;pps_pass, mbps);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> setup_txrx_masks(<a name="_a52"></a><a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> *thd_mask_tx,</div>
<div class="line">                <a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> *thd_mask_rx)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> cpumask;</div>
<div class="line">    <span class="keywordtype">int</span> num_workers, num_tx_workers, num_rx_workers;</div>
<div class="line">    <span class="keywordtype">int</span> i, cpu;</div>
<div class="line"> </div>
<div class="line">    num_workers =</div>
<div class="line">        <a name="a53"></a><a class="code" href="group__odp__cpumask.html#ga4ff2d29f52775b12c7df1995754b524d">odp_cpumask_default_worker</a>(&amp;cpumask,</div>
<div class="line">                       gbl_args-&gt;args.cpu_count);</div>
<div class="line">    <span class="keywordflow">if</span> (num_workers &lt; 2) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Need at least two cores\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> TEST_SKIP;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_workers &gt; MAX_WORKERS) {</div>
<div class="line">        ODPH_DBG(<span class="stringliteral">&quot;Worker count limited to MAX_WORKERS define (=%d)\n&quot;</span>,</div>
<div class="line">             MAX_WORKERS);</div>
<div class="line">        num_workers = MAX_WORKERS;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.num_tx_workers) {</div>
<div class="line">        <span class="keywordflow">if</span> (gbl_args-&gt;args.num_tx_workers &gt; (num_workers - 1)) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Invalid TX worker count\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        num_tx_workers = gbl_args-&gt;args.num_tx_workers;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">/* default is to split the available cores evenly into TX and</span></div>
<div class="line"><span class="comment">         * RX workers, favour TX for odd core count */</span></div>
<div class="line">        num_tx_workers = (num_workers + 1) / 2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a54"></a><a class="code" href="group__odp__cpumask.html#ga6b12769c4dc0729aa057d88a450eb727">odp_cpumask_zero</a>(thd_mask_tx);</div>
<div class="line">    <a class="code" href="group__odp__cpumask.html#ga6b12769c4dc0729aa057d88a450eb727">odp_cpumask_zero</a>(thd_mask_rx);</div>
<div class="line"> </div>
<div class="line">    cpu = <a name="a55"></a><a class="code" href="group__odp__cpumask.html#ga5c9dfaf2a18b336a537f552e122ac41d">odp_cpumask_first</a>(&amp;cpumask);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; num_workers; ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> (i &lt; num_tx_workers)</div>
<div class="line">            <a name="a56"></a><a class="code" href="group__odp__cpumask.html#ga42b4df58e6727850aa8d1eca3aa252e5">odp_cpumask_set</a>(thd_mask_tx, cpu);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <a class="code" href="group__odp__cpumask.html#ga42b4df58e6727850aa8d1eca3aa252e5">odp_cpumask_set</a>(thd_mask_rx, cpu);</div>
<div class="line">        cpu = <a name="a57"></a><a class="code" href="group__odp__cpumask.html#ga643e71985a781cdd43bac218df03304b">odp_cpumask_next</a>(&amp;cpumask, cpu);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    num_rx_workers = <a name="a58"></a><a class="code" href="group__odp__cpumask.html#ga8d4d03c213437875e71d39bd1ae600a9">odp_cpumask_count</a>(thd_mask_rx);</div>
<div class="line"> </div>
<div class="line">    <a name="a59"></a><a class="code" href="group__odp__barrier.html#ga1416b47755c2af6267074959ac0d4840">odp_barrier_init</a>(&amp;gbl_args-&gt;rx_barrier, num_rx_workers + 1);</div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga1416b47755c2af6267074959ac0d4840">odp_barrier_init</a>(&amp;gbl_args-&gt;tx_barrier, num_tx_workers + 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Run a single instance of the throughput test. When attempting to determine</span></div>
<div class="line"><span class="comment"> * the maximum packet rate this will be invoked multiple times with the only</span></div>
<div class="line"><span class="comment"> * difference between runs being the target PPS rate.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_test_single(<a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> *thd_mask_tx,</div>
<div class="line">               <a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> *thd_mask_rx,</div>
<div class="line">               test_status_t *status)</div>
<div class="line">{</div>
<div class="line">    odph_thread_t thread_tbl[MAX_WORKERS];</div>
<div class="line">    odph_thread_common_param_t thr_common;</div>
<div class="line">    odph_thread_param_t thr_param;</div>
<div class="line">    thread_args_t args_tx, args_rx;</div>
<div class="line">    uint64_t expected_tx_cnt;</div>
<div class="line">    <span class="keywordtype">int</span> num_tx_workers, num_rx_workers;</div>
<div class="line"> </div>
<div class="line">    <a name="a60"></a><a class="code" href="group__odp__atomic.html#gaa6d2d16a9ef9897b1442d77e41f7101e">odp_atomic_store_u32</a>(&amp;gbl_args-&gt;shutdown, 0);</div>
<div class="line"> </div>
<div class="line">    memset(thread_tbl, 0, <span class="keyword">sizeof</span>(thread_tbl));</div>
<div class="line">    memset(gbl_args-&gt;rx_stats, 0, gbl_args-&gt;rx_stats_size);</div>
<div class="line">    memset(gbl_args-&gt;tx_stats, 0, gbl_args-&gt;tx_stats_size);</div>
<div class="line"> </div>
<div class="line">    expected_tx_cnt = status-&gt;pps_curr * gbl_args-&gt;args.duration / T_SCALE;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* start receiver threads first */</span></div>
<div class="line"> </div>
<div class="line">    num_rx_workers = <a class="code" href="group__odp__cpumask.html#ga8d4d03c213437875e71d39bd1ae600a9">odp_cpumask_count</a>(thd_mask_rx);</div>
<div class="line">    args_rx.batch_len = gbl_args-&gt;args.rx_batch_len;</div>
<div class="line"> </div>
<div class="line">    odph_thread_common_param_init(&amp;thr_common);</div>
<div class="line">    thr_common.instance = gbl_args-&gt;instance;</div>
<div class="line">    thr_common.cpumask = thd_mask_rx;</div>
<div class="line">    thr_common.share_param = 1;</div>
<div class="line"> </div>
<div class="line">    odph_thread_param_init(&amp;thr_param);</div>
<div class="line">    thr_param.start = run_thread_rx;</div>
<div class="line">    thr_param.arg = &amp;args_rx;</div>
<div class="line">    thr_param.thr_type = <a name="a61"></a><a class="code" href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a">ODP_THREAD_WORKER</a>;</div>
<div class="line"> </div>
<div class="line">    odph_thread_create(thread_tbl, &amp;thr_common, &amp;thr_param, num_rx_workers);</div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;gbl_args-&gt;rx_barrier);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* then start transmitters */</span></div>
<div class="line"> </div>
<div class="line">    num_tx_workers    = <a class="code" href="group__odp__cpumask.html#ga8d4d03c213437875e71d39bd1ae600a9">odp_cpumask_count</a>(thd_mask_tx);</div>
<div class="line">    args_tx.pps       = status-&gt;pps_curr / num_tx_workers;</div>
<div class="line">    args_tx.duration  = gbl_args-&gt;args.duration;</div>
<div class="line">    args_tx.batch_len = gbl_args-&gt;args.tx_batch_len;</div>
<div class="line"> </div>
<div class="line">    odph_thread_common_param_init(&amp;thr_common);</div>
<div class="line">    thr_common.instance = gbl_args-&gt;instance;</div>
<div class="line">    thr_common.cpumask = thd_mask_tx;</div>
<div class="line">    thr_common.share_param = 1;</div>
<div class="line"> </div>
<div class="line">    odph_thread_param_init(&amp;thr_param);</div>
<div class="line">    thr_param.start = run_thread_tx;</div>
<div class="line">    thr_param.arg = &amp;args_tx;</div>
<div class="line">    thr_param.thr_type = <a class="code" href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a">ODP_THREAD_WORKER</a>;</div>
<div class="line"> </div>
<div class="line">    odph_thread_create(&amp;thread_tbl[num_rx_workers], &amp;thr_common, &amp;thr_param, num_tx_workers);</div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;gbl_args-&gt;tx_barrier);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* wait for transmitter threads to terminate */</span></div>
<div class="line">    odph_thread_join(&amp;thread_tbl[num_rx_workers], num_tx_workers);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* delay to allow transmitted packets to reach the receivers */</span></div>
<div class="line">    <a name="a62"></a><a class="code" href="group__odp__time.html#ga506b0234dfdd7c0dc98d6acd27d57f8a">odp_time_wait_ns</a>(SHUTDOWN_DELAY_NS);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* indicate to the receivers to exit */</span></div>
<div class="line">    <a class="code" href="group__odp__atomic.html#gaa6d2d16a9ef9897b1442d77e41f7101e">odp_atomic_store_u32</a>(&amp;gbl_args-&gt;shutdown, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* wait for receivers */</span></div>
<div class="line">    odph_thread_join(thread_tbl, num_rx_workers);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!status-&gt;warmup)</div>
<div class="line">        <span class="keywordflow">return</span> process_results(expected_tx_cnt, status);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> run_test(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> txmask, rxmask;</div>
<div class="line">    test_status_t status = {</div>
<div class="line">        .pps_curr = gbl_args-&gt;args.pps,</div>
<div class="line">        .pps_pass = 0,</div>
<div class="line">        .pps_fail = 0,</div>
<div class="line">        .warmup = 1,</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    ret = setup_txrx_masks(&amp;txmask, &amp;rxmask);</div>
<div class="line">    <span class="keywordflow">if</span> (ret)</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Starting test with params:\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tTransmit workers:     \t%d\n&quot;</span>, <a class="code" href="group__odp__cpumask.html#ga8d4d03c213437875e71d39bd1ae600a9">odp_cpumask_count</a>(&amp;txmask));</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tReceive workers:      \t%d\n&quot;</span>, <a class="code" href="group__odp__cpumask.html#ga8d4d03c213437875e71d39bd1ae600a9">odp_cpumask_count</a>(&amp;rxmask));</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tDuration (seconds):   \t%d\n&quot;</span>, gbl_args-&gt;args.duration);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tTransmit batch length:\t%&quot;</span> PRIu32 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">           gbl_args-&gt;args.tx_batch_len);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tReceive batch length: \t%&quot;</span> PRIu32 <span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">           gbl_args-&gt;args.rx_batch_len);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tPacket receive method:\t%s\n&quot;</span>,</div>
<div class="line">           gbl_args-&gt;args.schedule ? <span class="stringliteral">&quot;schedule&quot;</span> : <span class="stringliteral">&quot;plain&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\tInterface(s):         \t&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; gbl_args-&gt;args.num_ifaces; ++i)</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s &quot;</span>, gbl_args-&gt;args.ifaces[i]);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* first time just run the test but throw away the results */</span></div>
<div class="line">    run_test_single(&amp;txmask, &amp;rxmask, &amp;status);</div>
<div class="line">    status.warmup = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        ret = run_test_single(&amp;txmask, &amp;rxmask, &amp;status);</div>
<div class="line">        <span class="keywordflow">if</span> (ret &lt;= 0)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="struct__odp__abi__pktio__t.html">odp_pktio_t</a> create_pktio(<span class="keyword">const</span> <span class="keywordtype">char</span> *iface, <span class="keywordtype">int</span> schedule)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__pool__t.html">odp_pool_t</a> pool;</div>
<div class="line">    <a class="code" href="struct__odp__abi__pktio__t.html">odp_pktio_t</a> pktio;</div>
<div class="line">    <span class="keywordtype">char</span> pool_name[<a name="a63"></a><a class="code" href="group__odp__pool.html#ga1fcadb459ae1a3da8cca7360bd4de058">ODP_POOL_NAME_LEN</a>];</div>
<div class="line">    <a name="_a64"></a><a class="code" href="structodp__pool__param__t.html">odp_pool_param_t</a> params;</div>
<div class="line">    <a name="_a65"></a><a class="code" href="structodp__pktio__param__t.html">odp_pktio_param_t</a> pktio_param;</div>
<div class="line"> </div>
<div class="line">    <a name="a66"></a><a class="code" href="group__odp__pool.html#ga3dd8bcfb920f81142e9fe27cfba24073">odp_pool_param_init</a>(&amp;params);</div>
<div class="line">    params.<a name="a67"></a><a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a name="a68"></a><a class="code" href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">len</a>     = PKT_HDR_LEN + gbl_args-&gt;args.pkt_len;</div>
<div class="line">    params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a name="a69"></a><a class="code" href="structodp__pool__param__t.html#ad400db5955445ee3d1fbb36df456e7f1">seg_len</a> = params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a class="code" href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">len</a>;</div>
<div class="line">    params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a name="a70"></a><a class="code" href="structodp__pool__param__t.html#a3598b3a2496629cd45010c1c5e876250">num</a>     = PKT_BUF_NUM;</div>
<div class="line">    params.<a name="a71"></a><a class="code" href="structodp__pool__param__t.html#aac72ae142dd9736a287ce63d78b71c87">type</a>        = <a name="a72"></a><a class="code" href="group__odp__pool.html#ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd">ODP_POOL_PACKET</a>;</div>
<div class="line"> </div>
<div class="line">    snprintf(pool_name, <span class="keyword">sizeof</span>(pool_name), <span class="stringliteral">&quot;pkt_pool_%s&quot;</span>, iface);</div>
<div class="line">    pool = <a name="a73"></a><a class="code" href="group__odp__pool.html#ga256909a276600c25ce11b52ae274632f">odp_pool_create</a>(pool_name, &amp;params);</div>
<div class="line">    <span class="keywordflow">if</span> (pool == <a name="a74"></a><a class="code" href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a>)</div>
<div class="line">        <span class="keywordflow">return</span> <a name="a75"></a><a class="code" href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a>;</div>
<div class="line"> </div>
<div class="line">    <a name="a76"></a><a class="code" href="group__odp__packet__io.html#ga26d165a22d659770eba0c48543860881">odp_pktio_param_init</a>(&amp;pktio_param);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (schedule)</div>
<div class="line">        pktio_param.<a name="a77"></a><a class="code" href="structodp__pktio__param__t.html#a819cf5e2ef7df43a729cad159c022f4d">in_mode</a> = <a name="a78"></a><a class="code" href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8faa4f62db7acbe492a3b80f3f782a04dd5">ODP_PKTIN_MODE_SCHED</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        pktio_param.<a class="code" href="structodp__pktio__param__t.html#a819cf5e2ef7df43a729cad159c022f4d">in_mode</a> = <a name="a79"></a><a class="code" href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8fa502928549b130729ee8c71ab14cee89a">ODP_PKTIN_MODE_QUEUE</a>;</div>
<div class="line"> </div>
<div class="line">    pktio = <a name="a80"></a><a class="code" href="group__odp__packet__io.html#ga7ae4f96ab09d468fff3623d90db306f9">odp_pktio_open</a>(iface, pool, &amp;pktio_param);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> pktio;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> test_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__pool__param__t.html">odp_pool_param_t</a> params;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *iface;</div>
<div class="line">    <span class="keywordtype">int</span> schedule;</div>
<div class="line">    <a name="_a81"></a><a class="code" href="structodp__pktio__config__t.html">odp_pktio_config_t</a> cfg;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__pool.html#ga3dd8bcfb920f81142e9fe27cfba24073">odp_pool_param_init</a>(&amp;params);</div>
<div class="line">    params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a class="code" href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">len</a>     = PKT_HDR_LEN + gbl_args-&gt;args.pkt_len;</div>
<div class="line">    params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a class="code" href="structodp__pool__param__t.html#ad400db5955445ee3d1fbb36df456e7f1">seg_len</a> = params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a class="code" href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">len</a>;</div>
<div class="line">    params.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a class="code" href="structodp__pool__param__t.html#a3598b3a2496629cd45010c1c5e876250">num</a>     = PKT_BUF_NUM;</div>
<div class="line">    params.<a class="code" href="structodp__pool__param__t.html#aac72ae142dd9736a287ce63d78b71c87">type</a>        = <a class="code" href="group__odp__pool.html#ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd">ODP_POOL_PACKET</a>;</div>
<div class="line"> </div>
<div class="line">    gbl_args-&gt;transmit_pkt_pool = <a class="code" href="group__odp__pool.html#ga256909a276600c25ce11b52ae274632f">odp_pool_create</a>(<span class="stringliteral">&quot;pkt_pool_transmit&quot;</span>,</div>
<div class="line">                              &amp;params);</div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;transmit_pkt_pool == <a class="code" href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a>)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Failed to create transmit pool\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a name="a82"></a><a class="code" href="group__odp__atomic.html#ga0029015adacaadb06ee94ea67d00eece">odp_atomic_init_u32</a>(&amp;gbl_args-&gt;ip_seq, 0);</div>
<div class="line">    <a class="code" href="group__odp__atomic.html#ga0029015adacaadb06ee94ea67d00eece">odp_atomic_init_u32</a>(&amp;gbl_args-&gt;shutdown, 0);</div>
<div class="line"> </div>
<div class="line">    iface    = gbl_args-&gt;args.ifaces[0];</div>
<div class="line">    schedule = gbl_args-&gt;args.schedule;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (schedule)</div>
<div class="line">        <a name="a83"></a><a class="code" href="group__odp__scheduler.html#gaa1b51ebd46adeb6aa7805fccb00144df">odp_schedule_config</a>(NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* create pktios and associate input/output queues */</span></div>
<div class="line">    gbl_args-&gt;pktio_tx = create_pktio(iface, schedule);</div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.num_ifaces &gt; 1) {</div>
<div class="line">        iface = gbl_args-&gt;args.ifaces[1];</div>
<div class="line">        gbl_args-&gt;pktio_rx = create_pktio(iface, schedule);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        gbl_args-&gt;pktio_rx = gbl_args-&gt;pktio_tx;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a84"></a><a class="code" href="group__odp__packet__io.html#ga04d67c951aff803cf718940e0783ef8f">odp_pktio_mac_addr</a>(gbl_args-&gt;pktio_tx, gbl_args-&gt;src_mac,</div>
<div class="line">               ODPH_ETHADDR_LEN);</div>
<div class="line">    <a class="code" href="group__odp__packet__io.html#ga04d67c951aff803cf718940e0783ef8f">odp_pktio_mac_addr</a>(gbl_args-&gt;pktio_rx, gbl_args-&gt;dst_mac,</div>
<div class="line">               ODPH_ETHADDR_LEN);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;pktio_rx == <a class="code" href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a> ||</div>
<div class="line">        gbl_args-&gt;pktio_tx == <a class="code" href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a>) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;failed to open pktio\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Create single queue with default parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a85"></a><a class="code" href="group__odp__packet__io.html#gafc2120185a8da74540feade78623f3b3">odp_pktout_queue_config</a>(gbl_args-&gt;pktio_tx, NULL)) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;failed to configure pktio_tx queue\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Configure also input side (with defaults) */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a86"></a><a class="code" href="group__odp__packet__io.html#gaf9dce6b2cc13ad715e777416dce88194">odp_pktin_queue_config</a>(gbl_args-&gt;pktio_tx, NULL)) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;failed to configure pktio_tx queue\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Disable packet parsing as this is done in the driver where it</span></div>
<div class="line"><span class="comment">     * affects scalability.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <a name="a87"></a><a class="code" href="group__odp__packet__io.html#ga6a1c262ef999e8a73ac107c182b67d33">odp_pktio_config_init</a>(&amp;cfg);</div>
<div class="line">    cfg.<a name="a88"></a><a class="code" href="structodp__pktio__config__t.html#ab11707ba4258066a50f0e029fcc641f5">parser</a>.<a name="a89"></a><a class="code" href="structodp__pktio__parser__config__t.html#aff1f0d93e1f3cc93006aa613287378a2">layer</a> = <a name="a90"></a><a class="code" href="group__odp__packet.html#gga428cdbec9e7bc0bc19286f9564f9828ba5404cdbbe70c105fa88e1e0c146cce54">ODP_PROTO_LAYER_NONE</a>;</div>
<div class="line">    <a name="a91"></a><a class="code" href="group__odp__packet__io.html#ga7f9faaf250d3d0d87478ff9f13680bf1">odp_pktio_config</a>(gbl_args-&gt;pktio_rx, &amp;cfg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.num_ifaces &gt; 1) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet__io.html#gafc2120185a8da74540feade78623f3b3">odp_pktout_queue_config</a>(gbl_args-&gt;pktio_rx, NULL)) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;failed to configure pktio_rx queue\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet__io.html#gaf9dce6b2cc13ad715e777416dce88194">odp_pktin_queue_config</a>(gbl_args-&gt;pktio_rx, NULL)) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;failed to configure pktio_rx queue\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a92"></a><a class="code" href="group__odp__packet__io.html#ga9a5746e73616297fabb8d4caaa6d0333">odp_pktio_start</a>(gbl_args-&gt;pktio_tx) != 0)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;args.num_ifaces &gt; 1 &amp;&amp;</div>
<div class="line">        <a class="code" href="group__odp__packet__io.html#ga9a5746e73616297fabb8d4caaa6d0333">odp_pktio_start</a>(gbl_args-&gt;pktio_rx))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> empty_inq(<a class="code" href="struct__odp__abi__pktio__t.html">odp_pktio_t</a> pktio)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__queue__t.html">odp_queue_t</a> queue = <a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>;</div>
<div class="line">    <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> ev;</div>
<div class="line">    <a class="code" href="group__odp__queue.html#ga89a3439d3f3be48cac1767cba721edda">odp_queue_type_t</a> q_type;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet__io.html#ga7a0b3f09fd55576daa9617dc29c60ace">odp_pktin_event_queue</a>(pktio, &amp;queue, 1) != 1)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    q_type = <a name="a93"></a><a class="code" href="group__odp__queue.html#gabd5efb727202708c6c497645857cef14">odp_queue_type</a>(queue);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* flush any pending events */</span></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        <span class="keywordflow">if</span> (q_type == <a name="a94"></a><a class="code" href="group__odp__queue.html#gga89a3439d3f3be48cac1767cba721eddaa69fd3bbfcc13b52104f11c914f31d374">ODP_QUEUE_TYPE_PLAIN</a>)</div>
<div class="line">            ev = <a class="code" href="group__odp__queue.html#ga8429f65feb58e20109d7f15a4dcfd08b">odp_queue_deq</a>(queue);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            ev = <a class="code" href="group__odp__scheduler.html#gae4ca1012ebb16ff8b9752b958dc45ce6">odp_schedule</a>(NULL, <a class="code" href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ev != <a class="code" href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a>)</div>
<div class="line">            <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> test_term(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> pool_name[<a class="code" href="group__odp__pool.html#ga1fcadb459ae1a3da8cca7360bd4de058">ODP_POOL_NAME_LEN</a>];</div>
<div class="line">    <a class="code" href="struct__odp__abi__pool__t.html">odp_pool_t</a> pool;</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line">    <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;pktio_tx != gbl_args-&gt;pktio_rx) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a95"></a><a class="code" href="group__odp__packet__io.html#gab34cb9679bf99d1b3366f06a9b155c41">odp_pktio_stop</a>(gbl_args-&gt;pktio_tx)) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Failed to stop pktio_tx\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a96"></a><a class="code" href="group__odp__packet__io.html#ga2e481c9f2f073cc337aff7f4c65cba7c">odp_pktio_close</a>(gbl_args-&gt;pktio_tx)) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Failed to close pktio_tx\n&quot;</span>);</div>
<div class="line">            ret = -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    empty_inq(gbl_args-&gt;pktio_rx);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet__io.html#gab34cb9679bf99d1b3366f06a9b155c41">odp_pktio_stop</a>(gbl_args-&gt;pktio_rx)) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Failed to stop pktio_rx\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet__io.html#ga2e481c9f2f073cc337aff7f4c65cba7c">odp_pktio_close</a>(gbl_args-&gt;pktio_rx) != 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Failed to close pktio_rx\n&quot;</span>);</div>
<div class="line">        ret = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; gbl_args-&gt;args.num_ifaces; ++i) {</div>
<div class="line">        snprintf(pool_name, <span class="keyword">sizeof</span>(pool_name),</div>
<div class="line">             <span class="stringliteral">&quot;pkt_pool_%s&quot;</span>, gbl_args-&gt;args.ifaces[i]);</div>
<div class="line">        pool = <a name="a97"></a><a class="code" href="group__odp__pool.html#ga80cbcff29933fbc847026c9c888aefe7">odp_pool_lookup</a>(pool_name);</div>
<div class="line">        <span class="keywordflow">if</span> (pool == <a class="code" href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a98"></a><a class="code" href="group__odp__pool.html#ga6ad439aaef911d82b972c915850e6924">odp_pool_destroy</a>(pool) != 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Failed to destroy pool %s\n&quot;</span>, pool_name);</div>
<div class="line">            ret = -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__pool.html#ga6ad439aaef911d82b972c915850e6924">odp_pool_destroy</a>(gbl_args-&gt;transmit_pkt_pool) != 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Failed to destroy transmit pool\n&quot;</span>);</div>
<div class="line">        ret = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    free(gbl_args-&gt;args.if_str);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a99"></a><a class="code" href="group__odp__shared__memory.html#ga0b02991b512acc119206b44c95a86ed6">odp_shm_free</a>(<a class="code" href="group__odp__shared__memory.html#ga090e9d9d3076bfeb3d2cb60793829453">odp_shm_lookup</a>(<span class="stringliteral">&quot;test_globals&quot;</span>)) != 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Failed to free test_globals\n&quot;</span>);</div>
<div class="line">        ret = -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__shared__memory.html#ga0b02991b512acc119206b44c95a86ed6">odp_shm_free</a>(<a class="code" href="group__odp__shared__memory.html#ga090e9d9d3076bfeb3d2cb60793829453">odp_shm_lookup</a>(<span class="stringliteral">&quot;test_globals.rx_stats&quot;</span>)) != 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Failed to free test_globals.rx_stats\n&quot;</span>);</div>
<div class="line">        ret = -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__shared__memory.html#ga0b02991b512acc119206b44c95a86ed6">odp_shm_free</a>(<a class="code" href="group__odp__shared__memory.html#ga090e9d9d3076bfeb3d2cb60793829453">odp_shm_lookup</a>(<span class="stringliteral">&quot;test_globals.tx_stats&quot;</span>)) != 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Failed to free test_globals.tx_stats\n&quot;</span>);</div>
<div class="line">        ret = -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> usage(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nUsage: odp_pktio_perf [options]\n\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -c, --count &lt;number&gt;   CPU count, 0=all available, default=2\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -t, --txcount &lt;number&gt; Number of CPUs to use for TX\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;                         default: cpu_count+1/2\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -b, --txbatch &lt;length&gt; Number of packets per TX batch\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;                         default: %d\n&quot;</span>, BATCH_LEN_MAX);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -p, --plain            Plain input queue for packet RX\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;                         default: disabled (use scheduler)\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -R, --rxbatch &lt;length&gt; Number of packets per RX batch\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;                         default: %d\n&quot;</span>, BATCH_LEN_MAX);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -l, --length &lt;length&gt;  Additional payload length in bytes\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;                         default: 0\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -r, --rate &lt;number&gt;    Attempted packet rate in PPS\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -i, --interface &lt;list&gt; List of interface names to use\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -d, --duration &lt;secs&gt;  Duration of each test iteration\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -v, --verbose          Print verbose information\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  -h, --help             This help\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_args(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[], test_args_t *args)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>option longopts[] = {</div>
<div class="line">        {<span class="stringliteral">&quot;count&quot;</span>,     required_argument, NULL, <span class="charliteral">&#39;c&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;txcount&quot;</span>,   required_argument, NULL, <span class="charliteral">&#39;t&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;txbatch&quot;</span>,   required_argument, NULL, <span class="charliteral">&#39;b&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;plain&quot;</span>,     no_argument,       NULL, <span class="charliteral">&#39;p&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;rxbatch&quot;</span>,   required_argument, NULL, <span class="charliteral">&#39;R&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;length&quot;</span>,    required_argument, NULL, <span class="charliteral">&#39;l&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;rate&quot;</span>,      required_argument, NULL, <span class="charliteral">&#39;r&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;interface&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;i&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;duration&quot;</span>,  required_argument, NULL, <span class="charliteral">&#39;d&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;verbose&quot;</span>,   no_argument,       NULL, <span class="charliteral">&#39;v&#39;</span>},</div>
<div class="line">        {<span class="stringliteral">&quot;help&quot;</span>,      no_argument,       NULL, <span class="charliteral">&#39;h&#39;</span>},</div>
<div class="line">        {NULL, 0, NULL, 0}</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *shortopts = <span class="stringliteral">&quot;+c:t:b:pR:l:r:i:d:vh&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    args-&gt;cpu_count      = 2;</div>
<div class="line">    args-&gt;num_tx_workers = 0; <span class="comment">/* defaults to cpu_count+1/2 */</span></div>
<div class="line">    args-&gt;tx_batch_len   = BATCH_LEN_MAX;</div>
<div class="line">    args-&gt;rx_batch_len   = BATCH_LEN_MAX;</div>
<div class="line">    args-&gt;duration       = DEFAULT_DURATION;</div>
<div class="line">    args-&gt;pps            = RATE_SEARCH_INITIAL_PPS;</div>
<div class="line">    args-&gt;search         = 1;</div>
<div class="line">    args-&gt;schedule       = 1;</div>
<div class="line">    args-&gt;verbose        = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        opt = getopt_long(argc, argv, shortopts,</div>
<div class="line">                  longopts, NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (opt == -1)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line">            usage();</div>
<div class="line">            exit(EXIT_SUCCESS);</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line">            args-&gt;cpu_count = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line">            args-&gt;num_tx_workers = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line">            args-&gt;duration = atoi(optarg) * T_SCALE;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line">            args-&gt;pps     = atoi(optarg);</div>
<div class="line">            args-&gt;search  = 0;</div>
<div class="line">            args-&gt;verbose = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">char</span> *token;</div>
<div class="line"> </div>
<div class="line">            args-&gt;if_str = malloc(strlen(optarg) + 1);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!args-&gt;if_str)</div>
<div class="line">                ODPH_ABORT(<span class="stringliteral">&quot;Failed to alloc iface storage\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            strcpy(args-&gt;if_str, optarg);</div>
<div class="line">            <span class="keywordflow">for</span> (token = strtok(args-&gt;if_str, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line">                 token != NULL &amp;&amp; args-&gt;num_ifaces &lt; MAX_NUM_IFACES;</div>
<div class="line">                 token = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>))</div>
<div class="line">                args-&gt;ifaces[args-&gt;num_ifaces++] = token;</div>
<div class="line">        }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line">            args-&gt;schedule = 0;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line">            args-&gt;tx_batch_len = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:</div>
<div class="line">            args-&gt;rx_batch_len = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:</div>
<div class="line">            args-&gt;verbose = 1;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line">            args-&gt;pkt_len = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (args-&gt;num_ifaces == 0) {</div>
<div class="line">        args-&gt;ifaces[0] = <span class="stringliteral">&quot;loop&quot;</span>;</div>
<div class="line">        args-&gt;num_ifaces = 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <a name="_a100"></a><a class="code" href="struct__odp__abi__shm__t.html">odp_shm_t</a> shm;</div>
<div class="line">    <span class="keywordtype">int</span> max_thrs;</div>
<div class="line">    odph_helper_options_t helper_options;</div>
<div class="line">    <a class="code" href="group__odp__initialization.html#ga8d362bd3c7c87ab5892ca63b15c375c0">odp_instance_t</a> instance;</div>
<div class="line">    <a name="_a101"></a><a class="code" href="structodp__init__t.html">odp_init_t</a> init_param;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Let helper collect its own arguments (e.g. --odph_proc) */</span></div>
<div class="line">    argc = odph_parse_options(argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (odph_options(&amp;helper_options)) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error: reading ODP helper options failed.\n&quot;</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a102"></a><a class="code" href="group__odp__initialization.html#ga145c4fc4417c8f58efd0852b34e25ba9">odp_init_param_init</a>(&amp;init_param);</div>
<div class="line">    init_param.<a name="a103"></a><a class="code" href="structodp__init__t.html#a7d368c740146170ebeb1651ce049919e">mem_model</a> = helper_options.mem_model;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a104"></a><a class="code" href="group__odp__initialization.html#ga68d81088e65ef66180fb51076905e34d">odp_init_global</a>(&amp;instance, &amp;init_param, NULL) != 0)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Failed global init.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a105"></a><a class="code" href="group__odp__initialization.html#ga265470ea614bfeca9d8901e81ddefca9">odp_init_local</a>(instance, <a name="a106"></a><a class="code" href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a9aab3fdb10eb2000a864bff81f23c00a">ODP_THREAD_CONTROL</a>) != 0)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Failed local init.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a name="a107"></a><a class="code" href="group__odp__system.html#gab0a1cd5e503d5ec067e8d17d228b937d">odp_sys_info_print</a>();</div>
<div class="line"> </div>
<div class="line">    shm = <a name="a108"></a><a class="code" href="group__odp__shared__memory.html#gacc441b0e100ec1c54e21f1745939a2d8">odp_shm_reserve</a>(<span class="stringliteral">&quot;test_globals&quot;</span>,</div>
<div class="line">                  <span class="keyword">sizeof</span>(test_globals_t), ODP_CACHE_LINE_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (shm == <a name="a109"></a><a class="code" href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a>)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Shared memory reserve failed.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    gbl_args = <a class="code" href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a>(shm);</div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args == NULL)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Shared memory reserve failed.\n&quot;</span>);</div>
<div class="line">    memset(gbl_args, 0, <span class="keyword">sizeof</span>(test_globals_t));</div>
<div class="line"> </div>
<div class="line">    max_thrs = <a class="code" href="group__odp__thread.html#gaa3b169c5b129a7306d4a941b15883833">odp_thread_count_max</a>();</div>
<div class="line"> </div>
<div class="line">    gbl_args-&gt;instance = instance;</div>
<div class="line">    gbl_args-&gt;rx_stats_size = max_thrs * <span class="keyword">sizeof</span>(pkt_rx_stats_t);</div>
<div class="line">    gbl_args-&gt;tx_stats_size = max_thrs * <span class="keyword">sizeof</span>(pkt_tx_stats_t);</div>
<div class="line"> </div>
<div class="line">    shm = <a class="code" href="group__odp__shared__memory.html#gacc441b0e100ec1c54e21f1745939a2d8">odp_shm_reserve</a>(<span class="stringliteral">&quot;test_globals.rx_stats&quot;</span>,</div>
<div class="line">                  gbl_args-&gt;rx_stats_size,</div>
<div class="line">                  ODP_CACHE_LINE_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (shm == <a class="code" href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a>)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Shared memory reserve failed.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    gbl_args-&gt;rx_stats = <a class="code" href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a>(shm);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;rx_stats == NULL)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Shared memory reserve failed.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    memset(gbl_args-&gt;rx_stats, 0, gbl_args-&gt;rx_stats_size);</div>
<div class="line"> </div>
<div class="line">    shm = <a class="code" href="group__odp__shared__memory.html#gacc441b0e100ec1c54e21f1745939a2d8">odp_shm_reserve</a>(<span class="stringliteral">&quot;test_globals.tx_stats&quot;</span>,</div>
<div class="line">                  gbl_args-&gt;tx_stats_size,</div>
<div class="line">                  ODP_CACHE_LINE_SIZE, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (shm == <a class="code" href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a>)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Shared memory reserve failed.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    gbl_args-&gt;tx_stats = <a class="code" href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a>(shm);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (gbl_args-&gt;tx_stats == NULL)</div>
<div class="line">        ODPH_ABORT(<span class="stringliteral">&quot;Shared memory reserve failed.\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    memset(gbl_args-&gt;tx_stats, 0, gbl_args-&gt;tx_stats_size);</div>
<div class="line"> </div>
<div class="line">    parse_args(argc, argv, &amp;gbl_args-&gt;args);</div>
<div class="line"> </div>
<div class="line">    ret = test_init();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        ret = run_test();</div>
<div class="line">        test_term();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a110"></a><a class="code" href="group__odp__initialization.html#ga6d15f0e1718da9477948dedb06a2f01a">odp_term_local</a>();</div>
<div class="line">    <a name="a111"></a><a class="code" href="group__odp__initialization.html#ga87e9c66ad92201c9e0a710294eab1569">odp_term_global</a>(instance);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__odp__atomic_html_ga0029015adacaadb06ee94ea67d00eece"><div class="ttname"><a href="group__odp__atomic.html#ga0029015adacaadb06ee94ea67d00eece">odp_atomic_init_u32</a></div><div class="ttdeci">void odp_atomic_init_u32(odp_atomic_u32_t *atom, uint32_t val)</div><div class="ttdoc">Initialize atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__atomic_html_ga1ebc0fa6d690c24bd2bcc38bcb9a2276"><div class="ttname"><a href="group__odp__atomic.html#ga1ebc0fa6d690c24bd2bcc38bcb9a2276">odp_atomic_load_u32</a></div><div class="ttdeci">uint32_t odp_atomic_load_u32(odp_atomic_u32_t *atom)</div><div class="ttdoc">Load value of atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__atomic_html_ga71a1eeba2eeafb1a0d09728f79a6a4c4"><div class="ttname"><a href="group__odp__atomic.html#ga71a1eeba2eeafb1a0d09728f79a6a4c4">odp_atomic_fetch_add_u32</a></div><div class="ttdeci">uint32_t odp_atomic_fetch_add_u32(odp_atomic_u32_t *atom, uint32_t val)</div><div class="ttdoc">Fetch and add to atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__atomic_html_gaa6d2d16a9ef9897b1442d77e41f7101e"><div class="ttname"><a href="group__odp__atomic.html#gaa6d2d16a9ef9897b1442d77e41f7101e">odp_atomic_store_u32</a></div><div class="ttdeci">void odp_atomic_store_u32(odp_atomic_u32_t *atom, uint32_t val)</div><div class="ttdoc">Store value to atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__barrier_html_ga1416b47755c2af6267074959ac0d4840"><div class="ttname"><a href="group__odp__barrier.html#ga1416b47755c2af6267074959ac0d4840">odp_barrier_init</a></div><div class="ttdeci">void odp_barrier_init(odp_barrier_t *barr, int count)</div><div class="ttdoc">Initialize barrier with thread count.</div></div>
<div class="ttc" id="agroup__odp__barrier_html_ga97c8f84490e816330f96155acf0b4b77"><div class="ttname"><a href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a></div><div class="ttdeci">void odp_barrier_wait(odp_barrier_t *barr)</div><div class="ttdoc">Synchronize thread execution on barrier.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga205a8257879c02657e7c39ee7ad5e40a"><div class="ttname"><a href="group__odp__compiler__optim.html#ga205a8257879c02657e7c39ee7ad5e40a">ODP_ALIGNED_CACHE</a></div><div class="ttdeci">#define ODP_ALIGNED_CACHE</div><div class="ttdoc">Defines type/struct/variable to be cache line size aligned.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga2b29f27f12b751250b471aa9c14c57c8"><div class="ttname"><a href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a></div><div class="ttdeci">#define odp_unlikely(x)</div><div class="ttdoc">Branch unlikely taken.</div><div class="ttdef"><b>Definition:</b> <a href="spec_2hints_8h_source.html#l00064">spec/hints.h:64</a></div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga2b6519f1042fc82dd7361061f27a6fe1"><div class="ttname"><a href="group__odp__compiler__optim.html#ga2b6519f1042fc82dd7361061f27a6fe1">odp_u32be_t</a></div><div class="ttdeci">uint32_t odp_u32be_t</div><div class="ttdoc">unsigned 32bit big endian</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2byteorder_8h_source.html#l00055">api/abi-default/byteorder.h:55</a></div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga388e5edab224f1315443269a61d30617"><div class="ttname"><a href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a></div><div class="ttdeci">odp_u16be_t odp_cpu_to_be_16(uint16_t cpu16)</div><div class="ttdoc">Convert cpu native uint16_t to 16bit big endian.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga68d9a1bb3d2dcfdf476b2d9e16b89e4d"><div class="ttname"><a href="group__odp__compiler__optim.html#ga68d9a1bb3d2dcfdf476b2d9e16b89e4d">odp_likely</a></div><div class="ttdeci">#define odp_likely(x)</div><div class="ttdoc">Branch likely taken.</div><div class="ttdef"><b>Definition:</b> <a href="spec_2hints_8h_source.html#l00059">spec/hints.h:59</a></div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_gaa81eaf9fb95b261887270978a1da909b"><div class="ttname"><a href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a></div><div class="ttdeci">odp_u32be_t odp_cpu_to_be_32(uint32_t cpu32)</div><div class="ttdoc">Convert cpu native uint32_t to 32bit big endian.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga42b4df58e6727850aa8d1eca3aa252e5"><div class="ttname"><a href="group__odp__cpumask.html#ga42b4df58e6727850aa8d1eca3aa252e5">odp_cpumask_set</a></div><div class="ttdeci">void odp_cpumask_set(odp_cpumask_t *mask, int cpu)</div><div class="ttdoc">Add CPU to mask.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga4ff2d29f52775b12c7df1995754b524d"><div class="ttname"><a href="group__odp__cpumask.html#ga4ff2d29f52775b12c7df1995754b524d">odp_cpumask_default_worker</a></div><div class="ttdeci">int odp_cpumask_default_worker(odp_cpumask_t *mask, int num)</div><div class="ttdoc">Default CPU mask for worker threads.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga5c9dfaf2a18b336a537f552e122ac41d"><div class="ttname"><a href="group__odp__cpumask.html#ga5c9dfaf2a18b336a537f552e122ac41d">odp_cpumask_first</a></div><div class="ttdeci">int odp_cpumask_first(const odp_cpumask_t *mask)</div><div class="ttdoc">Find first set CPU in mask.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga643e71985a781cdd43bac218df03304b"><div class="ttname"><a href="group__odp__cpumask.html#ga643e71985a781cdd43bac218df03304b">odp_cpumask_next</a></div><div class="ttdeci">int odp_cpumask_next(const odp_cpumask_t *mask, int cpu)</div><div class="ttdoc">Find next set CPU in mask.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga6b12769c4dc0729aa057d88a450eb727"><div class="ttname"><a href="group__odp__cpumask.html#ga6b12769c4dc0729aa057d88a450eb727">odp_cpumask_zero</a></div><div class="ttdeci">void odp_cpumask_zero(odp_cpumask_t *mask)</div><div class="ttdoc">Clear entire CPU mask.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga8d4d03c213437875e71d39bd1ae600a9"><div class="ttname"><a href="group__odp__cpumask.html#ga8d4d03c213437875e71d39bd1ae600a9">odp_cpumask_count</a></div><div class="ttdeci">int odp_cpumask_count(const odp_cpumask_t *mask)</div><div class="ttdoc">Count number of CPUs set in mask.</div></div>
<div class="ttc" id="agroup__odp__event_html_ga1622f73356c325f625db747cb3badf8d"><div class="ttname"><a href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a></div><div class="ttdeci">void odp_event_free(odp_event_t event)</div><div class="ttdoc">Free event.</div></div>
<div class="ttc" id="agroup__odp__event_html_ga4bd59cdf228fe0c36b8e04fe122e047a"><div class="ttname"><a href="group__odp__event.html#ga4bd59cdf228fe0c36b8e04fe122e047a">odp_event_type</a></div><div class="ttdeci">odp_event_type_t odp_event_type(odp_event_t event)</div><div class="ttdoc">Event type of an event.</div></div>
<div class="ttc" id="agroup__odp__event_html_gae1a3732a534ba7a892fca38b824591b0"><div class="ttname"><a href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a></div><div class="ttdeci">#define ODP_EVENT_INVALID</div><div class="ttdoc">Invalid event.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga145c4fc4417c8f58efd0852b34e25ba9"><div class="ttname"><a href="group__odp__initialization.html#ga145c4fc4417c8f58efd0852b34e25ba9">odp_init_param_init</a></div><div class="ttdeci">void odp_init_param_init(odp_init_t *param)</div><div class="ttdoc">Initialize the odp_init_t to default values for all fields.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga265470ea614bfeca9d8901e81ddefca9"><div class="ttname"><a href="group__odp__initialization.html#ga265470ea614bfeca9d8901e81ddefca9">odp_init_local</a></div><div class="ttdeci">int odp_init_local(odp_instance_t instance, odp_thread_type_t thr_type)</div><div class="ttdoc">Thread local ODP initialization.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga68d81088e65ef66180fb51076905e34d"><div class="ttname"><a href="group__odp__initialization.html#ga68d81088e65ef66180fb51076905e34d">odp_init_global</a></div><div class="ttdeci">int odp_init_global(odp_instance_t *instance, const odp_init_t *params, const odp_platform_init_t *platform_params)</div><div class="ttdoc">Global ODP initialization.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga6d15f0e1718da9477948dedb06a2f01a"><div class="ttname"><a href="group__odp__initialization.html#ga6d15f0e1718da9477948dedb06a2f01a">odp_term_local</a></div><div class="ttdeci">int odp_term_local(void)</div><div class="ttdoc">Thread local ODP termination.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga87e9c66ad92201c9e0a710294eab1569"><div class="ttname"><a href="group__odp__initialization.html#ga87e9c66ad92201c9e0a710294eab1569">odp_term_global</a></div><div class="ttdeci">int odp_term_global(odp_instance_t instance)</div><div class="ttdoc">Global ODP termination.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga8d362bd3c7c87ab5892ca63b15c375c0"><div class="ttname"><a href="group__odp__initialization.html#ga8d362bd3c7c87ab5892ca63b15c375c0">odp_instance_t</a></div><div class="ttdeci">uint64_t odp_instance_t</div><div class="ttdoc">ODP instance ID.</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2init_8h_source.html#l00031">api/abi-default/init.h:31</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga04d67c951aff803cf718940e0783ef8f"><div class="ttname"><a href="group__odp__packet__io.html#ga04d67c951aff803cf718940e0783ef8f">odp_pktio_mac_addr</a></div><div class="ttdeci">int odp_pktio_mac_addr(odp_pktio_t pktio, void *mac_addr, int size)</div><div class="ttdoc">Get the default MAC address of a packet IO interface.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga26d165a22d659770eba0c48543860881"><div class="ttname"><a href="group__odp__packet__io.html#ga26d165a22d659770eba0c48543860881">odp_pktio_param_init</a></div><div class="ttdeci">void odp_pktio_param_init(odp_pktio_param_t *param)</div><div class="ttdoc">Initialize pktio params.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga2e481c9f2f073cc337aff7f4c65cba7c"><div class="ttname"><a href="group__odp__packet__io.html#ga2e481c9f2f073cc337aff7f4c65cba7c">odp_pktio_close</a></div><div class="ttdeci">int odp_pktio_close(odp_pktio_t pktio)</div><div class="ttdoc">Close a packet IO interface.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga41a3ebb7ac489b85a5f7560e4d4f77f5"><div class="ttname"><a href="group__odp__packet__io.html#ga41a3ebb7ac489b85a5f7560e4d4f77f5">odp_pktout_queue</a></div><div class="ttdeci">int odp_pktout_queue(odp_pktio_t pktio, odp_pktout_queue_t queues[], int num)</div><div class="ttdoc">Direct packet output queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga6a1c262ef999e8a73ac107c182b67d33"><div class="ttname"><a href="group__odp__packet__io.html#ga6a1c262ef999e8a73ac107c182b67d33">odp_pktio_config_init</a></div><div class="ttdeci">void odp_pktio_config_init(odp_pktio_config_t *config)</div><div class="ttdoc">Initialize packet IO configuration options.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga7a0b3f09fd55576daa9617dc29c60ace"><div class="ttname"><a href="group__odp__packet__io.html#ga7a0b3f09fd55576daa9617dc29c60ace">odp_pktin_event_queue</a></div><div class="ttdeci">int odp_pktin_event_queue(odp_pktio_t pktio, odp_queue_t queues[], int num)</div><div class="ttdoc">Event queues for packet input.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga7ae4f96ab09d468fff3623d90db306f9"><div class="ttname"><a href="group__odp__packet__io.html#ga7ae4f96ab09d468fff3623d90db306f9">odp_pktio_open</a></div><div class="ttdeci">odp_pktio_t odp_pktio_open(const char *name, odp_pool_t pool, const odp_pktio_param_t *param)</div><div class="ttdoc">Open a packet IO interface.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga7f9faaf250d3d0d87478ff9f13680bf1"><div class="ttname"><a href="group__odp__packet__io.html#ga7f9faaf250d3d0d87478ff9f13680bf1">odp_pktio_config</a></div><div class="ttdeci">int odp_pktio_config(odp_pktio_t pktio, const odp_pktio_config_t *config)</div><div class="ttdoc">Configure packet IO interface options.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga9a5746e73616297fabb8d4caaa6d0333"><div class="ttname"><a href="group__odp__packet__io.html#ga9a5746e73616297fabb8d4caaa6d0333">odp_pktio_start</a></div><div class="ttdeci">int odp_pktio_start(odp_pktio_t pktio)</div><div class="ttdoc">Start packet receive and transmit.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga9c7d0fcaec232b5503633e42ea29f6f5"><div class="ttname"><a href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a></div><div class="ttdeci">#define ODP_PKTIO_INVALID</div><div class="ttdoc">Invalid packet IO handle.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gab34cb9679bf99d1b3366f06a9b155c41"><div class="ttname"><a href="group__odp__packet__io.html#gab34cb9679bf99d1b3366f06a9b155c41">odp_pktio_stop</a></div><div class="ttdeci">int odp_pktio_stop(odp_pktio_t pktio)</div><div class="ttdoc">Stop packet receive and transmit.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gacb5db3a908775522e316c8b8ccb36498"><div class="ttname"><a href="group__odp__packet__io.html#gacb5db3a908775522e316c8b8ccb36498">odp_pktout_send</a></div><div class="ttdeci">int odp_pktout_send(odp_pktout_queue_t queue, const odp_packet_t packets[], int num)</div><div class="ttdoc">Send packets directly to an interface output queue.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gaf9dce6b2cc13ad715e777416dce88194"><div class="ttname"><a href="group__odp__packet__io.html#gaf9dce6b2cc13ad715e777416dce88194">odp_pktin_queue_config</a></div><div class="ttdeci">int odp_pktin_queue_config(odp_pktio_t pktio, const odp_pktin_queue_param_t *param)</div><div class="ttdoc">Configure packet input queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gafc2120185a8da74540feade78623f3b3"><div class="ttname"><a href="group__odp__packet__io.html#gafc2120185a8da74540feade78623f3b3">odp_pktout_queue_config</a></div><div class="ttdeci">int odp_pktout_queue_config(odp_pktio_t pktio, const odp_pktout_queue_param_t *param)</div><div class="ttdoc">Configure packet output queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ggaf5d539df6fc8af55d96357c784a54b8fa502928549b130729ee8c71ab14cee89a"><div class="ttname"><a href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8fa502928549b130729ee8c71ab14cee89a">ODP_PKTIN_MODE_QUEUE</a></div><div class="ttdeci">@ ODP_PKTIN_MODE_QUEUE</div><div class="ttdoc">Packet input through plain event queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00100">api/spec/packet_io_types.h:100</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ggaf5d539df6fc8af55d96357c784a54b8faa4f62db7acbe492a3b80f3f782a04dd5"><div class="ttname"><a href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8faa4f62db7acbe492a3b80f3f782a04dd5">ODP_PKTIN_MODE_SCHED</a></div><div class="ttdeci">@ ODP_PKTIN_MODE_SCHED</div><div class="ttdoc">Packet input through scheduler and scheduled event queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00098">api/spec/packet_io_types.h:98</a></div></div>
<div class="ttc" id="agroup__odp__packet_html_ga1b1c25d6a81b1f3c2cb82188b3721a6f"><div class="ttname"><a href="group__odp__packet.html#ga1b1c25d6a81b1f3c2cb82188b3721a6f">odp_packet_l3_offset_set</a></div><div class="ttdeci">int odp_packet_l3_offset_set(odp_packet_t pkt, uint32_t offset)</div><div class="ttdoc">Set layer 3 start offset.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga433ba21e3c83c6d4d9831c9e732b63de"><div class="ttname"><a href="group__odp__packet.html#ga433ba21e3c83c6d4d9831c9e732b63de">odp_packet_data</a></div><div class="ttdeci">void * odp_packet_data(odp_packet_t pkt)</div><div class="ttdoc">Packet data pointer.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga4629db8bf7e9b378f8a83b7aabab8248"><div class="ttname"><a href="group__odp__packet.html#ga4629db8bf7e9b378f8a83b7aabab8248">odp_packet_l4_offset_set</a></div><div class="ttdeci">int odp_packet_l4_offset_set(odp_packet_t pkt, uint32_t offset)</div><div class="ttdoc">Set layer 4 start offset.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga7528dda77d71a9dbfe563dffb62d8318"><div class="ttname"><a href="group__odp__packet.html#ga7528dda77d71a9dbfe563dffb62d8318">odp_packet_alloc</a></div><div class="ttdeci">odp_packet_t odp_packet_alloc(odp_pool_t pool, uint32_t len)</div><div class="ttdoc">Allocate a packet from a packet pool.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga79bdc8c991e23c5e676b31e630bc31f3"><div class="ttname"><a href="group__odp__packet.html#ga79bdc8c991e23c5e676b31e630bc31f3">odp_packet_l2_offset_set</a></div><div class="ttdeci">int odp_packet_l2_offset_set(odp_packet_t pkt, uint32_t offset)</div><div class="ttdoc">Set layer 2 start offset.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga8605e7d4629a479f7b1a59da121c601c"><div class="ttname"><a href="group__odp__packet.html#ga8605e7d4629a479f7b1a59da121c601c">odp_packet_from_event</a></div><div class="ttdeci">odp_packet_t odp_packet_from_event(odp_event_t ev)</div><div class="ttdoc">Get packet handle from event.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gab67164b42ca75ae96615af7cebbfc414"><div class="ttname"><a href="group__odp__packet.html#gab67164b42ca75ae96615af7cebbfc414">odp_packet_copy_from_mem</a></div><div class="ttdeci">int odp_packet_copy_from_mem(odp_packet_t pkt, uint32_t offset, uint32_t len, const void *src)</div><div class="ttdoc">Copy data from memory to packet.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gaba8cf39480fb133ab8299155d4ef63dc"><div class="ttname"><a href="group__odp__packet.html#gaba8cf39480fb133ab8299155d4ef63dc">ODP_PACKET_INVALID</a></div><div class="ttdeci">#define ODP_PACKET_INVALID</div><div class="ttdoc">Invalid packet.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gad190c5b094a0406b9d86da03f10c15cb"><div class="ttname"><a href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a></div><div class="ttdeci">void odp_packet_free_multi(const odp_packet_t pkt[], int num)</div><div class="ttdoc">Free multiple packets.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gadf9179122029a9dd7a000e050f68b357"><div class="ttname"><a href="group__odp__packet.html#gadf9179122029a9dd7a000e050f68b357">odp_packet_copy_to_mem</a></div><div class="ttdeci">int odp_packet_copy_to_mem(odp_packet_t pkt, uint32_t offset, uint32_t len, void *dst)</div><div class="ttdoc">Copy data from packet to memory.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gga428cdbec9e7bc0bc19286f9564f9828ba5404cdbbe70c105fa88e1e0c146cce54"><div class="ttname"><a href="group__odp__packet.html#gga428cdbec9e7bc0bc19286f9564f9828ba5404cdbbe70c105fa88e1e0c146cce54">ODP_PROTO_LAYER_NONE</a></div><div class="ttdeci">@ ODP_PROTO_LAYER_NONE</div><div class="ttdoc">No layers.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__types_8h_source.html#l00236">api/spec/packet_types.h:236</a></div></div>
<div class="ttc" id="agroup__odp__pool_html_ga1fcadb459ae1a3da8cca7360bd4de058"><div class="ttname"><a href="group__odp__pool.html#ga1fcadb459ae1a3da8cca7360bd4de058">ODP_POOL_NAME_LEN</a></div><div class="ttdeci">#define ODP_POOL_NAME_LEN</div><div class="ttdoc">Maximum pool name length, including the null character.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga256909a276600c25ce11b52ae274632f"><div class="ttname"><a href="group__odp__pool.html#ga256909a276600c25ce11b52ae274632f">odp_pool_create</a></div><div class="ttdeci">odp_pool_t odp_pool_create(const char *name, const odp_pool_param_t *param)</div><div class="ttdoc">Create a pool.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga3dd8bcfb920f81142e9fe27cfba24073"><div class="ttname"><a href="group__odp__pool.html#ga3dd8bcfb920f81142e9fe27cfba24073">odp_pool_param_init</a></div><div class="ttdeci">void odp_pool_param_init(odp_pool_param_t *param)</div><div class="ttdoc">Initialize pool params.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga6ad439aaef911d82b972c915850e6924"><div class="ttname"><a href="group__odp__pool.html#ga6ad439aaef911d82b972c915850e6924">odp_pool_destroy</a></div><div class="ttdeci">int odp_pool_destroy(odp_pool_t pool)</div><div class="ttdoc">Destroy a pool previously created by odp_pool_create()</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga80cbcff29933fbc847026c9c888aefe7"><div class="ttname"><a href="group__odp__pool.html#ga80cbcff29933fbc847026c9c888aefe7">odp_pool_lookup</a></div><div class="ttdeci">odp_pool_t odp_pool_lookup(const char *name)</div><div class="ttdoc">Find a pool by name.</div></div>
<div class="ttc" id="agroup__odp__pool_html_gafca03b58412260da754042a92f8a5e04"><div class="ttname"><a href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a></div><div class="ttdeci">#define ODP_POOL_INVALID</div><div class="ttdoc">Invalid pool.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd"><div class="ttname"><a href="group__odp__pool.html#ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd">ODP_POOL_PACKET</a></div><div class="ttdeci">@ ODP_POOL_PACKET</div><div class="ttdoc">Packet pool.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00436">api/spec/pool_types.h:436</a></div></div>
<div class="ttc" id="agroup__odp__queue_html_ga771259a58e71e065e0d00d2fc431b014"><div class="ttname"><a href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a></div><div class="ttdeci">#define ODP_QUEUE_INVALID</div><div class="ttdoc">Invalid queue.</div></div>
<div class="ttc" id="agroup__odp__queue_html_ga8429f65feb58e20109d7f15a4dcfd08b"><div class="ttname"><a href="group__odp__queue.html#ga8429f65feb58e20109d7f15a4dcfd08b">odp_queue_deq</a></div><div class="ttdeci">odp_event_t odp_queue_deq(odp_queue_t queue)</div><div class="ttdoc">Dequeue an event from a queue.</div></div>
<div class="ttc" id="agroup__odp__queue_html_ga89a3439d3f3be48cac1767cba721edda"><div class="ttname"><a href="group__odp__queue.html#ga89a3439d3f3be48cac1767cba721edda">odp_queue_type_t</a></div><div class="ttdeci">odp_queue_type_t</div><div class="ttdoc">Queue type.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2queue__types_8h_source.html#l00045">api/spec/queue_types.h:45</a></div></div>
<div class="ttc" id="agroup__odp__queue_html_gabd5efb727202708c6c497645857cef14"><div class="ttname"><a href="group__odp__queue.html#gabd5efb727202708c6c497645857cef14">odp_queue_type</a></div><div class="ttdeci">odp_queue_type_t odp_queue_type(odp_queue_t queue)</div><div class="ttdoc">Queue type.</div></div>
<div class="ttc" id="agroup__odp__queue_html_gaf75fc00e4a9cc4714bf311d9404fa0ad"><div class="ttname"><a href="group__odp__queue.html#gaf75fc00e4a9cc4714bf311d9404fa0ad">odp_queue_deq_multi</a></div><div class="ttdeci">int odp_queue_deq_multi(odp_queue_t queue, odp_event_t events[], int num)</div><div class="ttdoc">Dequeue multiple events from a queue.</div></div>
<div class="ttc" id="agroup__odp__queue_html_gga89a3439d3f3be48cac1767cba721eddaa69fd3bbfcc13b52104f11c914f31d374"><div class="ttname"><a href="group__odp__queue.html#gga89a3439d3f3be48cac1767cba721eddaa69fd3bbfcc13b52104f11c914f31d374">ODP_QUEUE_TYPE_PLAIN</a></div><div class="ttdeci">@ ODP_QUEUE_TYPE_PLAIN</div><div class="ttdoc">Plain queue.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2queue__types_8h_source.html#l00050">api/spec/queue_types.h:50</a></div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga34f1bae924466cc2b57563f8fe2dc0d1"><div class="ttname"><a href="group__odp__scheduler.html#ga34f1bae924466cc2b57563f8fe2dc0d1">odp_schedule_multi</a></div><div class="ttdeci">int odp_schedule_multi(odp_queue_t *from, uint64_t wait, odp_event_t events[], int num)</div><div class="ttdoc">Schedule multiple events.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga9116776b8262a74af7dac7ef46fc7ace"><div class="ttname"><a href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a></div><div class="ttdeci">#define ODP_SCHED_NO_WAIT</div><div class="ttdoc">Do not wait.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_gaa1b51ebd46adeb6aa7805fccb00144df"><div class="ttname"><a href="group__odp__scheduler.html#gaa1b51ebd46adeb6aa7805fccb00144df">odp_schedule_config</a></div><div class="ttdeci">int odp_schedule_config(const odp_schedule_config_t *config)</div><div class="ttdoc">Global schedule configuration.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_gae4ca1012ebb16ff8b9752b958dc45ce6"><div class="ttname"><a href="group__odp__scheduler.html#gae4ca1012ebb16ff8b9752b958dc45ce6">odp_schedule</a></div><div class="ttdeci">odp_event_t odp_schedule(odp_queue_t *from, uint64_t wait)</div><div class="ttdoc">Schedule an event.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_ga090e9d9d3076bfeb3d2cb60793829453"><div class="ttname"><a href="group__odp__shared__memory.html#ga090e9d9d3076bfeb3d2cb60793829453">odp_shm_lookup</a></div><div class="ttdeci">odp_shm_t odp_shm_lookup(const char *name)</div><div class="ttdoc">Lookup for a block of shared memory.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_ga0b02991b512acc119206b44c95a86ed6"><div class="ttname"><a href="group__odp__shared__memory.html#ga0b02991b512acc119206b44c95a86ed6">odp_shm_free</a></div><div class="ttdeci">int odp_shm_free(odp_shm_t shm)</div><div class="ttdoc">Free a contiguous block of shared memory.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_ga6e4289975efc279bb9f31880613a9d60"><div class="ttname"><a href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a></div><div class="ttdeci">#define ODP_SHM_INVALID</div><div class="ttdoc">Invalid shared memory block.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_gac94c4232f7cd64039bbaef601ff2c05e"><div class="ttname"><a href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a></div><div class="ttdeci">void * odp_shm_addr(odp_shm_t shm)</div><div class="ttdoc">Shared memory block address.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_gacc441b0e100ec1c54e21f1745939a2d8"><div class="ttname"><a href="group__odp__shared__memory.html#gacc441b0e100ec1c54e21f1745939a2d8">odp_shm_reserve</a></div><div class="ttdeci">odp_shm_t odp_shm_reserve(const char *name, uint64_t size, uint64_t align, uint32_t flags)</div><div class="ttdoc">Reserve a contiguous block of shared memory.</div></div>
<div class="ttc" id="agroup__odp__system_html_gab0a1cd5e503d5ec067e8d17d228b937d"><div class="ttname"><a href="group__odp__system.html#gab0a1cd5e503d5ec067e8d17d228b937d">odp_sys_info_print</a></div><div class="ttdeci">void odp_sys_info_print(void)</div><div class="ttdoc">Print system info.</div></div>
<div class="ttc" id="agroup__odp__thread_html_gaa3b169c5b129a7306d4a941b15883833"><div class="ttname"><a href="group__odp__thread.html#gaa3b169c5b129a7306d4a941b15883833">odp_thread_count_max</a></div><div class="ttdeci">int odp_thread_count_max(void)</div><div class="ttdoc">Maximum thread count.</div></div>
<div class="ttc" id="agroup__odp__thread_html_gad6562e7320d48463715bbf15748ae360"><div class="ttname"><a href="group__odp__thread.html#gad6562e7320d48463715bbf15748ae360">odp_thread_id</a></div><div class="ttdeci">int odp_thread_id(void)</div><div class="ttdoc">Get thread identifier.</div></div>
<div class="ttc" id="agroup__odp__thread_html_ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a"><div class="ttname"><a href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a">ODP_THREAD_WORKER</a></div><div class="ttdeci">@ ODP_THREAD_WORKER</div><div class="ttdoc">Worker thread.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2thread__types_8h_source.html#l00042">api/spec/thread_types.h:42</a></div></div>
<div class="ttc" id="agroup__odp__thread_html_ggafc7a7c180de9811d71b7cb050713bf53a9aab3fdb10eb2000a864bff81f23c00a"><div class="ttname"><a href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a9aab3fdb10eb2000a864bff81f23c00a">ODP_THREAD_CONTROL</a></div><div class="ttdeci">@ ODP_THREAD_CONTROL</div><div class="ttdoc">Control thread.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2thread__types_8h_source.html#l00054">api/spec/thread_types.h:53</a></div></div>
<div class="ttc" id="agroup__odp__time_html_ga04eed146c4559fb906766c4fbd4c2460"><div class="ttname"><a href="group__odp__time.html#ga04eed146c4559fb906766c4fbd4c2460">odp_time_to_ns</a></div><div class="ttdeci">uint64_t odp_time_to_ns(odp_time_t time)</div><div class="ttdoc">Convert time to nanoseconds.</div></div>
<div class="ttc" id="agroup__odp__time_html_ga1a5b41e057216483b4843120631f869a"><div class="ttname"><a href="group__odp__time.html#ga1a5b41e057216483b4843120631f869a">odp_time_diff</a></div><div class="ttdeci">odp_time_t odp_time_diff(odp_time_t t2, odp_time_t t1)</div><div class="ttdoc">Time difference.</div></div>
<div class="ttc" id="agroup__odp__time_html_ga2cf6345917d31805746337cf3c4b9c53"><div class="ttname"><a href="group__odp__time.html#ga2cf6345917d31805746337cf3c4b9c53">odp_time_sum</a></div><div class="ttdeci">odp_time_t odp_time_sum(odp_time_t t1, odp_time_t t2)</div><div class="ttdoc">Time sum.</div></div>
<div class="ttc" id="agroup__odp__time_html_ga49ab6f8fe6c0aa5b820717fd91f16ab5"><div class="ttname"><a href="group__odp__time.html#ga49ab6f8fe6c0aa5b820717fd91f16ab5">ODP_TIME_SEC_IN_NS</a></div><div class="ttdeci">#define ODP_TIME_SEC_IN_NS</div><div class="ttdoc">A second in nanoseconds.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2time__types_8h_source.html#l00031">api/spec/time_types.h:31</a></div></div>
<div class="ttc" id="agroup__odp__time_html_ga4dfd390b895e6a63601a935db7621139"><div class="ttname"><a href="group__odp__time.html#ga4dfd390b895e6a63601a935db7621139">odp_time_local_from_ns</a></div><div class="ttdeci">odp_time_t odp_time_local_from_ns(uint64_t ns)</div><div class="ttdoc">Convert nanoseconds to local time.</div></div>
<div class="ttc" id="agroup__odp__time_html_ga506b0234dfdd7c0dc98d6acd27d57f8a"><div class="ttname"><a href="group__odp__time.html#ga506b0234dfdd7c0dc98d6acd27d57f8a">odp_time_wait_ns</a></div><div class="ttdeci">void odp_time_wait_ns(uint64_t ns)</div><div class="ttdoc">Wait the specified number of nanoseconds.</div></div>
<div class="ttc" id="agroup__odp__time_html_ga5d0b24d7dae739bac7585ed515bd60a8"><div class="ttname"><a href="group__odp__time.html#ga5d0b24d7dae739bac7585ed515bd60a8">odp_time_local</a></div><div class="ttdeci">odp_time_t odp_time_local(void)</div><div class="ttdoc">Current local time.</div></div>
<div class="ttc" id="agroup__odp__time_html_ga67ec3be80e3d1b2b1294ae551f4def86"><div class="ttname"><a href="group__odp__time.html#ga67ec3be80e3d1b2b1294ae551f4def86">ODP_TIME_NULL</a></div><div class="ttdeci">#define ODP_TIME_NULL</div><div class="ttdoc">Zero time stamp.</div></div>
<div class="ttc" id="agroup__odp__time_html_gabad65a44847cb6d46c2ae9cc96a80a4c"><div class="ttname"><a href="group__odp__time.html#gabad65a44847cb6d46c2ae9cc96a80a4c">ODP_TIME_MSEC_IN_NS</a></div><div class="ttdeci">#define ODP_TIME_MSEC_IN_NS</div><div class="ttdoc">A millisecond in nanoseconds.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2time__types_8h_source.html#l00028">api/spec/time_types.h:28</a></div></div>
<div class="ttc" id="agroup__odp__time_html_gac19fb35909fb3f7f3c7fadf0e5e6e0e4"><div class="ttname"><a href="group__odp__time.html#gac19fb35909fb3f7f3c7fadf0e5e6e0e4">odp_time_cmp</a></div><div class="ttdeci">int odp_time_cmp(odp_time_t t2, odp_time_t t1)</div><div class="ttdoc">Compare two times.</div></div>
<div class="ttc" id="aodp__api_8h_html"><div class="ttname"><a href="odp__api_8h.html">odp_api.h</a></div><div class="ttdoc">The OpenDataPlane API.</div></div>
<div class="ttc" id="astruct__odp__abi__event__t_html"><div class="ttname"><a href="struct__odp__abi__event__t.html">_odp_abi_event_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2event__types_8h_source.html#l00016">api/abi-default/event_types.h:16</a></div></div>
<div class="ttc" id="astruct__odp__abi__packet__t_html"><div class="ttname"><a href="struct__odp__abi__packet__t.html">_odp_abi_packet_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__types_8h_source.html#l00016">api/abi-default/packet_types.h:16</a></div></div>
<div class="ttc" id="astruct__odp__abi__pktio__t_html"><div class="ttname"><a href="struct__odp__abi__pktio__t.html">_odp_abi_pktio_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__io__types_8h_source.html#l00022">api/abi-default/packet_io_types.h:22</a></div></div>
<div class="ttc" id="astruct__odp__abi__pool__t_html"><div class="ttname"><a href="struct__odp__abi__pool__t.html">_odp_abi_pool_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2pool__types_8h_source.html#l00014">api/abi-default/pool_types.h:14</a></div></div>
<div class="ttc" id="astruct__odp__abi__queue__t_html"><div class="ttname"><a href="struct__odp__abi__queue__t.html">_odp_abi_queue_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2queue__types_8h_source.html#l00014">api/abi-default/queue_types.h:14</a></div></div>
<div class="ttc" id="astruct__odp__abi__shm__t_html"><div class="ttname"><a href="struct__odp__abi__shm__t.html">_odp_abi_shm_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2shared__memory_8h_source.html#l00013">api/abi-default/shared_memory.h:13</a></div></div>
<div class="ttc" id="astructodp__atomic__u32__s_html"><div class="ttname"><a href="structodp__atomic__u32__s.html">odp_atomic_u32_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2atomic_8h_source.html#l00026">api/abi-default/atomic.h:26</a></div></div>
<div class="ttc" id="astructodp__barrier__s_html"><div class="ttname"><a href="structodp__barrier__s.html">odp_barrier_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2barrier_8h_source.html#l00025">api/abi-default/barrier.h:25</a></div></div>
<div class="ttc" id="astructodp__cpumask__s_html"><div class="ttname"><a href="structodp__cpumask__s.html">odp_cpumask_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2cpumask_8h_source.html#l00038">api/abi-default/cpumask.h:38</a></div></div>
<div class="ttc" id="astructodp__init__t_html"><div class="ttname"><a href="structodp__init__t.html">odp_init_t</a></div><div class="ttdoc">Global initialization parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2init_8h_source.html#l00161">api/spec/init.h:161</a></div></div>
<div class="ttc" id="astructodp__init__t_html_a7d368c740146170ebeb1651ce049919e"><div class="ttname"><a href="structodp__init__t.html#a7d368c740146170ebeb1651ce049919e">odp_init_t::mem_model</a></div><div class="ttdeci">odp_mem_model_t mem_model</div><div class="ttdoc">Application memory model.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2init_8h_source.html#l00218">api/spec/init.h:218</a></div></div>
<div class="ttc" id="astructodp__pktio__config__t_html"><div class="ttname"><a href="structodp__pktio__config__t.html">odp_pktio_config_t</a></div><div class="ttdoc">Packet IO configuration options.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00594">api/spec/packet_io_types.h:594</a></div></div>
<div class="ttc" id="astructodp__pktio__config__t_html_ab11707ba4258066a50f0e029fcc641f5"><div class="ttname"><a href="structodp__pktio__config__t.html#ab11707ba4258066a50f0e029fcc641f5">odp_pktio_config_t::parser</a></div><div class="ttdeci">odp_pktio_parser_config_t parser</div><div class="ttdoc">Packet input parser configuration.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00606">api/spec/packet_io_types.h:606</a></div></div>
<div class="ttc" id="astructodp__pktio__param__t_html"><div class="ttname"><a href="structodp__pktio__param__t.html">odp_pktio_param_t</a></div><div class="ttdoc">Packet IO parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00353">api/spec/packet_io_types.h:353</a></div></div>
<div class="ttc" id="astructodp__pktio__param__t_html_a819cf5e2ef7df43a729cad159c022f4d"><div class="ttname"><a href="structodp__pktio__param__t.html#a819cf5e2ef7df43a729cad159c022f4d">odp_pktio_param_t::in_mode</a></div><div class="ttdeci">odp_pktin_mode_t in_mode</div><div class="ttdoc">Packet input mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00357">api/spec/packet_io_types.h:357</a></div></div>
<div class="ttc" id="astructodp__pktio__parser__config__t_html_aff1f0d93e1f3cc93006aa613287378a2"><div class="ttname"><a href="structodp__pktio__parser__config__t.html#aff1f0d93e1f3cc93006aa613287378a2">odp_pktio_parser_config_t::layer</a></div><div class="ttdeci">odp_proto_layer_t layer</div><div class="ttdoc">Protocol parsing level in packet input.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00570">api/spec/packet_io_types.h:570</a></div></div>
<div class="ttc" id="astructodp__pktout__queue__s_html"><div class="ttname"><a href="structodp__pktout__queue__s.html">odp_pktout_queue_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__io__types_8h_source.html#l00063">api/abi-default/packet_io_types.h:63</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html"><div class="ttname"><a href="structodp__pool__param__t.html">odp_pool_param_t</a></div><div class="ttdoc">Pool parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00466">api/spec/pool_types.h:466</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_a3598b3a2496629cd45010c1c5e876250"><div class="ttname"><a href="structodp__pool__param__t.html#a3598b3a2496629cd45010c1c5e876250">odp_pool_param_t::num</a></div><div class="ttdeci">uint32_t num</div><div class="ttdoc">Number of buffers in the pool.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00473">api/spec/pool_types.h:473</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_a7f9ca49dc21d48da0d80860c03faec1d"><div class="ttname"><a href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">odp_pool_param_t::pkt</a></div><div class="ttdeci">struct odp_pool_param_t::@138 pkt</div><div class="ttdoc">Parameters for packet pools.</div></div>
<div class="ttc" id="astructodp__pool__param__t_html_aac72ae142dd9736a287ce63d78b71c87"><div class="ttname"><a href="structodp__pool__param__t.html#aac72ae142dd9736a287ce63d78b71c87">odp_pool_param_t::type</a></div><div class="ttdeci">odp_pool_type_t type</div><div class="ttdoc">Pool type.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00468">api/spec/pool_types.h:468</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_ac1ccfa50466f4afa9a9ab72f0bd315bf"><div class="ttname"><a href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">odp_pool_param_t::len</a></div><div class="ttdeci">uint32_t len</div><div class="ttdoc">Minimum length of 'num' packets.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00540">api/spec/pool_types.h:540</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_ad400db5955445ee3d1fbb36df456e7f1"><div class="ttname"><a href="structodp__pool__param__t.html#ad400db5955445ee3d1fbb36df456e7f1">odp_pool_param_t::seg_len</a></div><div class="ttdeci">uint32_t seg_len</div><div class="ttdoc">Minimum number of packet data bytes that can be stored in the first segment of a newly allocated pack...</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00566">api/spec/pool_types.h:566</a></div></div>
<div class="ttc" id="astructodp__time__s_html"><div class="ttname"><a href="structodp__time__s.html">odp_time_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2time__types_8h_source.html#l00018">api/abi-default/time_types.h:18</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
