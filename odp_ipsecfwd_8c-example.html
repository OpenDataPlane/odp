<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>API Reference Manual: odp_ipsecfwd.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="odpdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ODP-Logo-HQ.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">API Reference Manual
   &#160;<span id="projectnumber">1.49.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('odp_ipsecfwd_8c-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">odp_ipsecfwd.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Simple IPsec performance tester application which forwards and processes plain and IPsec packets.</p>
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2022-2023 Nokia</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef _GNU_SOURCE</span></div>
<div class="line"><span class="preprocessor">#define _GNU_SOURCE</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="odp__api_8h.html">odp_api.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;odp/helper/odph_api.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;libconfig.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define PROG_NAME &quot;odp_ipsecfwd&quot;</span></div>
<div class="line"><span class="preprocessor">#define SHORT_PROG_NAME &quot;ipsfwd&quot;</span></div>
<div class="line"><span class="preprocessor">#define DELIMITER &quot;,&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_IFS 2U</span></div>
<div class="line"><span class="preprocessor">#define MAX_SAS 4000U</span></div>
<div class="line"><span class="preprocessor">#define MAX_FWDS 64U</span></div>
<div class="line"><span class="preprocessor">#define MAX_SPIS (UINT16_MAX + 1U)</span></div>
<div class="line"><span class="preprocessor">#define MAX_WORKERS (ODP_THREAD_COUNT_MAX - 1)</span></div>
<div class="line"><span class="preprocessor">#define MAX_QUEUES 64U</span></div>
<div class="line"><span class="preprocessor">#define MAX_SA_QUEUES 1024U</span></div>
<div class="line"><span class="preprocessor">#define PKT_SIZE 1024U</span></div>
<div class="line"><span class="preprocessor">#define PKT_CNT 32768U</span></div>
<div class="line"><span class="preprocessor">#define MAX_BURST 32U</span></div>
<div class="line"><span class="preprocessor">#define ORDERED 0U</span></div>
<div class="line"><span class="preprocessor">#define IP_ADDR_LEN 32U</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define ALG_ENTRY(_alg_name, _type) \</span></div>
<div class="line"><span class="preprocessor">    { \</span></div>
<div class="line"><span class="preprocessor">        .idx = (_alg_name), \</span></div>
<div class="line"><span class="preprocessor">        .type = (_type), \</span></div>
<div class="line"><span class="preprocessor">        .name = #_alg_name \</span></div>
<div class="line"><span class="preprocessor">    }</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> {</div>
<div class="line">    CIPHER_TYPE,</div>
<div class="line">    COMB_CIPHER_TYPE,</div>
<div class="line">    AUTH_TYPE,</div>
<div class="line">    COMB_AUTH_TYPE</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">    PRS_OK,</div>
<div class="line">    PRS_NOK,</div>
<div class="line">    PRS_TERM</div>
<div class="line">} parse_result_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> {</div>
<div class="line">    DIR_IN = 0,</div>
<div class="line">    DIR_OUT</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>pktio_s pktio_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>pktio_s {</div>
<div class="line">    <span class="keyword">union </span>{</div>
<div class="line">        <a name="_a0"></a><a class="code" href="structodp__pktout__queue__s.html">odp_pktout_queue_t</a> out_dir_qs[MAX_QUEUES];</div>
<div class="line">        <a name="_a1"></a><a class="code" href="struct__odp__abi__queue__t.html">odp_queue_t</a> out_ev_qs[MAX_QUEUES];</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a name="_a2"></a><a class="code" href="structodp__pktin__queue__s.html">odp_pktin_queue_t</a> in_dir_qs[MAX_QUEUES];</div>
<div class="line">    odph_ethaddr_t src_mac;</div>
<div class="line">    <span class="keywordtype">char</span> *name;</div>
<div class="line">    <a name="_a3"></a><a class="code" href="struct__odp__abi__pktio__t.html">odp_pktio_t</a> handle;</div>
<div class="line">    uint32_t (*send_fn)(<span class="keyword">const</span> pktio_t *pktio, uint8_t index, <a name="_a4"></a><a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num);</div>
<div class="line">    uint32_t num_tx_qs;</div>
<div class="line">    uint8_t idx;</div>
<div class="line">} pktio_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint32_t prefix;</div>
<div class="line">    uint32_t mask;</div>
<div class="line">    odph_ethaddr_t dst_mac;</div>
<div class="line">    <span class="keyword">const</span> pktio_t *pktio;</div>
<div class="line">} fwd_entry_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    fwd_entry_t entries[MAX_FWDS];</div>
<div class="line">    uint32_t num;</div>
<div class="line">} lookup_table_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint64_t ipsec_in_pkts;</div>
<div class="line">    uint64_t ipsec_out_pkts;</div>
<div class="line">    uint64_t ipsec_in_errs;</div>
<div class="line">    uint64_t ipsec_out_errs;</div>
<div class="line">    uint64_t status_errs;</div>
<div class="line">    uint64_t fwd_pkts;</div>
<div class="line">    uint64_t discards;</div>
<div class="line">} stats_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>prog_config_s prog_config_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a name="a5"></a><a class="code" href="group__odp__compiler__optim.html#ga205a8257879c02657e7c39ee7ad5e40a">ODP_ALIGNED_CACHE</a> {</div>
<div class="line">    stats_t stats;</div>
<div class="line">    prog_config_t *prog_config;</div>
<div class="line">    <span class="keywordtype">int</span> thr_idx;</div>
<div class="line">    uint8_t pktio;</div>
<div class="line">} thread_config_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <a name="_a6"></a><a class="code" href="structodp__ipsec__sa__param__t.html">odp_ipsec_sa_param_t</a> sa_param;</div>
<div class="line">    <span class="keywordtype">char</span> cipher_key[65U];</div>
<div class="line">    <span class="keywordtype">char</span> cipher_key_extra[5U];</div>
<div class="line">    <span class="keywordtype">char</span> auth_key[65U];</div>
<div class="line">    <span class="keywordtype">char</span> auth_key_extra[5U];</div>
<div class="line">    <a class="code" href="group__odp__compiler__optim.html#ga2b6519f1042fc82dd7361061f27a6fe1">odp_u32be_t</a> lkp_dst_ip;</div>
<div class="line">    <a class="code" href="group__odp__compiler__optim.html#ga2b6519f1042fc82dd7361061f27a6fe1">odp_u32be_t</a> src_ip;</div>
<div class="line">    <a class="code" href="group__odp__compiler__optim.html#ga2b6519f1042fc82dd7361061f27a6fe1">odp_u32be_t</a> dst_ip;</div>
<div class="line">} sa_config_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> uint32_t (*rx_fn_t)(thread_config_t *config, <a name="_a7"></a><a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> evs[], <span class="keywordtype">int</span> num);</div>
<div class="line"><span class="keyword">typedef</span> void (*ipsec_fn_t)(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl, stats_t *stats);</div>
<div class="line"><span class="keyword">typedef</span> void (*drain_fn_t)(prog_config_t *config);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    rx_fn_t rx;</div>
<div class="line">    ipsec_fn_t proc;</div>
<div class="line">    ipsec_fn_t compl;</div>
<div class="line">    drain_fn_t drain;</div>
<div class="line">} ops_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>prog_config_s {</div>
<div class="line">    odph_thread_t thread_tbl[MAX_WORKERS];</div>
<div class="line">    thread_config_t thread_config[MAX_WORKERS];</div>
<div class="line">    <a name="_a8"></a><a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> sas[MAX_SAS];</div>
<div class="line">    <a class="code" href="struct__odp__abi__queue__t.html">odp_queue_t</a> sa_qs[MAX_SA_QUEUES];</div>
<div class="line">    pktio_t pktios[MAX_IFS];</div>
<div class="line">    lookup_table_t fwd_tbl;</div>
<div class="line">    <a name="_a9"></a><a class="code" href="structodp__atomic__u32__s.html">odp_atomic_u32_t</a> is_running;</div>
<div class="line">    sa_config_t default_cfg;</div>
<div class="line">    ops_t ops;</div>
<div class="line">    <span class="keywordtype">char</span> *conf_file;</div>
<div class="line">    <a class="code" href="group__odp__initialization.html#ga8d362bd3c7c87ab5892ca63b15c375c0">odp_instance_t</a> <a name="a10"></a><a class="code" href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a>;</div>
<div class="line">    <a class="code" href="struct__odp__abi__queue__t.html">odp_queue_t</a> compl_q;</div>
<div class="line">    <a name="_a11"></a><a class="code" href="struct__odp__abi__pool__t.html">odp_pool_t</a> pktio_pool;</div>
<div class="line">    <a name="_a12"></a><a class="code" href="structodp__barrier__s.html">odp_barrier_t</a> init_barrier;</div>
<div class="line">    <a class="code" href="structodp__barrier__s.html">odp_barrier_t</a> term_barrier;</div>
<div class="line">    uint32_t num_input_qs;</div>
<div class="line">    uint32_t num_sa_qs;</div>
<div class="line">    uint32_t num_output_qs;</div>
<div class="line">    uint32_t num_pkts;</div>
<div class="line">    uint32_t pkt_len;</div>
<div class="line">    uint32_t num_ifs;</div>
<div class="line">    uint32_t num_sas;</div>
<div class="line">    <span class="keywordtype">int</span> num_thrs;</div>
<div class="line">    <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> is_dir_rx;</div>
<div class="line">    <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> is_hashed_tx;</div>
<div class="line">    uint8_t mode;</div>
<div class="line">} prog_config_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name;</div>
<div class="line">    <span class="keywordtype">int</span> idx;</div>
<div class="line">    <span class="keywordtype">int</span> type;</div>
<div class="line">} exposed_alg_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[MAX_BURST];</div>
<div class="line">    <span class="keyword">const</span> pktio_t *pktio;</div>
<div class="line">    uint32_t num;</div>
<div class="line">} pkt_vec_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    pkt_vec_t vecs[MAX_QUEUES];</div>
<div class="line">    uint8_t num_qs;</div>
<div class="line">} pkt_out_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    pkt_out_t ifs[MAX_IFS];</div>
<div class="line">    <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> is_hashed_tx;</div>
<div class="line">    uint8_t q_idx;</div>
<div class="line">} pkt_ifs_t;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> exposed_alg_t exposed_algs[] = {</div>
<div class="line">    ALG_ENTRY(<a name="a13"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0ac8c68b6ba7437f58342798b8b9321d49">ODP_CIPHER_ALG_NULL</a>, CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a14"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0aa8290d9fd54bd7a03018972146b11b20">ODP_CIPHER_ALG_DES</a>, CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a15"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a9ab3dbd31584c39a561b91d6ada2fe36">ODP_CIPHER_ALG_3DES_CBC</a>, CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a16"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a801dc573225189febece00273710ba79">ODP_CIPHER_ALG_AES_CBC</a>, CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a17"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a73b1017657dd9f6ba9884e6e61bc457a">ODP_CIPHER_ALG_AES_CTR</a>, CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a18"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a6614d21577549126b5dd2bd344adf5f4">ODP_CIPHER_ALG_AES_ECB</a>, CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a19"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a8aa3ec25d1e5b30bc778577e400573e4">ODP_CIPHER_ALG_AES_GCM</a>, COMB_CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a20"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a5f97b9e25676e663bd26af74aca86627">ODP_CIPHER_ALG_AES_CCM</a>, COMB_CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a21"></a><a class="code" href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a7be2e3156dac631c42e3721092055929">ODP_CIPHER_ALG_CHACHA20_POLY1305</a>, COMB_CIPHER_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a22"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a281e7b97f84df04651af9ac14fe98bba">ODP_AUTH_ALG_NULL</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a23"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a39a395de232a6dbdb078339ab5542716">ODP_AUTH_ALG_MD5_HMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a24"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a40e96c842f6ca3f8b9525abbb94b1c56">ODP_AUTH_ALG_SHA1_HMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a25"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a940ea0a0ecd398ed2302c5f3577ded14">ODP_AUTH_ALG_SHA224_HMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a26"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a471e06564c891f9705f2dd28480ccabe">ODP_AUTH_ALG_SHA256_HMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a27"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a0a41f178286956faefcdc8df92e0e2b7">ODP_AUTH_ALG_SHA384_HMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a28"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a400d59810b98620d0ffed0693a29107f">ODP_AUTH_ALG_SHA512_HMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a29"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982aaa2119d2578afa8def7ed3ae160394e8">ODP_AUTH_ALG_AES_GCM</a>, COMB_AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a30"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a954f1cc1eb2a7284beba842ad7a54982">ODP_AUTH_ALG_AES_GMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a31"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982ad5b8c5c3affbde282db4a33f1ece8d6a">ODP_AUTH_ALG_AES_CCM</a>, COMB_AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a32"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a15a53bfea20586ebcae401af08bc3d1b">ODP_AUTH_ALG_AES_CMAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a33"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982aa50251618a82066c56c43d978f07a459">ODP_AUTH_ALG_AES_XCBC_MAC</a>, AUTH_TYPE),</div>
<div class="line">    ALG_ENTRY(<a name="a34"></a><a class="code" href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a0b1a80997bf33e4621625ef998afa111">ODP_AUTH_ALG_CHACHA20_POLY1305</a>, COMB_AUTH_TYPE)</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* SPIs for in and out directions */</span></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *spi_to_sa_map[2U][MAX_SPIS];</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> ipsec_out_mark;</div>
<div class="line"><span class="keyword">static</span> __thread pkt_ifs_t ifs;</div>
<div class="line"><span class="keyword">static</span> prog_config_t *prog_conf;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> init_config(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    memset(config, 0, <span class="keyword">sizeof</span>(*config));</div>
<div class="line">    <a name="a35"></a><a class="code" href="group__odp__ipsec.html#ga7289488ac8fa8def94e90ba9de1a8e8d">odp_ipsec_sa_param_init</a>(&amp;config-&gt;default_cfg.sa_param);</div>
<div class="line">    config-&gt;compl_q = <a name="a36"></a><a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>;</div>
<div class="line">    config-&gt;pktio_pool = <a name="a37"></a><a class="code" href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a>;</div>
<div class="line">    config-&gt;num_input_qs = 1;</div>
<div class="line">    config-&gt;num_sa_qs = 1;</div>
<div class="line">    config-&gt;num_output_qs = 1;</div>
<div class="line">    config-&gt;num_thrs = 1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> terminate(<span class="keywordtype">int</span> signal <a name="a38"></a><a class="code" href="group__odp__compiler__optim.html#ga45a2684e38da3e71b300bc89de5d6b52">ODP_UNUSED</a>)</div>
<div class="line">{</div>
<div class="line">    <a name="a39"></a><a class="code" href="group__odp__atomic.html#gaa6d2d16a9ef9897b1442d77e41f7101e">odp_atomic_store_u32</a>(&amp;prog_conf-&gt;is_running, 0U);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_interfaces(prog_config_t *config, <span class="keyword">const</span> <span class="keywordtype">char</span> *optarg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> *tmp_str = strdup(optarg), *tmp;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (tmp_str == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    tmp = strtok(tmp_str, DELIMITER);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (tmp &amp;&amp; config-&gt;num_ifs &lt; MAX_IFS) {</div>
<div class="line">        config-&gt;pktios[config-&gt;num_ifs].name = strdup(tmp);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;pktios[config-&gt;num_ifs].name != NULL)</div>
<div class="line">            ++config-&gt;num_ifs;</div>
<div class="line"> </div>
<div class="line">        tmp = strtok(NULL, DELIMITER);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    free(tmp_str);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_supported_algos(<span class="keyword">const</span> <a name="_a40"></a><a class="code" href="structodp__ipsec__capability__t.html">odp_ipsec_capability_t</a> *ipsec_capa)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> c_cnt, a_cnt;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">size_t</span> len = ODPH_ARRAY_SIZE(exposed_algs);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;                          Cipher algorithms:\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0U; i &lt; len; ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> ((exposed_algs[i].type == CIPHER_TYPE ||</div>
<div class="line">             exposed_algs[i].type == COMB_CIPHER_TYPE) &amp;&amp;</div>
<div class="line">            (ipsec_capa-&gt;<a name="a41"></a><a class="code" href="structodp__ipsec__capability__t.html#a279c5ccb86363d56b07dd96299148510">ciphers</a>.<a name="a42"></a><a class="code" href="unionodp__crypto__cipher__algos__t.html#ab307f8bf680405191f6f59ccae66dfd3">all_bits</a> &amp; (1 &lt;&lt; exposed_algs[i].idx)) &gt; 0U) {</div>
<div class="line">            c_cnt = <a name="a43"></a><a class="code" href="group__odp__ipsec.html#gad094aba428809ca781f5748546c7ace1">odp_ipsec_cipher_capability</a>(exposed_algs[i].idx, NULL, 0);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (c_cnt &lt; 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;                              %d: %s&quot;</span>,</div>
<div class="line">                   exposed_algs[i].idx, exposed_algs[i].name);</div>
<div class="line">            printf(exposed_algs[i].type == COMB_CIPHER_TYPE ? <span class="stringliteral">&quot; (combined)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a name="_a44"></a><a class="code" href="structodp__ipsec__cipher__capability__t.html">odp_ipsec_cipher_capability_t</a> capa[c_cnt];</div>
<div class="line"> </div>
<div class="line">            (void)<a class="code" href="group__odp__ipsec.html#gad094aba428809ca781f5748546c7ace1">odp_ipsec_cipher_capability</a>(exposed_algs[i].idx, capa, c_cnt);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; c_cnt; ++j)</div>
<div class="line">                printf(j == 0 ? <span class="stringliteral">&quot; (key lengths: %u&quot;</span> : <span class="stringliteral">&quot;, %u&quot;</span>, capa[j].key_len);</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;                          Authentication algorithms:\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0U; i &lt; len; ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> ((exposed_algs[i].type == AUTH_TYPE ||</div>
<div class="line">             exposed_algs[i].type == COMB_AUTH_TYPE) &amp;&amp;</div>
<div class="line">            (ipsec_capa-&gt;<a name="a45"></a><a class="code" href="structodp__ipsec__capability__t.html#abf54129f80528108f5fdc22d68a53808">auths</a>.<a name="a46"></a><a class="code" href="unionodp__crypto__auth__algos__t.html#a299c8a6de89108f62c532274cf6bbaef">all_bits</a> &amp; (1 &lt;&lt; exposed_algs[i].idx)) &gt; 0U) {</div>
<div class="line">            a_cnt = <a name="a47"></a><a class="code" href="group__odp__ipsec.html#ga12a8fa1641f442de7c4b69dea8d0e774">odp_ipsec_auth_capability</a>(exposed_algs[i].idx, NULL, 0);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (a_cnt &lt; 0)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;                              %d: %s&quot;</span>,</div>
<div class="line">                   exposed_algs[i].idx, exposed_algs[i].name);</div>
<div class="line">            printf(exposed_algs[i].type == COMB_AUTH_TYPE ? <span class="stringliteral">&quot; (combined)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">            <a name="_a48"></a><a class="code" href="structodp__ipsec__auth__capability__t.html">odp_ipsec_auth_capability_t</a> capa[a_cnt];</div>
<div class="line"> </div>
<div class="line">            (void)<a class="code" href="group__odp__ipsec.html#ga12a8fa1641f442de7c4b69dea8d0e774">odp_ipsec_auth_capability</a>(exposed_algs[i].idx, capa, a_cnt);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; a_cnt; ++j)</div>
<div class="line">                printf(j == 0 ? <span class="stringliteral">&quot; (key/icv lengths: %u/%u&quot;</span> : <span class="stringliteral">&quot;, %u/%u&quot;</span>,</div>
<div class="line">                       capa[j].key_len, capa[j].icv_len);</div>
<div class="line"> </div>
<div class="line">            printf(<span class="stringliteral">&quot;)\n&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_usage(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a name="_a49"></a><a class="code" href="structodp__pool__capability__t.html">odp_pool_capability_t</a> pool_capa;</div>
<div class="line">    <a class="code" href="structodp__ipsec__capability__t.html">odp_ipsec_capability_t</a> ipsec_capa;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a50"></a><a class="code" href="group__odp__pool.html#ga2c6f42e9611904eac84872bf8f913b75">odp_pool_capability</a>(&amp;pool_capa) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error querying pool capabilities\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a51"></a><a class="code" href="group__odp__ipsec.html#ga2cf54f017249dde280072e48251d2d31">odp_ipsec_capability</a>(&amp;ipsec_capa) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error querying IPsec capabilities\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Simple IPsec performance tester. Forward and process plain and IPsec packets.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Usage: %s OPTIONS\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  E.g. %s -i ens9f1 -C /etc/odp/ipsecfwd.conf\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  With ipsecfwd.conf containing, for example:\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;      default: {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          dir = 1\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          proto = 0\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          mode = 0\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          crypto: {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              cipher_alg = 4\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              cipher_key = \&quot;jWnZr4t7w!zwC*F-\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              auth_alg = 2\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              auth_key = \&quot;n2r5u7x!A%%D*\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              icv_len = 12\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          };\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;      };\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;      sa: (\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              spi = 1337\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              outbound: {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                  tunnel: {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      src_addr = \&quot;192.168.1.10\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      dst_addr = \&quot;192.168.1.16\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                  };\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              };\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          },\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              spi = 1338\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              outbound: {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                  tunnel: {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      src_addr = \&quot;192.168.3.110\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      dst_addr = \&quot;192.168.3.116\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                  };\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              };\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          }\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;      );\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;      fwd: (\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              prefix: \&quot;192.168.1.0/24\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              if: \&quot;ens9f1\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              dst_mac: \&quot;00:00:05:00:07:00\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          },\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          {\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              prefix: \&quot;192.1.0.0/16\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              if: \&quot;ens9f0\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;              dst_mac: \&quot;00:00:05:00:08:00\&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;          }\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;      );\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Mandatory OPTIONS:\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -i, --interfaces    Ethernet interfaces for packet I/O, comma-separated,\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      no spaces.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -C, --conf          Configuration file. &#39;libconfig&#39; syntax is expected.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      SA configuration supports default fallback, i.e.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      individual SA configuration blocks may omit some\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      parameters and instead set these once in default block\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      which then are used to fill missing parameters. The only\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      required argument for an SA is the &#39;spi&#39; parameter.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      Individual SA parameter blocks are expected to be in\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      &#39;sa&#39;-named list. Parameter naming follows API\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      specification, see &#39;odp_ipsec_sa_param_t&#39; for parameter\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      names and hierarchy. Traffic is mapped to SAs based on UDP\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      port: the port is used as the SPI. For forwarding entries,\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      individual parameter blocks are similarly expected to be\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      in &#39;fwd&#39;-named list. With forwarding entries, every\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      parameter is always required and interfaces present in\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      forwarding entries should be one of the interfaces passed\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      with &#39;--interfaces&#39; option. The entries are looked up\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      in the order they are in the list. See example above for\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      potential SA and forwarding configuration.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      Supported cipher and authentication algorithms for SAs:\n&quot;</span>,</div>
<div class="line">           PROG_NAME, PROG_NAME);</div>
<div class="line">    print_supported_algos(&amp;ipsec_capa);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Optional OPTIONS:\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -n, --num_pkts      Number of packet buffers allocated for packet I/O pool.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      %u by default.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -l, --pkt_len       Maximum size of packet buffers in packet I/O pool. %u by\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      default.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -c, --count         Worker thread count. 1 by default.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -m, --mode          Queueing mode.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                          0: ordered (default)\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                          1: parallel\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -I, --num_input_qs  Input queue count. 1 by default.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -S, --num_sa_qs     SA queue count. 1 by default.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -O, --num_output_qs Output queue count. 1 by default.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -d, --direct_rx     Use direct RX. Interfaces will be polled by workers\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      directly. &#39;--mode&#39;, &#39;--num_input_qs&#39; and &#39;--num_output_qs&#39;\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      options are ignored, input and output queue counts will\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;                      match worker count.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;  -h, --help          This help.\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;\n&quot;</span>, pool_capa.<a name="a52"></a><a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a name="a53"></a><a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a> &gt; 0U ? ODPH_MIN(pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a>, PKT_CNT) :</div>
<div class="line">           PKT_CNT, pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a name="a54"></a><a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a> &gt; 0U ? ODPH_MIN(pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a>, PKT_SIZE) :</div>
<div class="line">           PKT_SIZE);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *get_in_sa(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt)</div>
<div class="line">{</div>
<div class="line">    odph_esphdr_t esp;</div>
<div class="line">    uint32_t spi;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a55"></a><a class="code" href="group__odp__packet.html#gab6a8f73fcc0f585c4a4443f9f449b69e">odp_packet_has_ipsec</a>(pkt))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a56"></a><a class="code" href="group__odp__packet.html#gadf9179122029a9dd7a000e050f68b357">odp_packet_copy_to_mem</a>(pkt, <a name="a57"></a><a class="code" href="group__odp__packet.html#ga3d1e523b200b887c88d9506a804f0e38">odp_packet_l4_offset</a>(pkt), ODPH_ESPHDR_LEN, &amp;esp) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    spi = <a name="a58"></a><a class="code" href="group__odp__compiler__optim.html#gae9b272def3f1d5b9979f600183ea005a">odp_be_to_cpu_32</a>(esp.spi);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> spi &lt;= UINT16_MAX ? spi_to_sa_map[DIR_IN][spi] : NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> process_ipsec_in_enq(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keyword">const</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> sas[], <span class="keywordtype">int</span> num)</div>
<div class="line">{</div>
<div class="line">    <a name="_a59"></a><a class="code" href="structodp__ipsec__in__param__t.html">odp_ipsec_in_param_t</a> param;</div>
<div class="line">    <span class="keywordtype">int</span> left, sent = 0, ret;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;param, 0, <span class="keyword">sizeof</span>(param));</div>
<div class="line">    <span class="comment">/* IPsec in/out need to be identified somehow, so use user_ptr for this. */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i)</div>
<div class="line">        <a name="a60"></a><a class="code" href="group__odp__packet.html#gabba756536217212e5570b73db24d00c8">odp_packet_user_ptr_set</a>(pkts[i], NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (sent &lt; num) {</div>
<div class="line">        left = num - sent;</div>
<div class="line">        param.<a name="a61"></a><a class="code" href="structodp__ipsec__in__param__t.html#a7de98bd0265da777b51d085b6ef6c6cc">num_sa</a> = left;</div>
<div class="line">        param.<a name="a62"></a><a class="code" href="structodp__ipsec__in__param__t.html#ad89e2bbaa4148ee47dd1856874b9bb76">sa</a> = &amp;sas[sent];</div>
<div class="line">        ret = <a name="a63"></a><a class="code" href="group__odp__ipsec.html#ga02a3a799f7295c6ada8a6f50b71c79de">odp_ipsec_in_enq</a>(&amp;pkts[sent], left, &amp;param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a64"></a><a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(ret &lt;= 0))</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        sent += ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> sent;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *get_out_sa(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt)</div>
<div class="line">{</div>
<div class="line">    odph_udphdr_t udp;</div>
<div class="line">    uint16_t dst_port;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a name="a65"></a><a class="code" href="group__odp__packet.html#gaebb6c19d5fc2ff3a722947b74e0d38a3">odp_packet_has_udp</a>(pkt))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet.html#gadf9179122029a9dd7a000e050f68b357">odp_packet_copy_to_mem</a>(pkt, <a class="code" href="group__odp__packet.html#ga3d1e523b200b887c88d9506a804f0e38">odp_packet_l4_offset</a>(pkt), ODPH_UDPHDR_LEN, &amp;udp) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    dst_port = <a name="a66"></a><a class="code" href="group__odp__compiler__optim.html#ga7d5bfcf18bdad933a1c83ec581874534">odp_be_to_cpu_16</a>(udp.dst_port);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> dst_port ? spi_to_sa_map[DIR_OUT][dst_port] : NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> process_ipsec_out_enq(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keyword">const</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> sas[], <span class="keywordtype">int</span> num)</div>
<div class="line">{</div>
<div class="line">    <a name="_a67"></a><a class="code" href="structodp__ipsec__out__param__t.html">odp_ipsec_out_param_t</a> param;</div>
<div class="line">    <span class="keywordtype">int</span> left, sent = 0, ret;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;param, 0, <span class="keyword">sizeof</span>(param));</div>
<div class="line">    <span class="comment">/* IPsec in/out need to be identified somehow, so use user_ptr for this. */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i)</div>
<div class="line">        <a class="code" href="group__odp__packet.html#gabba756536217212e5570b73db24d00c8">odp_packet_user_ptr_set</a>(pkts[i], &amp;ipsec_out_mark);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (sent &lt; num) {</div>
<div class="line">        left = num - sent;</div>
<div class="line">        param.<a name="a68"></a><a class="code" href="structodp__ipsec__out__param__t.html#aa034994bdaee89c31815872f19f8c0e7">num_sa</a> = left;</div>
<div class="line">        param.<a name="a69"></a><a class="code" href="structodp__ipsec__out__param__t.html#a5a04803b40fb0d917d10f57ef7284c48">sa</a> = &amp;sas[sent];</div>
<div class="line">        ret = <a name="a70"></a><a class="code" href="group__odp__ipsec.html#gab431efd3643880dee137c5e6d8ec28a9">odp_ipsec_out_enq</a>(&amp;pkts[sent], left, &amp;param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(ret &lt;= 0))</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        sent += ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> sent;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> fwd_entry_t *get_fwd_entry(lookup_table_t *table, uint32_t ip)</div>
<div class="line">{</div>
<div class="line">    fwd_entry_t *entry;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; table-&gt;num; ++i) {</div>
<div class="line">        entry = &amp;table-&gt;entries[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((ip &amp; entry-&gt;mask) == entry-&gt;prefix)</div>
<div class="line">            <span class="keywordflow">return</span> entry;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">const</span> pktio_t *lookup_and_apply(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, lookup_table_t *fwd_tbl,</div>
<div class="line">                          uint8_t *q_idx)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> uint32_t l3_off = <a name="a71"></a><a class="code" href="group__odp__packet.html#ga9eb7cff2a7f32d07bcf919d7286509b1">odp_packet_l3_offset</a>(pkt);</div>
<div class="line">    odph_ipv4hdr_t ipv4;</div>
<div class="line">    uint32_t dst_ip, src_ip;</div>
<div class="line">    <span class="keyword">const</span> fwd_entry_t *fwd;</div>
<div class="line">    odph_ethhdr_t eth;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__packet.html#gadf9179122029a9dd7a000e050f68b357">odp_packet_copy_to_mem</a>(pkt, l3_off, ODPH_IPV4HDR_LEN, &amp;ipv4) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    dst_ip = <a class="code" href="group__odp__compiler__optim.html#gae9b272def3f1d5b9979f600183ea005a">odp_be_to_cpu_32</a>(ipv4.dst_addr);</div>
<div class="line">    fwd = get_fwd_entry(fwd_tbl, dst_ip);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (fwd == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (l3_off != ODPH_ETHHDR_LEN) {</div>
<div class="line">        <span class="keywordflow">if</span> (l3_off &gt; ODPH_ETHHDR_LEN) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a72"></a><a class="code" href="group__odp__packet.html#ga1460efe82a6129a52b8b48756fce9d5c">odp_packet_pull_head</a>(pkt, l3_off - ODPH_ETHHDR_LEN) == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> NULL;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a73"></a><a class="code" href="group__odp__packet.html#ga2ed856750508efaae13d6be7aaa93695">odp_packet_push_head</a>(pkt, ODPH_ETHHDR_LEN - l3_off) == NULL)</div>
<div class="line">                <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    eth.dst = fwd-&gt;dst_mac;</div>
<div class="line">    eth.src = fwd-&gt;pktio-&gt;src_mac;</div>
<div class="line">    eth.type = <a name="a74"></a><a class="code" href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a>(ODPH_ETHTYPE_IPV4);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a75"></a><a class="code" href="group__odp__packet.html#gab67164b42ca75ae96615af7cebbfc414">odp_packet_copy_from_mem</a>(pkt, 0U, ODPH_ETHHDR_LEN, &amp;eth) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (q_idx != NULL) {</div>
<div class="line">        src_ip = <a class="code" href="group__odp__compiler__optim.html#gae9b272def3f1d5b9979f600183ea005a">odp_be_to_cpu_32</a>(ipv4.src_addr);</div>
<div class="line">        *q_idx = (src_ip ^ dst_ip) % fwd-&gt;pktio-&gt;num_tx_qs;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> fwd-&gt;pktio;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> uint32_t forward_packets(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt;</div>
<div class="line">    <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> is_hashed_tx = ifs.is_hashed_tx;</div>
<div class="line">    uint8_t q_idx = is_hashed_tx ? 0U : ifs.q_idx, qs_done;</div>
<div class="line">    uint8_t *q_idx_ptr = is_hashed_tx ? &amp;q_idx : NULL;</div>
<div class="line">    <span class="keyword">const</span> pktio_t *pktio;</div>
<div class="line">    pkt_out_t *out;</div>
<div class="line">    pkt_vec_t *vec;</div>
<div class="line">    uint32_t num_procd = 0U, ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line">        pkt = pkts[i];</div>
<div class="line">        pktio = lookup_and_apply(pkt, fwd_tbl, q_idx_ptr);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pktio == NULL) {</div>
<div class="line">            <a name="a76"></a><a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        out = &amp;ifs.ifs[pktio-&gt;idx];</div>
<div class="line">        vec = &amp;out-&gt;vecs[q_idx];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (vec-&gt;num == 0U)</div>
<div class="line">            out-&gt;num_qs++;</div>
<div class="line"> </div>
<div class="line">        vec-&gt;pkts[vec-&gt;num++] = pkt;</div>
<div class="line">        vec-&gt;pktio = pktio;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; MAX_IFS; ++i) {</div>
<div class="line">        qs_done = 0U;</div>
<div class="line">        out = &amp;ifs.ifs[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (uint32_t j = 0U; j &lt; MAX_QUEUES &amp;&amp; qs_done &lt; out-&gt;num_qs; ++j) {</div>
<div class="line">            <span class="keywordflow">if</span> (out-&gt;vecs[j].num == 0U)</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">            vec = &amp;out-&gt;vecs[j];</div>
<div class="line">            pktio = vec-&gt;pktio;</div>
<div class="line">            ret = pktio-&gt;send_fn(pktio, j, vec-&gt;pkts, vec-&gt;num);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(ret &lt; vec-&gt;num))</div>
<div class="line">                <a name="a77"></a><a class="code" href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a>(&amp;vec-&gt;pkts[ret], vec-&gt;num - ret);</div>
<div class="line"> </div>
<div class="line">            ++qs_done;</div>
<div class="line">            vec-&gt;num = 0U;</div>
<div class="line">            num_procd += ret;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        out-&gt;num_qs = 0U;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> num_procd;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> process_packets_out_enq(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl,</div>
<div class="line">                       stats_t *stats)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, pkts_ips[MAX_BURST], pkts_fwd[MAX_BURST];</div>
<div class="line">    <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *sa, sas[MAX_BURST];</div>
<div class="line">    <span class="keywordtype">int</span> num_pkts_ips = 0, num_pkts_fwd = 0, num_procd;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line">        pkt = pkts[i];</div>
<div class="line">        sa = get_out_sa(pkt);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa != NULL) {</div>
<div class="line">            sas[num_pkts_ips] = *sa;</div>
<div class="line">            pkts_ips[num_pkts_ips] = pkt;</div>
<div class="line">            ++num_pkts_ips;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            pkts_fwd[num_pkts_fwd++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_ips &gt; 0) {</div>
<div class="line">        num_procd = process_ipsec_out_enq(pkts_ips, sas, num_pkts_ips);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(num_procd &lt; num_pkts_ips)) {</div>
<div class="line">            stats-&gt;ipsec_out_errs += num_pkts_ips - num_procd;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a>(&amp;pkts_ips[num_procd], num_pkts_ips - num_procd);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_fwd &gt; 0) {</div>
<div class="line">        num_procd = forward_packets(pkts_fwd, num_pkts_fwd, fwd_tbl);</div>
<div class="line">        stats-&gt;discards += num_pkts_fwd - num_procd;</div>
<div class="line">        stats-&gt;fwd_pkts += num_procd;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> process_packets_in_enq(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl,</div>
<div class="line">                   stats_t *stats)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, pkts_ips[MAX_BURST], pkts_out[MAX_BURST];</div>
<div class="line">    <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *sa, sas[MAX_BURST];</div>
<div class="line">    <span class="keywordtype">int</span> num_pkts_ips = 0, num_pkts_out = 0, num_procd;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line">        pkt = pkts[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(<a name="a78"></a><a class="code" href="group__odp__packet.html#ga6a0bceb8c3c555f52638561dfce5f785">odp_packet_has_error</a>(pkt))) {</div>
<div class="line">            ++stats-&gt;discards;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sa = get_in_sa(pkt);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa != NULL) {</div>
<div class="line">            sas[num_pkts_ips] = *sa;</div>
<div class="line">            pkts_ips[num_pkts_ips] = pkt;</div>
<div class="line">            ++num_pkts_ips;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            pkts_out[num_pkts_out++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_ips &gt; 0) {</div>
<div class="line">        num_procd = process_ipsec_in_enq(pkts_ips, sas, num_pkts_ips);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(num_procd &lt; num_pkts_ips)) {</div>
<div class="line">            stats-&gt;ipsec_in_errs += num_pkts_ips - num_procd;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a>(&amp;pkts_ips[num_procd], num_pkts_ips - num_procd);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_out &gt; 0)</div>
<div class="line">        process_packets_out_enq(pkts_out, num_pkts_out, fwd_tbl, stats);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> is_ipsec_in(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <a name="a79"></a><a class="code" href="group__odp__packet.html#ga163f75fca9789a17ab4db0e75bfd9b29">odp_packet_user_ptr</a>(pkt) == NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> complete_ipsec_ops(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl,</div>
<div class="line">                   stats_t *stats)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, pkts_out[MAX_BURST], pkts_fwd[MAX_BURST];</div>
<div class="line">    <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> is_in;</div>
<div class="line">    <a name="_a80"></a><a class="code" href="structodp__ipsec__packet__result__t.html">odp_ipsec_packet_result_t</a> result;</div>
<div class="line">    <span class="keywordtype">int</span> num_pkts_out = 0, num_pkts_fwd = 0, num_procd;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line">        pkt = pkts[i];</div>
<div class="line">        is_in = is_ipsec_in(pkt);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(<a name="a81"></a><a class="code" href="group__odp__ipsec.html#gafff715b7d787c085f492eca8d77ed8c6">odp_ipsec_result</a>(&amp;result, pkt) &lt; 0)) {</div>
<div class="line">            is_in ? ++stats-&gt;ipsec_in_errs : ++stats-&gt;ipsec_out_errs;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(result.<a name="a82"></a><a class="code" href="structodp__ipsec__packet__result__t.html#a97a69c8020038199cd9da5795bf352ec">status</a>.<a name="a83"></a><a class="code" href="structodp__ipsec__op__status__t.html#a22c047c8c7008047f8a67cd70c2f0d75">all</a> != <a name="a84"></a><a class="code" href="group__odp__ipsec.html#ga2199ba574b77edc06c1a341021a6f993">ODP_IPSEC_OK</a>)) {</div>
<div class="line">            is_in ? ++stats-&gt;ipsec_in_errs : ++stats-&gt;ipsec_out_errs;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (is_in) {</div>
<div class="line">            ++stats-&gt;ipsec_in_pkts;</div>
<div class="line">            pkts_out[num_pkts_out++] = pkt;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            ++stats-&gt;ipsec_out_pkts;</div>
<div class="line">            pkts_fwd[num_pkts_fwd++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_out &gt; 0)</div>
<div class="line">        process_packets_out_enq(pkts_out, num_pkts_out, fwd_tbl, stats);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_fwd &gt; 0) {</div>
<div class="line">        num_procd = forward_packets(pkts_fwd, num_pkts_fwd, fwd_tbl);</div>
<div class="line">        stats-&gt;discards += num_pkts_fwd - num_procd;</div>
<div class="line">        stats-&gt;fwd_pkts += num_procd;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> drain_scheduler(prog_config_t *config <a class="code" href="group__odp__compiler__optim.html#ga45a2684e38da3e71b300bc89de5d6b52">ODP_UNUSED</a>)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> ev;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line">        ev = <a name="a85"></a><a class="code" href="group__odp__scheduler.html#gae4ca1012ebb16ff8b9752b958dc45ce6">odp_schedule</a>(NULL, <a name="a86"></a><a class="code" href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ev == <a name="a87"></a><a class="code" href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a>)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <a name="a88"></a><a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> process_ipsec_in(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keyword">const</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> sas[], <span class="keywordtype">int</span> num,</div>
<div class="line">                   <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts_out[])</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__ipsec__in__param__t.html">odp_ipsec_in_param_t</a> param;</div>
<div class="line">    <span class="keywordtype">int</span> left, sent = 0, num_out, ret;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;param, 0, <span class="keyword">sizeof</span>(param));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (sent &lt; num) {</div>
<div class="line">        left = num - sent;</div>
<div class="line">        num_out = left;</div>
<div class="line">        param.<a class="code" href="structodp__ipsec__in__param__t.html#a7de98bd0265da777b51d085b6ef6c6cc">num_sa</a> = left;</div>
<div class="line">        param.<a class="code" href="structodp__ipsec__in__param__t.html#ad89e2bbaa4148ee47dd1856874b9bb76">sa</a> = &amp;sas[sent];</div>
<div class="line">        ret = <a name="a89"></a><a class="code" href="group__odp__ipsec.html#ga0542160055a5dbd2974d33b10275d820">odp_ipsec_in</a>(&amp;pkts[sent], left, &amp;pkts_out[sent], &amp;num_out, &amp;param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(ret &lt;= 0))</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        sent += ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> sent;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> process_ipsec_out(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keyword">const</span> <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> sas[], <span class="keywordtype">int</span> num,</div>
<div class="line">                    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts_out[])</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__ipsec__out__param__t.html">odp_ipsec_out_param_t</a> param;</div>
<div class="line">    <span class="keywordtype">int</span> left, sent = 0, num_out, ret;</div>
<div class="line"> </div>
<div class="line">    memset(&amp;param, 0, <span class="keyword">sizeof</span>(param));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (sent &lt; num) {</div>
<div class="line">        left = num - sent;</div>
<div class="line">        num_out = left;</div>
<div class="line">        param.<a class="code" href="structodp__ipsec__out__param__t.html#aa034994bdaee89c31815872f19f8c0e7">num_sa</a> = left;</div>
<div class="line">        param.<a class="code" href="structodp__ipsec__out__param__t.html#a5a04803b40fb0d917d10f57ef7284c48">sa</a> = &amp;sas[sent];</div>
<div class="line">        ret = <a name="a90"></a><a class="code" href="group__odp__ipsec.html#ga3cbcf39eb43d44243f24fdb1739d82d5">odp_ipsec_out</a>(&amp;pkts[sent], left, &amp;pkts_out[sent], &amp;num_out, &amp;param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(ret &lt;= 0))</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        sent += ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> sent;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> process_packets_out(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl,</div>
<div class="line">                       stats_t *stats)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, pkts_ips[MAX_BURST], pkts_fwd[MAX_BURST], pkts_ips_out[MAX_BURST];</div>
<div class="line">    <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *sa, sas[MAX_BURST];</div>
<div class="line">    <span class="keywordtype">int</span> num_pkts_ips = 0, num_pkts_fwd = 0, num_procd;</div>
<div class="line">    <a class="code" href="structodp__ipsec__packet__result__t.html">odp_ipsec_packet_result_t</a> result;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line">        pkt = pkts[i];</div>
<div class="line">        sa = get_out_sa(pkt);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa != NULL) {</div>
<div class="line">            sas[num_pkts_ips] = *sa;</div>
<div class="line">            pkts_ips[num_pkts_ips] = pkt;</div>
<div class="line">            ++num_pkts_ips;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            pkts_fwd[num_pkts_fwd++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_ips &gt; 0) {</div>
<div class="line">        num_procd = process_ipsec_out(pkts_ips, sas, num_pkts_ips, pkts_ips_out);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(num_procd &lt; num_pkts_ips)) {</div>
<div class="line">            stats-&gt;ipsec_out_errs += num_pkts_ips - num_procd;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a>(&amp;pkts_ips[num_procd], num_pkts_ips - num_procd);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_procd; ++i) {</div>
<div class="line">            pkt = pkts_ips_out[i];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(<a class="code" href="group__odp__ipsec.html#gafff715b7d787c085f492eca8d77ed8c6">odp_ipsec_result</a>(&amp;result, pkt) &lt; 0)) {</div>
<div class="line">                ++stats-&gt;ipsec_out_errs;</div>
<div class="line">                <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(result.<a class="code" href="structodp__ipsec__packet__result__t.html#a97a69c8020038199cd9da5795bf352ec">status</a>.<a class="code" href="structodp__ipsec__op__status__t.html#a22c047c8c7008047f8a67cd70c2f0d75">all</a> != <a class="code" href="group__odp__ipsec.html#ga2199ba574b77edc06c1a341021a6f993">ODP_IPSEC_OK</a>)) {</div>
<div class="line">                ++stats-&gt;ipsec_out_errs;</div>
<div class="line">                <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ++stats-&gt;ipsec_out_pkts;</div>
<div class="line">            pkts_fwd[num_pkts_fwd++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_fwd &gt; 0) {</div>
<div class="line">        num_procd = forward_packets(pkts_fwd, num_pkts_fwd, fwd_tbl);</div>
<div class="line">        stats-&gt;discards += num_pkts_fwd - num_procd;</div>
<div class="line">        stats-&gt;fwd_pkts += num_procd;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> process_packets_in(<a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num, lookup_table_t *fwd_tbl,</div>
<div class="line">                   stats_t *stats)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, pkts_ips[MAX_BURST], pkts_out[MAX_BURST], pkts_ips_out[MAX_BURST];</div>
<div class="line">    <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> *sa, sas[MAX_BURST];</div>
<div class="line">    <span class="keywordtype">int</span> num_pkts_ips = 0, num_pkts_out = 0, num_procd;</div>
<div class="line">    <a class="code" href="structodp__ipsec__packet__result__t.html">odp_ipsec_packet_result_t</a> result;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line">        pkt = pkts[i];</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(<a class="code" href="group__odp__packet.html#ga6a0bceb8c3c555f52638561dfce5f785">odp_packet_has_error</a>(pkt))) {</div>
<div class="line">            ++stats-&gt;discards;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        sa = get_in_sa(pkt);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa != NULL) {</div>
<div class="line">            sas[num_pkts_ips] = *sa;</div>
<div class="line">            pkts_ips[num_pkts_ips] = pkt;</div>
<div class="line">            ++num_pkts_ips;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            pkts_out[num_pkts_out++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_ips &gt; 0) {</div>
<div class="line">        num_procd = process_ipsec_in(pkts_ips, sas, num_pkts_ips, pkts_ips_out);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(num_procd &lt; num_pkts_ips)) {</div>
<div class="line">            stats-&gt;ipsec_in_errs += num_pkts_ips - num_procd;</div>
<div class="line">            <a class="code" href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a>(&amp;pkts_ips[num_procd], num_pkts_ips - num_procd);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_procd; ++i) {</div>
<div class="line">            pkt = pkts_ips_out[i];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(<a class="code" href="group__odp__ipsec.html#gafff715b7d787c085f492eca8d77ed8c6">odp_ipsec_result</a>(&amp;result, pkt) &lt; 0)) {</div>
<div class="line">                ++stats-&gt;ipsec_in_errs;</div>
<div class="line">                <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(result.<a class="code" href="structodp__ipsec__packet__result__t.html#a97a69c8020038199cd9da5795bf352ec">status</a>.<a class="code" href="structodp__ipsec__op__status__t.html#a22c047c8c7008047f8a67cd70c2f0d75">all</a> != <a class="code" href="group__odp__ipsec.html#ga2199ba574b77edc06c1a341021a6f993">ODP_IPSEC_OK</a>)) {</div>
<div class="line">                ++stats-&gt;ipsec_in_errs;</div>
<div class="line">                <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ++stats-&gt;ipsec_in_pkts;</div>
<div class="line">            pkts_out[num_pkts_out++] = pkt;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_pkts_out &gt; 0)</div>
<div class="line">        process_packets_out(pkts_out, num_pkts_out, fwd_tbl, stats);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> drain_direct_inputs(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_ifs; ++i) {</div>
<div class="line">        <span class="keywordflow">for</span> (uint32_t j = 0U; j &lt; config-&gt;num_input_qs; ++j) {</div>
<div class="line">            <span class="keywordflow">while</span> (<a name="a91"></a><a class="code" href="group__odp__packet__io.html#gab3dd2331f6ba05e074333fd5badae340">odp_pktin_recv</a>(config-&gt;pktios[i].in_dir_qs[j], &amp;pkt, 1) == 1)</div>
<div class="line">                <a class="code" href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a>(pkt);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> setup_ipsec(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a name="_a92"></a><a class="code" href="structodp__queue__param__t.html">odp_queue_param_t</a> q_param;</div>
<div class="line">    <a name="_a93"></a><a class="code" href="structodp__ipsec__config__t.html">odp_ipsec_config_t</a> ipsec_config;</div>
<div class="line">    <span class="keywordtype">char</span> q_name[<a name="a94"></a><a class="code" href="group__odp__queue.html#ga8891fdf050b94cb84fcd2c59fef31bec">ODP_QUEUE_NAME_LEN</a>];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!config-&gt;is_dir_rx) {</div>
<div class="line">        snprintf(q_name, <span class="keyword">sizeof</span>(q_name), SHORT_PROG_NAME <span class="stringliteral">&quot;_sa_status&quot;</span>);</div>
<div class="line">        <a name="a95"></a><a class="code" href="group__odp__queue.html#ga6fc2ea5eb86152210342f7377d1468e4">odp_queue_param_init</a>(&amp;q_param);</div>
<div class="line">        q_param.<a name="a96"></a><a class="code" href="structodp__queue__param__t.html#a6a7251138773a3110bdc0e8d5f5b3be9">type</a> = <a name="a97"></a><a class="code" href="group__odp__queue.html#gga89a3439d3f3be48cac1767cba721eddaa4f49ad2143a9ba8a5914573d2794e962">ODP_QUEUE_TYPE_SCHED</a>;</div>
<div class="line">        q_param.<a name="a98"></a><a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a name="a99"></a><a class="code" href="structodp__schedule__param__t.html#a3f103771c3a9319c1ec998fa8724b8ac">prio</a> = <a name="a100"></a><a class="code" href="group__odp__scheduler.html#ga94034a7f591f3f549099aebb098f7e05">odp_schedule_default_prio</a>();</div>
<div class="line">        q_param.<a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a name="a101"></a><a class="code" href="structodp__schedule__param__t.html#ad4ca09d63edb0cec36567c26688cea14">sync</a> = <a name="a102"></a><a class="code" href="group__odp__scheduler.html#ga2ba135fc660e1c050aa25ec6744ec584">ODP_SCHED_SYNC_PARALLEL</a>;</div>
<div class="line">        q_param.<a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a name="a103"></a><a class="code" href="structodp__schedule__param__t.html#a0bc7830a919f31ce295a20c51a7e2648">group</a> = <a name="a104"></a><a class="code" href="group__odp__scheduler.html#gaf463b15ad978dac0bf77c0110232b504">ODP_SCHED_GROUP_ALL</a>;</div>
<div class="line">        config-&gt;compl_q = <a name="a105"></a><a class="code" href="group__odp__queue.html#gab985be8c3947fef3da257e16948bf0f0">odp_queue_create</a>(q_name, &amp;q_param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;compl_q == <a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error creating IPsec completion queue\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a106"></a><a class="code" href="group__odp__ipsec.html#ga70943ba89e0a50a2c72332301f38054d">odp_ipsec_config_init</a>(&amp;ipsec_config);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!config-&gt;is_dir_rx) {</div>
<div class="line">        ipsec_config.<a name="a107"></a><a class="code" href="structodp__ipsec__config__t.html#afda7c35b60666f6e19ee3e6e049c71ce">inbound_mode</a> = <a name="a108"></a><a class="code" href="group__odp__ipsec.html#gga62ebf20444145fe3faa4e0ceed7c121baa997483371ce738cebfcc5cef437cf5e">ODP_IPSEC_OP_MODE_ASYNC</a>;</div>
<div class="line">        ipsec_config.<a name="a109"></a><a class="code" href="structodp__ipsec__config__t.html#a68a6a143a51129e7178f2c908fa41343">outbound_mode</a> = <a class="code" href="group__odp__ipsec.html#gga62ebf20444145fe3faa4e0ceed7c121baa997483371ce738cebfcc5cef437cf5e">ODP_IPSEC_OP_MODE_ASYNC</a>;</div>
<div class="line">        config-&gt;ops.proc = process_packets_in_enq;</div>
<div class="line">        config-&gt;ops.compl = complete_ipsec_ops;</div>
<div class="line">        config-&gt;ops.drain = drain_scheduler;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        ipsec_config.<a class="code" href="structodp__ipsec__config__t.html#afda7c35b60666f6e19ee3e6e049c71ce">inbound_mode</a> = <a name="a110"></a><a class="code" href="group__odp__ipsec.html#gga62ebf20444145fe3faa4e0ceed7c121ba5c37267f141685b9df2d29a8af727e8f">ODP_IPSEC_OP_MODE_SYNC</a>;</div>
<div class="line">        ipsec_config.<a class="code" href="structodp__ipsec__config__t.html#a68a6a143a51129e7178f2c908fa41343">outbound_mode</a> = <a class="code" href="group__odp__ipsec.html#gga62ebf20444145fe3faa4e0ceed7c121ba5c37267f141685b9df2d29a8af727e8f">ODP_IPSEC_OP_MODE_SYNC</a>;</div>
<div class="line">        config-&gt;ops.proc = process_packets_in;</div>
<div class="line">        config-&gt;ops.compl = NULL;</div>
<div class="line">        config-&gt;ops.drain = drain_direct_inputs;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ipsec_config.<a name="a111"></a><a class="code" href="structodp__ipsec__config__t.html#aa75541d269385cb764421165a6e393f7">inbound</a>.<a name="a112"></a><a class="code" href="structodp__ipsec__inbound__config__t.html#a5a97f8e38e05ccd1a83acd57e4c2e655">default_queue</a> = config-&gt;compl_q;</div>
<div class="line">    <span class="comment">/* For tunnel to tunnel, we need to parse up to this to check the UDP port for SA. */</span></div>
<div class="line">    ipsec_config.<a class="code" href="structodp__ipsec__config__t.html#aa75541d269385cb764421165a6e393f7">inbound</a>.<a name="a113"></a><a class="code" href="structodp__ipsec__inbound__config__t.html#a70dfa978b76e6bfc05b589d1caadb967">parse_level</a> = <a name="a114"></a><a class="code" href="group__odp__packet.html#gga428cdbec9e7bc0bc19286f9564f9828ba45a5be98c1596b05a7406f894902beaf">ODP_PROTO_LAYER_L4</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a115"></a><a class="code" href="group__odp__ipsec.html#ga85cc7deadb7406d340b6597fe4b516cc">odp_ipsec_config</a>(&amp;ipsec_config) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error configuring IPsec\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> create_sa_dest_queues(<a class="code" href="structodp__ipsec__capability__t.html">odp_ipsec_capability_t</a> *ipsec_capa,</div>
<div class="line">                    prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__queue__param__t.html">odp_queue_param_t</a> q_param;</div>
<div class="line">    <span class="keyword">const</span> uint32_t max_sa_qs = ODPH_MIN(MAX_SA_QUEUES, ipsec_capa-&gt;<a name="a116"></a><a class="code" href="structodp__ipsec__capability__t.html#ad98b9759e0b8652f6dbd12c33efed808">max_queues</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;num_sa_qs == 0U || config-&gt;num_sa_qs &gt; max_sa_qs) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Invalid number of SA queues: %u (min: 1, max: %u)\n&quot;</span>, config-&gt;num_sa_qs,</div>
<div class="line">             max_sa_qs);</div>
<div class="line">        config-&gt;num_sa_qs = 0U;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_sa_qs; ++i) {</div>
<div class="line">        <span class="keywordtype">char</span> q_name[<a class="code" href="group__odp__queue.html#ga8891fdf050b94cb84fcd2c59fef31bec">ODP_QUEUE_NAME_LEN</a>];</div>
<div class="line"> </div>
<div class="line">        snprintf(q_name, <span class="keyword">sizeof</span>(q_name), SHORT_PROG_NAME <span class="stringliteral">&quot;_sa_compl_%u&quot;</span>, i);</div>
<div class="line">        <a class="code" href="group__odp__queue.html#ga6fc2ea5eb86152210342f7377d1468e4">odp_queue_param_init</a>(&amp;q_param);</div>
<div class="line">        q_param.<a class="code" href="structodp__queue__param__t.html#a6a7251138773a3110bdc0e8d5f5b3be9">type</a> = <a class="code" href="group__odp__queue.html#gga89a3439d3f3be48cac1767cba721eddaa4f49ad2143a9ba8a5914573d2794e962">ODP_QUEUE_TYPE_SCHED</a>;</div>
<div class="line">        q_param.<a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a class="code" href="structodp__schedule__param__t.html#a3f103771c3a9319c1ec998fa8724b8ac">prio</a> = <a name="a117"></a><a class="code" href="group__odp__scheduler.html#ga9d91b9144cf2ccdcb112b7376a38aeaf">odp_schedule_max_prio</a>();</div>
<div class="line">        q_param.<a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a class="code" href="structodp__schedule__param__t.html#ad4ca09d63edb0cec36567c26688cea14">sync</a> = config-&gt;mode == ORDERED ? <a name="a118"></a><a class="code" href="group__odp__scheduler.html#ga4df3696ebf4528ecc6e69ae3fff040fd">ODP_SCHED_SYNC_ORDERED</a> :</div>
<div class="line">                                   <a class="code" href="group__odp__scheduler.html#ga2ba135fc660e1c050aa25ec6744ec584">ODP_SCHED_SYNC_PARALLEL</a>;</div>
<div class="line">        q_param.<a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a class="code" href="structodp__schedule__param__t.html#a0bc7830a919f31ce295a20c51a7e2648">group</a> = <a class="code" href="group__odp__scheduler.html#gaf463b15ad978dac0bf77c0110232b504">ODP_SCHED_GROUP_ALL</a>;</div>
<div class="line">        config-&gt;sa_qs[i] = <a class="code" href="group__odp__queue.html#gab985be8c3947fef3da257e16948bf0f0">odp_queue_create</a>(q_name, &amp;q_param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;sa_qs[i] == <a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error creating SA destination queue (created count: %u)\n&quot;</span>, i);</div>
<div class="line">            config-&gt;num_sa_qs = i;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_crypto(config_setting_t *cfg, sa_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> val;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *val_str;</div>
<div class="line">    config_setting_t *cs = config_setting_lookup(cfg, <span class="stringliteral">&quot;crypto&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;cipher_alg&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.crypto.cipher_alg = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cs, <span class="stringliteral">&quot;cipher_key&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        strcpy(config-&gt;cipher_key, val_str);</div>
<div class="line">        config-&gt;sa_param.crypto.cipher_key.data = (uint8_t *)config-&gt;cipher_key;</div>
<div class="line">        config-&gt;sa_param.crypto.cipher_key.length =</div>
<div class="line">            strlen((<span class="keyword">const</span> <span class="keywordtype">char</span> *)config-&gt;cipher_key);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cs, <span class="stringliteral">&quot;cipher_key_extra&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        strcpy(config-&gt;cipher_key_extra, val_str);</div>
<div class="line">        config-&gt;sa_param.crypto.cipher_key_extra.data =</div>
<div class="line">            (uint8_t *)config-&gt;cipher_key_extra;</div>
<div class="line">        config-&gt;sa_param.crypto.cipher_key_extra.length =</div>
<div class="line">            strlen((<span class="keyword">const</span> <span class="keywordtype">char</span> *)config-&gt;cipher_key_extra);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;auth_alg&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.crypto.auth_alg = val;</div>
<div class="line"> </div>
<div class="line">    if (config_setting_lookup_string(cs, <span class="stringliteral">&quot;auth_key&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        strcpy(config-&gt;auth_key, val_str);</div>
<div class="line">        config-&gt;sa_param.crypto.auth_key.data = (uint8_t *)config-&gt;auth_key;</div>
<div class="line">        config-&gt;sa_param.crypto.auth_key.length = strlen((<span class="keyword">const</span> <span class="keywordtype">char</span> *)config-&gt;auth_key);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cs, <span class="stringliteral">&quot;auth_key_extra&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        strcpy(config-&gt;auth_key_extra, val_str);</div>
<div class="line">        config-&gt;sa_param.crypto.auth_key_extra.data = (uint8_t *)config-&gt;auth_key_extra;</div>
<div class="line">        config-&gt;sa_param.crypto.auth_key_extra.length =</div>
<div class="line">            strlen((<span class="keyword">const</span> <span class="keywordtype">char</span> *)config-&gt;auth_key_extra);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;icv_len&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.crypto.icv_len = val;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_opt(config_setting_t *cfg, sa_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> val;</div>
<div class="line">    config_setting_t *cs = config_setting_lookup(cfg, <span class="stringliteral">&quot;opt&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;esn&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.opt.esn = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;udp_encap&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.opt.udp_encap = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;copy_dscp&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.opt.copy_dscp = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;copy_flabel&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.opt.copy_flabel = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;copy_df&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.opt.copy_df = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;dec_ttl&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.opt.dec_ttl = val;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_limits(config_setting_t *cfg, sa_config_t *config)</div>
<div class="line">{</div>
<div class="line">    config_setting_t *cs = config_setting_lookup(cfg, <span class="stringliteral">&quot;lifetime&quot;</span>), *soft, *hard;</div>
<div class="line">    <span class="keywordtype">long</span> <span class="keywordtype">long</span> val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    soft = config_setting_lookup(cs, <span class="stringliteral">&quot;soft_limit&quot;</span>);</div>
<div class="line">    hard = config_setting_lookup(cs, <span class="stringliteral">&quot;hard_limit&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (soft != NULL) {</div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int64(soft, <span class="stringliteral">&quot;bytes&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.lifetime.soft_limit.bytes = val;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int64(soft, <span class="stringliteral">&quot;packets&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.lifetime.soft_limit.packets = val;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (hard != NULL) {</div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int64(hard, <span class="stringliteral">&quot;bytes&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.lifetime.hard_limit.bytes = val;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int64(hard, <span class="stringliteral">&quot;packets&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.lifetime.hard_limit.packets = val;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_inbound(config_setting_t *cfg, sa_config_t *config)</div>
<div class="line">{</div>
<div class="line">    config_setting_t *cs = config_setting_lookup(cfg, <span class="stringliteral">&quot;inbound&quot;</span>);</div>
<div class="line">    <span class="keywordtype">int</span> val;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *val_str;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;lookup_mode&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.inbound.lookup_mode = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cs, <span class="stringliteral">&quot;lookup_dst_addr&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        <span class="keywordflow">if</span> (odph_ipv4_addr_parse(&amp;config-&gt;lkp_dst_ip, val_str) == 0) {</div>
<div class="line">            config-&gt;lkp_dst_ip = <a name="a119"></a><a class="code" href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a>(config-&gt;lkp_dst_ip);</div>
<div class="line">            config-&gt;sa_param.inbound.lookup_param.dst_addr = &amp;config-&gt;lkp_dst_ip;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;antireplay_ws&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.inbound.antireplay_ws = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;reassembly_en&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.inbound.reassembly_en = val;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_outbound(config_setting_t *cfg, sa_config_t *config)</div>
<div class="line">{</div>
<div class="line">    config_setting_t *cs = config_setting_lookup(cfg, <span class="stringliteral">&quot;outbound&quot;</span>), *tunnel;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *val_str;</div>
<div class="line">    <span class="keywordtype">int</span> val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    tunnel = config_setting_lookup(cs, <span class="stringliteral">&quot;tunnel&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (tunnel != NULL) {</div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_string(tunnel, <span class="stringliteral">&quot;src_addr&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">            <span class="keywordflow">if</span> (odph_ipv4_addr_parse(&amp;config-&gt;src_ip, val_str) == 0) {</div>
<div class="line">                config-&gt;src_ip = <a class="code" href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a>(config-&gt;src_ip);</div>
<div class="line">                config-&gt;sa_param.outbound.tunnel.ipv4.src_addr = &amp;config-&gt;src_ip;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_string(tunnel, <span class="stringliteral">&quot;dst_addr&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">            <span class="keywordflow">if</span> (odph_ipv4_addr_parse(&amp;config-&gt;dst_ip, val_str) == 0) {</div>
<div class="line">                config-&gt;dst_ip = <a class="code" href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a>(config-&gt;dst_ip);</div>
<div class="line">                config-&gt;sa_param.outbound.tunnel.ipv4.dst_addr = &amp;config-&gt;dst_ip;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int(tunnel, <span class="stringliteral">&quot;dscp&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.outbound.tunnel.ipv4.dscp = val;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int(tunnel, <span class="stringliteral">&quot;df&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.outbound.tunnel.ipv4.df = val;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int(tunnel, <span class="stringliteral">&quot;ttl&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">            config-&gt;sa_param.outbound.tunnel.ipv4.ttl = val;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;frag_mode&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.outbound.frag_mode = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cs, <span class="stringliteral">&quot;mtu&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.outbound.mtu = val;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_sa_entry(config_setting_t *cfg, sa_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cfg, <span class="stringliteral">&quot;dir&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.dir = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cfg, <span class="stringliteral">&quot;proto&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.proto = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cfg, <span class="stringliteral">&quot;mode&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.mode = val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_int(cfg, <span class="stringliteral">&quot;spi&quot;</span>, &amp;val) == CONFIG_TRUE)</div>
<div class="line">        config-&gt;sa_param.spi = val;</div>
<div class="line"> </div>
<div class="line">    parse_crypto(cfg, config);</div>
<div class="line">    parse_opt(cfg, config);</div>
<div class="line">    parse_limits(cfg, config);</div>
<div class="line">    parse_inbound(cfg, config);</div>
<div class="line">    parse_outbound(cfg, config);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> create_sa_entry(<a class="code" href="structodp__ipsec__sa__param__t.html">odp_ipsec_sa_param_t</a> *sa_param, prog_config_t *config,</div>
<div class="line">                uint32_t max_num_sa)</div>
<div class="line">{</div>
<div class="line">    uint32_t dir = sa_param-&gt;<a name="a120"></a><a class="code" href="structodp__ipsec__sa__param__t.html#a8f5df06cff3180089206954511a72186">dir</a>;</div>
<div class="line">    uint32_t spi = sa_param-&gt;<a name="a121"></a><a class="code" href="structodp__ipsec__sa__param__t.html#a30f487908a45f7bc3525c7b6589a0a19">spi</a>;</div>
<div class="line">    <a class="code" href="struct__odp__abi__ipsec__sa__t.html">odp_ipsec_sa_t</a> sa;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;num_sas == max_num_sa) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Maximum number of SAs parsed (%u), ignoring rest\n&quot;</span>, max_num_sa);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (spi &gt; UINT16_MAX) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Unsupported SPI value for SA %u (&gt; %u)\n&quot;</span>, spi, UINT16_MAX);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (spi_to_sa_map[dir][spi] != NULL) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Non-unique SPIs not supported for SA %u\n&quot;</span>, spi);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    sa_param-&gt;<a name="a122"></a><a class="code" href="structodp__ipsec__sa__param__t.html#a463c2cbc43b94ae61c709d782a7beda7">dest_queue</a> = config-&gt;sa_qs[config-&gt;num_sas % config-&gt;num_sa_qs];</div>
<div class="line">    sa = <a name="a123"></a><a class="code" href="group__odp__ipsec.html#gae4e141526c0c12948dbed9f187043b6e">odp_ipsec_sa_create</a>(sa_param);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (sa == <a name="a124"></a><a class="code" href="group__odp__ipsec.html#gad16586424d5ace868a99b2c3bad18fb0">ODP_IPSEC_SA_INVALID</a>) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error creating SA handle for SA %u\n&quot;</span>, spi);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    config-&gt;sas[config-&gt;num_sas] = sa;</div>
<div class="line">    spi_to_sa_map[dir][spi] = &amp;config-&gt;sas[config-&gt;num_sas];</div>
<div class="line">    ++config-&gt;num_sas;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_and_create_sa_entries(config_t *cfg, prog_config_t *config, uint32_t max_num_sa)</div>
<div class="line">{</div>
<div class="line">    config_setting_t *cs;</div>
<div class="line">    <span class="keywordtype">int</span> count;</div>
<div class="line"> </div>
<div class="line">    cs = config_lookup(cfg, <span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs != NULL)</div>
<div class="line">        parse_sa_entry(cs, &amp;config-&gt;default_cfg);</div>
<div class="line"> </div>
<div class="line">    cs = config_lookup(cfg, <span class="stringliteral">&quot;sa&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    count = config_setting_length(cs);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++) {</div>
<div class="line">        sa_config_t sa_cfg;</div>
<div class="line">        config_setting_t *sa;</div>
<div class="line">        <span class="keywordtype">int</span> val;</div>
<div class="line"> </div>
<div class="line">        sa_cfg = config-&gt;default_cfg;</div>
<div class="line">        sa = config_setting_get_elem(cs, i);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (sa == NULL)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config_setting_lookup_int(sa, <span class="stringliteral">&quot;spi&quot;</span>, &amp;val) == CONFIG_TRUE) {</div>
<div class="line">            parse_sa_entry(sa, &amp;sa_cfg);</div>
<div class="line">            create_sa_entry(&amp;sa_cfg.sa_param, config, max_num_sa);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_sas(config_t *cfg, prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__ipsec__capability__t.html">odp_ipsec_capability_t</a> ipsec_capa;</div>
<div class="line">    uint32_t max_num_sa;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__ipsec.html#ga2cf54f017249dde280072e48251d2d31">odp_ipsec_capability</a>(&amp;ipsec_capa) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error querying IPsec capabilities\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!setup_ipsec(config))</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!config-&gt;is_dir_rx &amp;&amp; !create_sa_dest_queues(&amp;ipsec_capa, config))</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    max_num_sa = ODPH_MIN(MAX_SAS, ipsec_capa.<a name="a125"></a><a class="code" href="structodp__ipsec__capability__t.html#a9241e32b688bb109b67ef130dac0cbc2">max_num_sa</a>);</div>
<div class="line">    parse_and_create_sa_entries(cfg, config, max_num_sa);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> pktio_t *get_pktio(<span class="keyword">const</span> <span class="keywordtype">char</span> *iface, <span class="keyword">const</span> prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_ifs; ++i) {</div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(iface, config-&gt;pktios[i].name) == 0)</div>
<div class="line">            <span class="keywordflow">return</span> &amp;config-&gt;pktios[i];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> create_fwd_table_entry(config_setting_t *cfg, prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *val_str;</div>
<div class="line">    <span class="keywordtype">char</span> dst_ip_str[16U] = { 0 };</div>
<div class="line">    uint32_t mask, dst_ip;</div>
<div class="line">    odph_ethaddr_t dst_mac;</div>
<div class="line">    <span class="keyword">const</span> pktio_t *pktio = NULL;</div>
<div class="line">    fwd_entry_t *entry;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;fwd_tbl.num == MAX_FWDS) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Maximum number of forwarding entries parsed (%u), ignoring rest\n&quot;</span>,</div>
<div class="line">             MAX_FWDS);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cfg, <span class="stringliteral">&quot;prefix&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        <span class="keywordflow">if</span> (sscanf(val_str, <span class="stringliteral">&quot;%[^/]/%u&quot;</span>, dst_ip_str, &amp;mask) != 2) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error parsing IP and subnet mask for forwarding entry\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (odph_ipv4_addr_parse(&amp;dst_ip, dst_ip_str) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Syntax error in IP address for forwarding entry\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (mask &gt; IP_ADDR_LEN) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Invalid subnet mask for forwarding entry: %u\n&quot;</span>, mask);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cfg, <span class="stringliteral">&quot;if&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        pktio = get_pktio(val_str, config);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pktio == NULL) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error parsing next interface for forwarding entry\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_setting_lookup_string(cfg, <span class="stringliteral">&quot;dst_mac&quot;</span>, &amp;val_str) == CONFIG_TRUE) {</div>
<div class="line">        <span class="keywordflow">if</span> (odph_eth_addr_parse(&amp;dst_mac, val_str) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Syntax error in destination MAC for forwarding entry\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    mask = mask &gt; 0U ? 0xFFFFFFFF &lt;&lt; (IP_ADDR_LEN - mask) : 0U;</div>
<div class="line">    entry = &amp;config-&gt;fwd_tbl.entries[config-&gt;fwd_tbl.num];</div>
<div class="line">    entry-&gt;prefix = dst_ip &amp; mask;</div>
<div class="line">    entry-&gt;mask = mask;</div>
<div class="line">    entry-&gt;dst_mac = dst_mac;</div>
<div class="line">    entry-&gt;pktio = pktio;</div>
<div class="line">    ++config-&gt;fwd_tbl.num;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> parse_fwd_table(config_t *cfg, prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    config_setting_t *cs;</div>
<div class="line">    <span class="keywordtype">int</span> count;</div>
<div class="line"> </div>
<div class="line">    cs = config_lookup(cfg, <span class="stringliteral">&quot;fwd&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cs == NULL)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    count = config_setting_length(cs);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++) {</div>
<div class="line">        config_setting_t *fwd = config_setting_get_elem(cs, i);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (fwd == NULL)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        create_fwd_table_entry(fwd, config);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> parse_result_t check_options(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structodp__pool__capability__t.html">odp_pool_capability_t</a> pool_capa;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__pool.html#ga2c6f42e9611904eac84872bf8f913b75">odp_pool_capability</a>(&amp;pool_capa) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error querying pool capabilities\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;num_ifs == 0U) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Invalid number of interfaces: %u (min: 1, max: %u)\n&quot;</span>, config-&gt;num_ifs,</div>
<div class="line">             MAX_IFS);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;fwd_tbl.num == 0U) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Invalid number of forwarding entries: %u (min: 1, max: %u)\n&quot;</span>,</div>
<div class="line">             config-&gt;fwd_tbl.num, MAX_FWDS);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a> &gt; 0U &amp;&amp; config-&gt;num_pkts &gt; pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a>) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Invalid pool packet count: %u (max: %u)\n&quot;</span>, config-&gt;num_pkts,</div>
<div class="line">             pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a>);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;num_pkts == 0U)</div>
<div class="line">        config-&gt;num_pkts = pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a> &gt; 0U ?</div>
<div class="line">                    ODPH_MIN(pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">max_num</a>, PKT_CNT) : PKT_CNT;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a> &gt; 0U &amp;&amp; config-&gt;pkt_len &gt; pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a>) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Invalid pool packet length: %u (max: %u)\n&quot;</span>, config-&gt;pkt_len,</div>
<div class="line">             pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a>);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;pkt_len == 0U)</div>
<div class="line">        config-&gt;pkt_len = pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a> &gt; 0U ?</div>
<div class="line">                    ODPH_MIN(pool_capa.<a class="code" href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">pkt</a>.<a class="code" href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">max_len</a>, PKT_SIZE) : PKT_SIZE;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;num_thrs &lt;= 0 || config-&gt;num_thrs &gt; MAX_WORKERS) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Invalid thread count: %d (min: 1, max: %d)\n&quot;</span>, config-&gt;num_thrs,</div>
<div class="line">             MAX_WORKERS);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;is_dir_rx) {</div>
<div class="line">        config-&gt;num_input_qs = config-&gt;num_thrs;</div>
<div class="line">        config-&gt;num_output_qs = config-&gt;num_thrs;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> PRS_OK;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> parse_result_t parse_options(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv, prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt;</div>
<div class="line">    config_t cfg;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>option longopts[] = {</div>
<div class="line">        { <span class="stringliteral">&quot;interfaces&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;i&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;num_pkts&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;n&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;pkt_len&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;l&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;count&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;c&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;mode&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;m&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;conf&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;C&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;num_input_qs&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;I&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;num_sa_qs&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;S&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;num_output_qs&quot;</span>, required_argument, NULL, <span class="charliteral">&#39;O&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;direct_rx&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;d&#39;</span> },</div>
<div class="line">        { <span class="stringliteral">&quot;help&quot;</span>, no_argument, NULL, <span class="charliteral">&#39;h&#39;</span> },</div>
<div class="line">        { NULL, 0, NULL, 0 }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *shortopts = <span class="stringliteral">&quot;i:n:l:c:m:C:I:S:O:dh&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line">        opt = getopt_long(argc, argv, shortopts, longopts, NULL);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (opt == -1)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line">            parse_interfaces(config, optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div>
<div class="line">            config-&gt;num_pkts = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line">            config-&gt;pkt_len = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line">            config-&gt;num_thrs = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line">            config-&gt;mode = !!atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line">            config-&gt;conf_file = strdup(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:</div>
<div class="line">            config-&gt;num_input_qs = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line">            config-&gt;num_sa_qs = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>:</div>
<div class="line">            config-&gt;num_output_qs = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line">            config-&gt;is_dir_rx = <span class="keyword">true</span>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line">            print_usage();</div>
<div class="line">            <span class="keywordflow">return</span> PRS_TERM;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            print_usage();</div>
<div class="line">            <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    config_init(&amp;cfg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config_read_file(&amp;cfg, config-&gt;conf_file) == CONFIG_FALSE) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error opening SA configuration file: %s\n&quot;</span>,  config_error_text(&amp;cfg));</div>
<div class="line">        config_destroy(&amp;cfg);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    parse_sas(&amp;cfg, config);</div>
<div class="line">    parse_fwd_table(&amp;cfg, config);</div>
<div class="line">    config_destroy(&amp;cfg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> check_options(config);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> parse_result_t setup_program(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv, prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>sigaction action = { .sa_handler = terminate };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (sigemptyset(&amp;action.sa_mask) == -1 || sigaddset(&amp;action.sa_mask, SIGINT) == -1 ||</div>
<div class="line">        sigaddset(&amp;action.sa_mask, SIGTERM) == -1 ||</div>
<div class="line">        sigaddset(&amp;action.sa_mask, SIGHUP) == -1 || sigaction(SIGINT, &amp;action, NULL) == -1 ||</div>
<div class="line">        sigaction(SIGTERM, &amp;action, NULL) == -1 || sigaction(SIGHUP, &amp;action, NULL) == -1) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error installing signal handler\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> PRS_NOK;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> parse_options(argc, argv, config);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t schedule(thread_config_t *config <a class="code" href="group__odp__compiler__optim.html#ga45a2684e38da3e71b300bc89de5d6b52">ODP_UNUSED</a>, <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> evs[], <span class="keywordtype">int</span> num)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <a name="a126"></a><a class="code" href="group__odp__scheduler.html#ga17ae1ac2ac704684d0a7087a311c73f4">odp_schedule_multi_no_wait</a>(NULL, evs, num);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t recv(thread_config_t *config, <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> evs[], <span class="keywordtype">int</span> num)</div>
<div class="line">{</div>
<div class="line">    prog_config_t *prog_config = config-&gt;prog_config;</div>
<div class="line">    pktio_t *pktio = &amp;prog_config-&gt;pktios[config-&gt;pktio++ % prog_config-&gt;num_ifs];</div>
<div class="line">    <a class="code" href="structodp__pktin__queue__s.html">odp_pktin_queue_t</a> in_q = pktio-&gt;in_dir_qs[config-&gt;thr_idx % prog_config-&gt;num_input_qs];</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[num];</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    ret = <a class="code" href="group__odp__packet__io.html#gab3dd2331f6ba05e074333fd5badae340">odp_pktin_recv</a>(in_q, pkts, num);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(ret &lt;= 0))</div>
<div class="line">        <span class="keywordflow">return</span> 0U;</div>
<div class="line"> </div>
<div class="line">    <a name="a127"></a><a class="code" href="group__odp__packet.html#ga229f5a60b69678c472b6b75dcf443dfe">odp_packet_to_event_multi</a>(pkts, evs, ret);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t send(<span class="keyword">const</span> pktio_t *pktio, uint8_t index, <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret = <a name="a128"></a><a class="code" href="group__odp__packet__io.html#gacb5db3a908775522e316c8b8ccb36498">odp_pktout_send</a>(pktio-&gt;out_dir_qs[index], pkts, num);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret &lt; 0 ? 0U : (uint32_t)ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint32_t enqueue(<span class="keyword">const</span> pktio_t *pktio, uint8_t index, <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkts[], <span class="keywordtype">int</span> num)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> evs[MAX_BURST];</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__packet.html#ga229f5a60b69678c472b6b75dcf443dfe">odp_packet_to_event_multi</a>(pkts, evs, num);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a129"></a><a class="code" href="group__odp__queue.html#ga6b3ef7c0d52f9dd31e534b9cf17eb218">odp_queue_enq_multi</a>(pktio-&gt;out_ev_qs[index], evs, num);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret &lt; 0 ? 0U : (uint32_t)ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> setup_pktios(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a name="_a130"></a><a class="code" href="structodp__pool__param__t.html">odp_pool_param_t</a> pool_param;</div>
<div class="line">    pktio_t *pktio;</div>
<div class="line">    <a name="_a131"></a><a class="code" href="structodp__pktio__param__t.html">odp_pktio_param_t</a> pktio_param;</div>
<div class="line">    <a name="_a132"></a><a class="code" href="structodp__pktin__queue__param__t.html">odp_pktin_queue_param_t</a> pktin_param;</div>
<div class="line">    <a name="_a133"></a><a class="code" href="structodp__pktio__capability__t.html">odp_pktio_capability_t</a> capa;</div>
<div class="line">    <a name="_a134"></a><a class="code" href="structodp__pktout__queue__param__t.html">odp_pktout_queue_param_t</a> pktout_param;</div>
<div class="line">    <a name="_a135"></a><a class="code" href="structodp__pktio__config__t.html">odp_pktio_config_t</a> pktio_config;</div>
<div class="line">    uint32_t max_output_qs;</div>
<div class="line"> </div>
<div class="line">    <a name="a136"></a><a class="code" href="group__odp__pool.html#ga3dd8bcfb920f81142e9fe27cfba24073">odp_pool_param_init</a>(&amp;pool_param);</div>
<div class="line">    pool_param.<a name="a137"></a><a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a name="a138"></a><a class="code" href="structodp__pool__param__t.html#ad400db5955445ee3d1fbb36df456e7f1">seg_len</a> = config-&gt;pkt_len;</div>
<div class="line">    pool_param.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a name="a139"></a><a class="code" href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">len</a> = config-&gt;pkt_len;</div>
<div class="line">    pool_param.<a class="code" href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">pkt</a>.<a name="a140"></a><a class="code" href="structodp__pool__param__t.html#a3598b3a2496629cd45010c1c5e876250">num</a> = config-&gt;num_pkts;</div>
<div class="line">    pool_param.<a name="a141"></a><a class="code" href="structodp__pool__param__t.html#aac72ae142dd9736a287ce63d78b71c87">type</a> = <a name="a142"></a><a class="code" href="group__odp__pool.html#ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd">ODP_POOL_PACKET</a>;</div>
<div class="line">    config-&gt;pktio_pool = <a name="a143"></a><a class="code" href="group__odp__pool.html#ga256909a276600c25ce11b52ae274632f">odp_pool_create</a>(PROG_NAME, &amp;pool_param);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;pktio_pool == <a class="code" href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a>) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error creating packet I/O pool\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    config-&gt;ops.rx = !config-&gt;is_dir_rx ? schedule : recv;</div>
<div class="line">    config-&gt;is_hashed_tx = !config-&gt;is_dir_rx &amp;&amp; config-&gt;mode == ORDERED;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_ifs; ++i) {</div>
<div class="line">        pktio = &amp;config-&gt;pktios[i];</div>
<div class="line">        pktio-&gt;idx = i;</div>
<div class="line">        <a name="a144"></a><a class="code" href="group__odp__packet__io.html#ga26d165a22d659770eba0c48543860881">odp_pktio_param_init</a>(&amp;pktio_param);</div>
<div class="line">        pktio_param.<a name="a145"></a><a class="code" href="structodp__pktio__param__t.html#a819cf5e2ef7df43a729cad159c022f4d">in_mode</a> = !config-&gt;is_dir_rx ?</div>
<div class="line">            <a name="a146"></a><a class="code" href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8faa4f62db7acbe492a3b80f3f782a04dd5">ODP_PKTIN_MODE_SCHED</a> : <a name="a147"></a><a class="code" href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8fa36f229784bc7dcef48203b02b3938357">ODP_PKTIN_MODE_DIRECT</a>;</div>
<div class="line">        pktio_param.<a name="a148"></a><a class="code" href="structodp__pktio__param__t.html#afc226fd3904618950a0d1154ffa2fd8c">out_mode</a> = config-&gt;is_hashed_tx ?</div>
<div class="line">            <a name="a149"></a><a class="code" href="group__odp__packet__io.html#gga4e0c26e40b1166b07142302d12e8467dae90395ccf6ce924a3a6cb375ca42f279">ODP_PKTOUT_MODE_QUEUE</a> : <a name="a150"></a><a class="code" href="group__odp__packet__io.html#gga4e0c26e40b1166b07142302d12e8467da9e6184e8d605ce199cfa54d6c50153ff">ODP_PKTOUT_MODE_DIRECT</a>;</div>
<div class="line">        pktio-&gt;handle = <a name="a151"></a><a class="code" href="group__odp__packet__io.html#ga7ae4f96ab09d468fff3623d90db306f9">odp_pktio_open</a>(pktio-&gt;name, config-&gt;pktio_pool, &amp;pktio_param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (pktio-&gt;handle == <a name="a152"></a><a class="code" href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a>) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error opening packet I/O (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a153"></a><a class="code" href="group__odp__packet__io.html#gaba80778db7ec138977ed9e473bd1faaa">odp_pktio_capability</a>(pktio-&gt;handle, &amp;capa) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error querying packet I/O capabilities (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;num_input_qs == 0U || config-&gt;num_input_qs &gt; capa.<a name="a154"></a><a class="code" href="structodp__pktio__capability__t.html#a41331b30786ec8c9a4861dfe5b220b61">max_input_queues</a>) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Invalid number of input queues for packet I/O: %u (min: 1, max: &quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;%u) (%s)\n&quot;</span>, config-&gt;num_input_qs, capa.<a class="code" href="structodp__pktio__capability__t.html#a41331b30786ec8c9a4861dfe5b220b61">max_input_queues</a>,</div>
<div class="line">                 pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        max_output_qs = ODPH_MIN(MAX_QUEUES, capa.<a name="a155"></a><a class="code" href="structodp__pktio__capability__t.html#a853625a680b37aeb0839c63ba04c632c">max_output_queues</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;num_output_qs == 0U || config-&gt;num_output_qs &gt; max_output_qs) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Invalid number of output queues for packet I/O: %u (min: 1, &quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;max: %u) (%s)\n&quot;</span>, config-&gt;num_output_qs, max_output_qs,</div>
<div class="line">                 pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a name="a156"></a><a class="code" href="group__odp__packet__io.html#ga055eabf5622e6745afbe9a1550ad1d78">odp_pktin_queue_param_init</a>(&amp;pktin_param);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;is_hashed_tx)</div>
<div class="line">            pktin_param.<a name="a157"></a><a class="code" href="structodp__pktin__queue__param__t.html#a5a07d5e93f26a523103360c0bea4a304">queue_param</a>.<a class="code" href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">sched</a>.<a class="code" href="structodp__schedule__param__t.html#ad4ca09d63edb0cec36567c26688cea14">sync</a> = <a class="code" href="group__odp__scheduler.html#ga4df3696ebf4528ecc6e69ae3fff040fd">ODP_SCHED_SYNC_ORDERED</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;num_input_qs &gt; 1U) {</div>
<div class="line">            pktin_param.<a name="a158"></a><a class="code" href="structodp__pktin__queue__param__t.html#aa90bfc914603a90f7b1f7e7f0de07418">hash_enable</a> = <span class="keyword">true</span>;</div>
<div class="line">            pktin_param.<a name="a159"></a><a class="code" href="structodp__pktin__queue__param__t.html#a901146fbd15779b5665d3b75f3488e91">hash_proto</a>.<a name="a160"></a><a class="code" href="unionodp__pktin__hash__proto__t.html#a23793296c3a0299f69bdacc438ca3caf">proto</a>.<a name="a161"></a><a class="code" href="unionodp__pktin__hash__proto__t.html#a55c2478785f04914939ed859bdc16839">ipv4_udp</a> = 1U;</div>
<div class="line">            pktin_param.<a name="a162"></a><a class="code" href="structodp__pktin__queue__param__t.html#a03e94f43a2e4379d7a16adb964a55ecd">num_queues</a> = config-&gt;num_input_qs;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        pktin_param.<a name="a163"></a><a class="code" href="structodp__pktin__queue__param__t.html#a1a15c51c24187f0f12e6482761ceb553">op_mode</a> = (config-&gt;is_dir_rx &amp;&amp;</div>
<div class="line">                       config-&gt;num_thrs &gt; (int)config-&gt;num_input_qs) ?</div>
<div class="line">                        <a name="a164"></a><a class="code" href="group__odp__packet__io.html#ggacf2c32e76d9d0eef9106b5fdd68cedc8af3637232af55eb954ba439b2d33120d3">ODP_PKTIO_OP_MT</a> : <a name="a165"></a><a class="code" href="group__odp__packet__io.html#ggacf2c32e76d9d0eef9106b5fdd68cedc8a1e3d825b302ee6213937172a6b54b140">ODP_PKTIO_OP_MT_UNSAFE</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a166"></a><a class="code" href="group__odp__packet__io.html#gaf9dce6b2cc13ad715e777416dce88194">odp_pktin_queue_config</a>(pktio-&gt;handle, &amp;pktin_param) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error configuring packet I/O input queues (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;is_dir_rx) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a167"></a><a class="code" href="group__odp__packet__io.html#gaa9d5cad745c9744ce026412ccf33d019">odp_pktin_queue</a>(pktio-&gt;handle, pktio-&gt;in_dir_qs, config-&gt;num_input_qs)</div>
<div class="line">                != (<span class="keywordtype">int</span>)config-&gt;num_input_qs) {</div>
<div class="line">                ODPH_ERR(<span class="stringliteral">&quot;Error querying packet I/O input queue (%s)\n&quot;</span>,</div>
<div class="line">                     pktio-&gt;name);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        pktio-&gt;send_fn = config-&gt;is_hashed_tx ? enqueue : send;</div>
<div class="line">        pktio-&gt;num_tx_qs = config-&gt;num_output_qs;</div>
<div class="line">        <a name="a168"></a><a class="code" href="group__odp__packet__io.html#gab09475da05438a53b2d0fca96aab7515">odp_pktout_queue_param_init</a>(&amp;pktout_param);</div>
<div class="line">        pktout_param.<a name="a169"></a><a class="code" href="structodp__pktout__queue__param__t.html#acd16e77991869797adb3da1bd41a1d0c">num_queues</a> = pktio-&gt;num_tx_qs;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!config-&gt;is_hashed_tx) {</div>
<div class="line">            pktout_param.<a name="a170"></a><a class="code" href="structodp__pktout__queue__param__t.html#a066fd0a2de0efca0056cd1529d78b06e">op_mode</a> = config-&gt;num_thrs &gt; (int)pktio-&gt;num_tx_qs ?</div>
<div class="line">                <a class="code" href="group__odp__packet__io.html#ggacf2c32e76d9d0eef9106b5fdd68cedc8af3637232af55eb954ba439b2d33120d3">ODP_PKTIO_OP_MT</a> : <a class="code" href="group__odp__packet__io.html#ggacf2c32e76d9d0eef9106b5fdd68cedc8a1e3d825b302ee6213937172a6b54b140">ODP_PKTIO_OP_MT_UNSAFE</a>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a171"></a><a class="code" href="group__odp__packet__io.html#gafc2120185a8da74540feade78623f3b3">odp_pktout_queue_config</a>(pktio-&gt;handle, &amp;pktout_param) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error configuring packet I/O output queues (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;is_hashed_tx) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a172"></a><a class="code" href="group__odp__packet__io.html#gab2089a43d1901927c000bc43af3b6a2b">odp_pktout_event_queue</a>(pktio-&gt;handle, pktio-&gt;out_ev_qs,</div>
<div class="line">                           pktio-&gt;num_tx_qs) != (<span class="keywordtype">int</span>)pktio-&gt;num_tx_qs) {</div>
<div class="line">                ODPH_ERR(<span class="stringliteral">&quot;Error querying packet I/O output event queue (%s)\n&quot;</span>,</div>
<div class="line">                     pktio-&gt;name);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a173"></a><a class="code" href="group__odp__packet__io.html#ga41a3ebb7ac489b85a5f7560e4d4f77f5">odp_pktout_queue</a>(pktio-&gt;handle, pktio-&gt;out_dir_qs, pktio-&gt;num_tx_qs)</div>
<div class="line">                != (<span class="keywordtype">int</span>)pktio-&gt;num_tx_qs) {</div>
<div class="line">                ODPH_ERR(<span class="stringliteral">&quot;Error querying packet I/O output queue (%s)\n&quot;</span>,</div>
<div class="line">                     pktio-&gt;name);</div>
<div class="line">                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a name="a174"></a><a class="code" href="group__odp__packet__io.html#ga6a1c262ef999e8a73ac107c182b67d33">odp_pktio_config_init</a>(&amp;pktio_config);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a175"></a><a class="code" href="group__odp__packet__io.html#ga7f9faaf250d3d0d87478ff9f13680bf1">odp_pktio_config</a>(pktio-&gt;handle, &amp;pktio_config) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error configuring packet I/O extra options (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a176"></a><a class="code" href="group__odp__packet__io.html#ga04d67c951aff803cf718940e0783ef8f">odp_pktio_mac_addr</a>(pktio-&gt;handle, &amp;pktio-&gt;src_mac, <span class="keyword">sizeof</span>(pktio-&gt;src_mac))</div>
<div class="line">            != <span class="keyword">sizeof</span>(pktio-&gt;src_mac)) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error getting packet I/O MAC address (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a177"></a><a class="code" href="group__odp__packet__io.html#ga9a5746e73616297fabb8d4caaa6d0333">odp_pktio_start</a>(pktio-&gt;handle) &lt; 0) {</div>
<div class="line">            ODPH_ERR(<span class="stringliteral">&quot;Error starting packet I/O (%s)\n&quot;</span>, pktio-&gt;name);</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> check_ipsec_status_ev(<a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> ev, stats_t *stats)</div>
<div class="line">{</div>
<div class="line">    <a name="_a178"></a><a class="code" href="structodp__ipsec__status__t.html">odp_ipsec_status_t</a> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a>(<a name="a179"></a><a class="code" href="group__odp__ipsec.html#gab81f2a38a01fc4ac01fb59dc73351a43">odp_ipsec_status</a>(&amp;status, ev) &lt; 0 || status.<a name="a180"></a><a class="code" href="structodp__ipsec__status__t.html#a0c1bbbaad463b5b4079adb1e4e761689">result</a> &lt; 0))</div>
<div class="line">        ++stats-&gt;status_errs;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> process_packets(<span class="keywordtype">void</span> *args)</div>
<div class="line">{</div>
<div class="line">    thread_config_t *config = args;</div>
<div class="line">    <span class="keywordtype">int</span> thr_idx = <a name="a181"></a><a class="code" href="group__odp__thread.html#gad6562e7320d48463715bbf15748ae360">odp_thread_id</a>();</div>
<div class="line">    <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> evs[MAX_BURST], ev;</div>
<div class="line">    ops_t ops = config-&gt;prog_config-&gt;ops;</div>
<div class="line">    <a class="code" href="structodp__atomic__u32__s.html">odp_atomic_u32_t</a> *is_running = &amp;config-&gt;prog_config-&gt;is_running;</div>
<div class="line">    uint32_t cnt;</div>
<div class="line">    <a class="code" href="group__odp__event.html#gaa1aaa409bc6ae09aab02e74c3df3860c">odp_event_type_t</a> type;</div>
<div class="line">    <a class="code" href="group__odp__event.html#ga8b1714719c72de90c54a2aba621d725e">odp_event_subtype_t</a> subtype;</div>
<div class="line">    <a class="code" href="struct__odp__abi__packet__t.html">odp_packet_t</a> pkt, pkts_in[MAX_BURST], pkts_ips[MAX_BURST];</div>
<div class="line">    lookup_table_t *fwd_tbl = &amp;config-&gt;prog_config-&gt;fwd_tbl;</div>
<div class="line">    stats_t *stats = &amp;config-&gt;stats;</div>
<div class="line"> </div>
<div class="line">    ifs.is_hashed_tx = config-&gt;prog_config-&gt;is_hashed_tx;</div>
<div class="line">    ifs.q_idx = thr_idx % config-&gt;prog_config-&gt;num_output_qs;</div>
<div class="line">    config-&gt;thr_idx = thr_idx;</div>
<div class="line">    <a name="a182"></a><a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;config-&gt;prog_config-&gt;init_barrier);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a name="a183"></a><a class="code" href="group__odp__atomic.html#ga1ebc0fa6d690c24bd2bcc38bcb9a2276">odp_atomic_load_u32</a>(is_running)) {</div>
<div class="line">        <span class="keywordtype">int</span> num_pkts_in = 0, num_pkts_ips = 0;</div>
<div class="line">        <span class="comment">/* TODO: Add possibility to configure scheduler and ipsec enq/deq burst sizes. */</span></div>
<div class="line">        cnt = ops.rx(config, evs, MAX_BURST);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (cnt == 0U)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; cnt; ++i) {</div>
<div class="line">            ev = evs[i];</div>
<div class="line">            type = <a name="a184"></a><a class="code" href="group__odp__event.html#gacb824769f055819f9e6954e0e7041839">odp_event_types</a>(ev, &amp;subtype);</div>
<div class="line">            pkt = <a name="a185"></a><a class="code" href="group__odp__packet.html#ga8605e7d4629a479f7b1a59da121c601c">odp_packet_from_event</a>(ev);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (type == ODP_EVENT_PACKET) {</div>
<div class="line">                <span class="keywordflow">if</span> (subtype == ODP_EVENT_PACKET_BASIC) {</div>
<div class="line">                    pkts_in[num_pkts_in++] = pkt;</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subtype == ODP_EVENT_PACKET_IPSEC) {</div>
<div class="line">                    pkts_ips[num_pkts_ips++] = pkt;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    ++stats-&gt;discards;</div>
<div class="line">                    <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == ODP_EVENT_IPSEC_STATUS) {</div>
<div class="line">                check_ipsec_status_ev(ev, stats);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                ++stats-&gt;discards;</div>
<div class="line">                <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (num_pkts_in &gt; 0)</div>
<div class="line">            ops.proc(pkts_in, num_pkts_in, fwd_tbl, stats);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ops.compl &amp;&amp; num_pkts_ips &gt; 0)</div>
<div class="line">            ops.compl(pkts_ips, num_pkts_ips, fwd_tbl, stats);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;config-&gt;prog_config-&gt;term_barrier);</div>
<div class="line">    ops.drain(config-&gt;prog_config);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> setup_workers(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    odph_thread_common_param_t thr_common;</div>
<div class="line">    odph_thread_param_t thr_param[config-&gt;num_thrs];</div>
<div class="line">    <a name="_a186"></a><a class="code" href="structodp__cpumask__s.html">odp_cpumask_t</a> cpumask;</div>
<div class="line">    <span class="keywordtype">int</span> num_workers;</div>
<div class="line"> </div>
<div class="line">    num_workers = <a name="a187"></a><a class="code" href="group__odp__cpumask.html#ga4ff2d29f52775b12c7df1995754b524d">odp_cpumask_default_worker</a>(&amp;cpumask, config-&gt;num_thrs);</div>
<div class="line">    odph_thread_common_param_init(&amp;thr_common);</div>
<div class="line">    thr_common.instance = config-&gt;odp_instance;</div>
<div class="line">    thr_common.cpumask = &amp;cpumask;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; config-&gt;num_thrs; ++i) {</div>
<div class="line">        odph_thread_param_init(&amp;thr_param[i]);</div>
<div class="line">        thr_param[i].start = process_packets;</div>
<div class="line">        thr_param[i].thr_type = <a name="a188"></a><a class="code" href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a">ODP_THREAD_WORKER</a>;</div>
<div class="line">        config-&gt;thread_config[i].prog_config = config;</div>
<div class="line">        thr_param[i].arg = &amp;config-&gt;thread_config[i];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    num_workers = odph_thread_create(config-&gt;thread_tbl, &amp;thr_common, thr_param, num_workers);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (num_workers != config-&gt;num_thrs) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error configuring worker threads\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code" href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a> setup_test(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <a name="a189"></a><a class="code" href="group__odp__barrier.html#ga1416b47755c2af6267074959ac0d4840">odp_barrier_init</a>(&amp;config-&gt;init_barrier, config-&gt;num_thrs + 1);</div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga1416b47755c2af6267074959ac0d4840">odp_barrier_init</a>(&amp;config-&gt;term_barrier, config-&gt;num_thrs + 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!setup_pktios(config))</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!setup_workers(config))</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;config-&gt;init_barrier);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> stop_test(prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_ifs; ++i)</div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;pktios[i].handle != <a class="code" href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a>)</div>
<div class="line">            (void)<a name="a190"></a><a class="code" href="group__odp__packet__io.html#gab34cb9679bf99d1b3366f06a9b155c41">odp_pktio_stop</a>(config-&gt;pktios[i].handle);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a>(&amp;config-&gt;term_barrier);</div>
<div class="line">    (void)odph_thread_join(config-&gt;thread_tbl, config-&gt;num_thrs);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> print_stats(<span class="keyword">const</span> prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> stats_t *stats;</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\n====================\n\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;IPsec forwarder done\n\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;    configuration file: %s\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;    queuing mode:       %s\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;    input queue count:  %u\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;    SA queue count:     %u\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;    output queue count: %u\n&quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;    RX mode:            %s\n&quot;</span>, config-&gt;conf_file,</div>
<div class="line">           config-&gt;mode == ORDERED ? <span class="stringliteral">&quot;ordered&quot;</span> : <span class="stringliteral">&quot;parallel&quot;</span>, config-&gt;num_input_qs,</div>
<div class="line">           config-&gt;num_sa_qs, config-&gt;num_output_qs,</div>
<div class="line">           config-&gt;is_dir_rx ? <span class="stringliteral">&quot;direct&quot;</span> : <span class="stringliteral">&quot;scheduled&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; config-&gt;num_thrs; ++i) {</div>
<div class="line">        stats = &amp;config-&gt;thread_config[i].stats;</div>
<div class="line"> </div>
<div class="line">        printf(<span class="stringliteral">&quot;\n    worker %d:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        IPsec in packets:        %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        IPsec out packets:       %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        IPsec in packet errors:  %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        IPsec out packet errors: %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        IPsec status errors:     %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        packets forwarded:       %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;        packets dropped:         %&quot;</span> PRIu64 <span class="stringliteral">&quot;\n&quot;</span>, i, stats-&gt;ipsec_in_pkts,</div>
<div class="line">        stats-&gt;ipsec_out_pkts, stats-&gt;ipsec_in_errs, stats-&gt;ipsec_out_errs,</div>
<div class="line">        stats-&gt;status_errs, stats-&gt;fwd_pkts, stats-&gt;discards);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;\n====================\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> wait_sas_disabled(uint32_t num_sas)</div>
<div class="line">{</div>
<div class="line">    uint32_t num_sas_dis = 0U;</div>
<div class="line">    <a class="code" href="struct__odp__abi__event__t.html">odp_event_t</a> ev;</div>
<div class="line">    <a class="code" href="structodp__ipsec__status__t.html">odp_ipsec_status_t</a> status;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (num_sas_dis &lt; num_sas) {</div>
<div class="line">        ev = <a class="code" href="group__odp__scheduler.html#gae4ca1012ebb16ff8b9752b958dc45ce6">odp_schedule</a>(NULL, <a class="code" href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ev == <a class="code" href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a>)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a191"></a><a class="code" href="group__odp__event.html#ga4bd59cdf228fe0c36b8e04fe122e047a">odp_event_type</a>(ev) != ODP_EVENT_IPSEC_STATUS) {</div>
<div class="line">            <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group__odp__ipsec.html#gab81f2a38a01fc4ac01fb59dc73351a43">odp_ipsec_status</a>(&amp;status, ev) &lt; 0) {</div>
<div class="line">            <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (status.<a name="a192"></a><a class="code" href="structodp__ipsec__status__t.html#aeea7b89a23b3f2342eca6eff2860176e">id</a> == <a name="a193"></a><a class="code" href="group__odp__ipsec.html#gga6cd8d0662643f62d9663a927e0bb8123ab34f400b50ac3abbc96a2d659a0d26f4">ODP_IPSEC_STATUS_SA_DISABLE</a>)</div>
<div class="line">            ++num_sas_dis;</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a>(ev);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> teardown_test(<span class="keyword">const</span> prog_config_t *config)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_ifs; ++i) {</div>
<div class="line">        free(config-&gt;pktios[i].name);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (config-&gt;pktios[i].handle != <a class="code" href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a>)</div>
<div class="line">            (void)<a name="a194"></a><a class="code" href="group__odp__packet__io.html#ga2e481c9f2f073cc337aff7f4c65cba7c">odp_pktio_close</a>(config-&gt;pktios[i].handle);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;pktio_pool != <a class="code" href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a>)</div>
<div class="line">        (void)<a name="a195"></a><a class="code" href="group__odp__pool.html#ga6ad439aaef911d82b972c915850e6924">odp_pool_destroy</a>(config-&gt;pktio_pool);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_sas; ++i)</div>
<div class="line">        (<span class="keywordtype">void</span>)<a name="a196"></a><a class="code" href="group__odp__ipsec.html#gaab44f5e8991e133f4979aee70223b314">odp_ipsec_sa_disable</a>(config-&gt;sas[i]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!config-&gt;is_dir_rx)</div>
<div class="line">        <span class="comment">/* Drain SA status events. */</span></div>
<div class="line">        wait_sas_disabled(config-&gt;num_sas);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_sas; ++i)</div>
<div class="line">        (<span class="keywordtype">void</span>)<a name="a197"></a><a class="code" href="group__odp__ipsec.html#gafd3b04ba7862bf42749911fe54cd29d1">odp_ipsec_sa_destroy</a>(config-&gt;sas[i]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0U; i &lt; config-&gt;num_sa_qs; ++i)</div>
<div class="line">        (<span class="keywordtype">void</span>)<a name="a198"></a><a class="code" href="group__odp__queue.html#gad1e1d2709808385025dd5f005f7690c4">odp_queue_destroy</a>(config-&gt;sa_qs[i]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (config-&gt;compl_q != <a class="code" href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a>)</div>
<div class="line">        (void)<a class="code" href="group__odp__queue.html#gad1e1d2709808385025dd5f005f7690c4">odp_queue_destroy</a>(config-&gt;compl_q);</div>
<div class="line"> </div>
<div class="line">    free(config-&gt;conf_file);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    odph_helper_options_t odph_opts;</div>
<div class="line">    <a name="_a199"></a><a class="code" href="structodp__init__t.html">odp_init_t</a> init_param;</div>
<div class="line">    <a class="code" href="group__odp__initialization.html#ga8d362bd3c7c87ab5892ca63b15c375c0">odp_instance_t</a> <a class="code" href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a>;</div>
<div class="line">    <a name="_a200"></a><a class="code" href="struct__odp__abi__shm__t.html">odp_shm_t</a> shm_cfg = <a name="a201"></a><a class="code" href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a>;</div>
<div class="line">    parse_result_t parse_res;</div>
<div class="line">    <span class="keywordtype">int</span> ret = EXIT_SUCCESS;</div>
<div class="line"> </div>
<div class="line">    argc = odph_parse_options(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (odph_options(&amp;odph_opts) == -1) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error while reading ODP helper options, exiting\n&quot;</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a name="a202"></a><a class="code" href="group__odp__initialization.html#ga145c4fc4417c8f58efd0852b34e25ba9">odp_init_param_init</a>(&amp;init_param);</div>
<div class="line">    init_param.<a name="a203"></a><a class="code" href="structodp__init__t.html#a7d368c740146170ebeb1651ce049919e">mem_model</a> = odph_opts.mem_model;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a204"></a><a class="code" href="group__odp__initialization.html#ga68d81088e65ef66180fb51076905e34d">odp_init_global</a>(&amp;<a class="code" href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a>, &amp;init_param, NULL) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;ODP global init failed, exiting\n&quot;</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a205"></a><a class="code" href="group__odp__initialization.html#ga265470ea614bfeca9d8901e81ddefca9">odp_init_local</a>(<a class="code" href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a>, <a name="a206"></a><a class="code" href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a9aab3fdb10eb2000a864bff81f23c00a">ODP_THREAD_CONTROL</a>) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;ODP local init failed, exiting\n&quot;</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    shm_cfg = <a name="a207"></a><a class="code" href="group__odp__shared__memory.html#gacc441b0e100ec1c54e21f1745939a2d8">odp_shm_reserve</a>(PROG_NAME <span class="stringliteral">&quot;_cfg&quot;</span>, <span class="keyword">sizeof</span>(prog_config_t), ODP_CACHE_LINE_SIZE,</div>
<div class="line">                  0U);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (shm_cfg == <a class="code" href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a>) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error reserving shared memory\n&quot;</span>);</div>
<div class="line">        ret = EXIT_FAILURE;</div>
<div class="line">        <span class="keywordflow">goto</span> out;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    prog_conf = <a name="a208"></a><a class="code" href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a>(shm_cfg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (prog_conf == NULL) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error resolving shared memory address\n&quot;</span>);</div>
<div class="line">        ret = EXIT_FAILURE;</div>
<div class="line">        <span class="keywordflow">goto</span> out;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    init_config(prog_conf);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!prog_conf-&gt;is_dir_rx &amp;&amp; <a name="a209"></a><a class="code" href="group__odp__scheduler.html#gaa1b51ebd46adeb6aa7805fccb00144df">odp_schedule_config</a>(NULL) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;Error configuring scheduler\n&quot;</span>);</div>
<div class="line">        ret = EXIT_FAILURE;</div>
<div class="line">        <span class="keywordflow">goto</span> out_test;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    parse_res = setup_program(argc, argv, prog_conf);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parse_res == PRS_NOK) {</div>
<div class="line">        ret = EXIT_FAILURE;</div>
<div class="line">        <span class="keywordflow">goto</span> out_test;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (parse_res == PRS_TERM) {</div>
<div class="line">        ret = EXIT_SUCCESS;</div>
<div class="line">        <span class="keywordflow">goto</span> out_test;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    prog_conf-&gt;odp_instance = <a class="code" href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a>;</div>
<div class="line">    <a name="a210"></a><a class="code" href="group__odp__atomic.html#ga0029015adacaadb06ee94ea67d00eece">odp_atomic_init_u32</a>(&amp;prog_conf-&gt;is_running, 1U);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!setup_test(prog_conf)) {</div>
<div class="line">        ret = EXIT_FAILURE;</div>
<div class="line">        <span class="keywordflow">goto</span> out_test;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="group__odp__atomic.html#ga1ebc0fa6d690c24bd2bcc38bcb9a2276">odp_atomic_load_u32</a>(&amp;prog_conf-&gt;is_running))</div>
<div class="line">        <a name="a211"></a><a class="code" href="group__odp__cpu.html#ga0f5cb06705b8ba8297f6f21f0cd7805d">odp_cpu_pause</a>();</div>
<div class="line"> </div>
<div class="line">    stop_test(prog_conf);</div>
<div class="line">    print_stats(prog_conf);</div>
<div class="line"> </div>
<div class="line">out_test:</div>
<div class="line">    teardown_test(prog_conf);</div>
<div class="line"> </div>
<div class="line">out:</div>
<div class="line">    <span class="keywordflow">if</span> (shm_cfg != <a class="code" href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a>)</div>
<div class="line">        (void)<a name="a212"></a><a class="code" href="group__odp__shared__memory.html#ga0b02991b512acc119206b44c95a86ed6">odp_shm_free</a>(shm_cfg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a213"></a><a class="code" href="group__odp__initialization.html#ga6d15f0e1718da9477948dedb06a2f01a">odp_term_local</a>() &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;ODP local terminate failed, exiting\n&quot;</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a214"></a><a class="code" href="group__odp__initialization.html#ga87e9c66ad92201c9e0a710294eab1569">odp_term_global</a>(<a class="code" href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a>) &lt; 0) {</div>
<div class="line">        ODPH_ERR(<span class="stringliteral">&quot;ODP global terminate failed, exiting\n&quot;</span>);</div>
<div class="line">        exit(EXIT_FAILURE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__odp__atomic_html_ga0029015adacaadb06ee94ea67d00eece"><div class="ttname"><a href="group__odp__atomic.html#ga0029015adacaadb06ee94ea67d00eece">odp_atomic_init_u32</a></div><div class="ttdeci">void odp_atomic_init_u32(odp_atomic_u32_t *atom, uint32_t val)</div><div class="ttdoc">Initialize atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__atomic_html_ga1ebc0fa6d690c24bd2bcc38bcb9a2276"><div class="ttname"><a href="group__odp__atomic.html#ga1ebc0fa6d690c24bd2bcc38bcb9a2276">odp_atomic_load_u32</a></div><div class="ttdeci">uint32_t odp_atomic_load_u32(odp_atomic_u32_t *atom)</div><div class="ttdoc">Load value of atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__atomic_html_gaa6d2d16a9ef9897b1442d77e41f7101e"><div class="ttname"><a href="group__odp__atomic.html#gaa6d2d16a9ef9897b1442d77e41f7101e">odp_atomic_store_u32</a></div><div class="ttdeci">void odp_atomic_store_u32(odp_atomic_u32_t *atom, uint32_t val)</div><div class="ttdoc">Store value to atomic uint32 variable.</div></div>
<div class="ttc" id="agroup__odp__barrier_html_ga1416b47755c2af6267074959ac0d4840"><div class="ttname"><a href="group__odp__barrier.html#ga1416b47755c2af6267074959ac0d4840">odp_barrier_init</a></div><div class="ttdeci">void odp_barrier_init(odp_barrier_t *barr, int count)</div><div class="ttdoc">Initialize barrier with thread count.</div></div>
<div class="ttc" id="agroup__odp__barrier_html_ga97c8f84490e816330f96155acf0b4b77"><div class="ttname"><a href="group__odp__barrier.html#ga97c8f84490e816330f96155acf0b4b77">odp_barrier_wait</a></div><div class="ttdeci">void odp_barrier_wait(odp_barrier_t *barr)</div><div class="ttdoc">Synchronize thread execution on barrier.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga205a8257879c02657e7c39ee7ad5e40a"><div class="ttname"><a href="group__odp__compiler__optim.html#ga205a8257879c02657e7c39ee7ad5e40a">ODP_ALIGNED_CACHE</a></div><div class="ttdeci">#define ODP_ALIGNED_CACHE</div><div class="ttdoc">Defines type/struct/variable to be cache line size aligned.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga2b29f27f12b751250b471aa9c14c57c8"><div class="ttname"><a href="group__odp__compiler__optim.html#ga2b29f27f12b751250b471aa9c14c57c8">odp_unlikely</a></div><div class="ttdeci">#define odp_unlikely(x)</div><div class="ttdoc">Branch unlikely taken.</div><div class="ttdef"><b>Definition:</b> <a href="spec_2hints_8h_source.html#l00064">spec/hints.h:64</a></div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga2b6519f1042fc82dd7361061f27a6fe1"><div class="ttname"><a href="group__odp__compiler__optim.html#ga2b6519f1042fc82dd7361061f27a6fe1">odp_u32be_t</a></div><div class="ttdeci">uint32_t odp_u32be_t</div><div class="ttdoc">unsigned 32bit big endian</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2byteorder_8h_source.html#l00055">api/abi-default/byteorder.h:55</a></div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga388e5edab224f1315443269a61d30617"><div class="ttname"><a href="group__odp__compiler__optim.html#ga388e5edab224f1315443269a61d30617">odp_cpu_to_be_16</a></div><div class="ttdeci">odp_u16be_t odp_cpu_to_be_16(uint16_t cpu16)</div><div class="ttdoc">Convert cpu native uint16_t to 16bit big endian.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga45a2684e38da3e71b300bc89de5d6b52"><div class="ttname"><a href="group__odp__compiler__optim.html#ga45a2684e38da3e71b300bc89de5d6b52">ODP_UNUSED</a></div><div class="ttdeci">#define ODP_UNUSED</div><div class="ttdoc">Intentionally unused variables of functions.</div><div class="ttdef"><b>Definition:</b> <a href="spec_2hints_8h_source.html#l00054">spec/hints.h:54</a></div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_ga7d5bfcf18bdad933a1c83ec581874534"><div class="ttname"><a href="group__odp__compiler__optim.html#ga7d5bfcf18bdad933a1c83ec581874534">odp_be_to_cpu_16</a></div><div class="ttdeci">uint16_t odp_be_to_cpu_16(odp_u16be_t be16)</div><div class="ttdoc">Convert 16bit big endian to cpu native uint16_t.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_gaa81eaf9fb95b261887270978a1da909b"><div class="ttname"><a href="group__odp__compiler__optim.html#gaa81eaf9fb95b261887270978a1da909b">odp_cpu_to_be_32</a></div><div class="ttdeci">odp_u32be_t odp_cpu_to_be_32(uint32_t cpu32)</div><div class="ttdoc">Convert cpu native uint32_t to 32bit big endian.</div></div>
<div class="ttc" id="agroup__odp__compiler__optim_html_gae9b272def3f1d5b9979f600183ea005a"><div class="ttname"><a href="group__odp__compiler__optim.html#gae9b272def3f1d5b9979f600183ea005a">odp_be_to_cpu_32</a></div><div class="ttdeci">uint32_t odp_be_to_cpu_32(odp_u32be_t be32)</div><div class="ttdoc">Convert 32bit big endian to cpu native uint32_t.</div></div>
<div class="ttc" id="agroup__odp__cpu_html_ga0f5cb06705b8ba8297f6f21f0cd7805d"><div class="ttname"><a href="group__odp__cpu.html#ga0f5cb06705b8ba8297f6f21f0cd7805d">odp_cpu_pause</a></div><div class="ttdeci">void odp_cpu_pause(void)</div><div class="ttdoc">Pause CPU execution for a short while.</div></div>
<div class="ttc" id="agroup__odp__cpumask_html_ga4ff2d29f52775b12c7df1995754b524d"><div class="ttname"><a href="group__odp__cpumask.html#ga4ff2d29f52775b12c7df1995754b524d">odp_cpumask_default_worker</a></div><div class="ttdeci">int odp_cpumask_default_worker(odp_cpumask_t *mask, int num)</div><div class="ttdoc">Default CPU mask for worker threads.</div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a5f97b9e25676e663bd26af74aca86627"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a5f97b9e25676e663bd26af74aca86627">ODP_CIPHER_ALG_AES_CCM</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_AES_CCM</div><div class="ttdoc">AES-CCM.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00106">api/spec/crypto_types.h:106</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a6614d21577549126b5dd2bd344adf5f4"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a6614d21577549126b5dd2bd344adf5f4">ODP_CIPHER_ALG_AES_ECB</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_AES_ECB</div><div class="ttdoc">AES with electronic codebook.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00081">api/spec/crypto_types.h:81</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a73b1017657dd9f6ba9884e6e61bc457a"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a73b1017657dd9f6ba9884e6e61bc457a">ODP_CIPHER_ALG_AES_CTR</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_AES_CTR</div><div class="ttdoc">AES with counter mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00078">api/spec/crypto_types.h:78</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a7be2e3156dac631c42e3721092055929"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a7be2e3156dac631c42e3721092055929">ODP_CIPHER_ALG_CHACHA20_POLY1305</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_CHACHA20_POLY1305</div><div class="ttdoc">ChaCha20-Poly1305.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00115">api/spec/crypto_types.h:115</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a801dc573225189febece00273710ba79"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a801dc573225189febece00273710ba79">ODP_CIPHER_ALG_AES_CBC</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_AES_CBC</div><div class="ttdoc">AES with cipher block chaining.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00075">api/spec/crypto_types.h:75</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a8aa3ec25d1e5b30bc778577e400573e4"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a8aa3ec25d1e5b30bc778577e400573e4">ODP_CIPHER_ALG_AES_GCM</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_AES_GCM</div><div class="ttdoc">AES-GCM.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00097">api/spec/crypto_types.h:97</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0a9ab3dbd31584c39a561b91d6ada2fe36"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0a9ab3dbd31584c39a561b91d6ada2fe36">ODP_CIPHER_ALG_3DES_CBC</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_3DES_CBC</div><div class="ttdoc">Triple DES with cipher block chaining.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00069">api/spec/crypto_types.h:69</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0aa8290d9fd54bd7a03018972146b11b20"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0aa8290d9fd54bd7a03018972146b11b20">ODP_CIPHER_ALG_DES</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_DES</div><div class="ttdoc">DES.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00066">api/spec/crypto_types.h:66</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga3c943d596daa203f2c71263ad4386ff0ac8c68b6ba7437f58342798b8b9321d49"><div class="ttname"><a href="group__odp__crypto.html#gga3c943d596daa203f2c71263ad4386ff0ac8c68b6ba7437f58342798b8b9321d49">ODP_CIPHER_ALG_NULL</a></div><div class="ttdeci">@ ODP_CIPHER_ALG_NULL</div><div class="ttdoc">No cipher algorithm specified.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00063">api/spec/crypto_types.h:63</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a0a41f178286956faefcdc8df92e0e2b7"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a0a41f178286956faefcdc8df92e0e2b7">ODP_AUTH_ALG_SHA384_HMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_SHA384_HMAC</div><div class="ttdoc">HMAC-SHA-384.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00248">api/spec/crypto_types.h:248</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a0b1a80997bf33e4621625ef998afa111"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a0b1a80997bf33e4621625ef998afa111">ODP_AUTH_ALG_CHACHA20_POLY1305</a></div><div class="ttdeci">@ ODP_AUTH_ALG_CHACHA20_POLY1305</div><div class="ttdoc">ChaCha20-Poly1305 AEAD.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00327">api/spec/crypto_types.h:327</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a15a53bfea20586ebcae401af08bc3d1b"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a15a53bfea20586ebcae401af08bc3d1b">ODP_AUTH_ALG_AES_CMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_AES_CMAC</div><div class="ttdoc">AES-CMAC.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00311">api/spec/crypto_types.h:311</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a281e7b97f84df04651af9ac14fe98bba"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a281e7b97f84df04651af9ac14fe98bba">ODP_AUTH_ALG_NULL</a></div><div class="ttdeci">@ ODP_AUTH_ALG_NULL</div><div class="ttdoc">No authentication algorithm specified.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00218">api/spec/crypto_types.h:218</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a39a395de232a6dbdb078339ab5542716"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a39a395de232a6dbdb078339ab5542716">ODP_AUTH_ALG_MD5_HMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_MD5_HMAC</div><div class="ttdoc">HMAC-MD5.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00224">api/spec/crypto_types.h:224</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a400d59810b98620d0ffed0693a29107f"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a400d59810b98620d0ffed0693a29107f">ODP_AUTH_ALG_SHA512_HMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_SHA512_HMAC</div><div class="ttdoc">HMAC-SHA-512.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00254">api/spec/crypto_types.h:254</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a40e96c842f6ca3f8b9525abbb94b1c56"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a40e96c842f6ca3f8b9525abbb94b1c56">ODP_AUTH_ALG_SHA1_HMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_SHA1_HMAC</div><div class="ttdoc">HMAC-SHA-1.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00230">api/spec/crypto_types.h:230</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a471e06564c891f9705f2dd28480ccabe"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a471e06564c891f9705f2dd28480ccabe">ODP_AUTH_ALG_SHA256_HMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_SHA256_HMAC</div><div class="ttdoc">HMAC-SHA-256.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00242">api/spec/crypto_types.h:242</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a940ea0a0ecd398ed2302c5f3577ded14"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a940ea0a0ecd398ed2302c5f3577ded14">ODP_AUTH_ALG_SHA224_HMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_SHA224_HMAC</div><div class="ttdoc">HMAC-SHA-224.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00236">api/spec/crypto_types.h:236</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982a954f1cc1eb2a7284beba842ad7a54982"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982a954f1cc1eb2a7284beba842ad7a54982">ODP_AUTH_ALG_AES_GMAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_AES_GMAC</div><div class="ttdoc">AES-GMAC.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00294">api/spec/crypto_types.h:294</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982aa50251618a82066c56c43d978f07a459"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982aa50251618a82066c56c43d978f07a459">ODP_AUTH_ALG_AES_XCBC_MAC</a></div><div class="ttdeci">@ ODP_AUTH_ALG_AES_XCBC_MAC</div><div class="ttdoc">AES-XCBC-MAC.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00318">api/spec/crypto_types.h:318</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982aaa2119d2578afa8def7ed3ae160394e8"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982aaa2119d2578afa8def7ed3ae160394e8">ODP_AUTH_ALG_AES_GCM</a></div><div class="ttdeci">@ ODP_AUTH_ALG_AES_GCM</div><div class="ttdoc">AES-GCM.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00275">api/spec/crypto_types.h:275</a></div></div>
<div class="ttc" id="agroup__odp__crypto_html_gga97ed3811136cd7888625a4973c416982ad5b8c5c3affbde282db4a33f1ece8d6a"><div class="ttname"><a href="group__odp__crypto.html#gga97ed3811136cd7888625a4973c416982ad5b8c5c3affbde282db4a33f1ece8d6a">ODP_AUTH_ALG_AES_CCM</a></div><div class="ttdeci">@ ODP_AUTH_ALG_AES_CCM</div><div class="ttdoc">AES-CCM.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00303">api/spec/crypto_types.h:303</a></div></div>
<div class="ttc" id="agroup__odp__event_html_ga1622f73356c325f625db747cb3badf8d"><div class="ttname"><a href="group__odp__event.html#ga1622f73356c325f625db747cb3badf8d">odp_event_free</a></div><div class="ttdeci">void odp_event_free(odp_event_t event)</div><div class="ttdoc">Free event.</div></div>
<div class="ttc" id="agroup__odp__event_html_ga4bd59cdf228fe0c36b8e04fe122e047a"><div class="ttname"><a href="group__odp__event.html#ga4bd59cdf228fe0c36b8e04fe122e047a">odp_event_type</a></div><div class="ttdeci">odp_event_type_t odp_event_type(odp_event_t event)</div><div class="ttdoc">Event type of an event.</div></div>
<div class="ttc" id="agroup__odp__event_html_ga8b1714719c72de90c54a2aba621d725e"><div class="ttname"><a href="group__odp__event.html#ga8b1714719c72de90c54a2aba621d725e">odp_event_subtype_t</a></div><div class="ttdeci">odp_event_subtype_t</div><div class="ttdoc">Event subtype.</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2event__types_8h_source.html#l00039">api/abi-default/event_types.h:39</a></div></div>
<div class="ttc" id="agroup__odp__event_html_gaa1aaa409bc6ae09aab02e74c3df3860c"><div class="ttname"><a href="group__odp__event.html#gaa1aaa409bc6ae09aab02e74c3df3860c">odp_event_type_t</a></div><div class="ttdeci">odp_event_type_t</div><div class="ttdoc">Event type.</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2event__types_8h_source.html#l00026">api/abi-default/event_types.h:26</a></div></div>
<div class="ttc" id="agroup__odp__event_html_gacb824769f055819f9e6954e0e7041839"><div class="ttname"><a href="group__odp__event.html#gacb824769f055819f9e6954e0e7041839">odp_event_types</a></div><div class="ttdeci">odp_event_type_t odp_event_types(odp_event_t event, odp_event_subtype_t *subtype)</div><div class="ttdoc">Event type and subtype of an event.</div></div>
<div class="ttc" id="agroup__odp__event_html_gae1a3732a534ba7a892fca38b824591b0"><div class="ttname"><a href="group__odp__event.html#gae1a3732a534ba7a892fca38b824591b0">ODP_EVENT_INVALID</a></div><div class="ttdeci">#define ODP_EVENT_INVALID</div><div class="ttdoc">Invalid event.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga076abe89a81ffb7a7ba46a912eca2166"><div class="ttname"><a href="group__odp__initialization.html#ga076abe89a81ffb7a7ba46a912eca2166">odp_instance</a></div><div class="ttdeci">int odp_instance(odp_instance_t *instance)</div><div class="ttdoc">Get instance handle.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga145c4fc4417c8f58efd0852b34e25ba9"><div class="ttname"><a href="group__odp__initialization.html#ga145c4fc4417c8f58efd0852b34e25ba9">odp_init_param_init</a></div><div class="ttdeci">void odp_init_param_init(odp_init_t *param)</div><div class="ttdoc">Initialize the odp_init_t to default values for all fields.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga265470ea614bfeca9d8901e81ddefca9"><div class="ttname"><a href="group__odp__initialization.html#ga265470ea614bfeca9d8901e81ddefca9">odp_init_local</a></div><div class="ttdeci">int odp_init_local(odp_instance_t instance, odp_thread_type_t thr_type)</div><div class="ttdoc">Thread local ODP initialization.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga68d81088e65ef66180fb51076905e34d"><div class="ttname"><a href="group__odp__initialization.html#ga68d81088e65ef66180fb51076905e34d">odp_init_global</a></div><div class="ttdeci">int odp_init_global(odp_instance_t *instance, const odp_init_t *params, const odp_platform_init_t *platform_params)</div><div class="ttdoc">Global ODP initialization.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga6d15f0e1718da9477948dedb06a2f01a"><div class="ttname"><a href="group__odp__initialization.html#ga6d15f0e1718da9477948dedb06a2f01a">odp_term_local</a></div><div class="ttdeci">int odp_term_local(void)</div><div class="ttdoc">Thread local ODP termination.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga87e9c66ad92201c9e0a710294eab1569"><div class="ttname"><a href="group__odp__initialization.html#ga87e9c66ad92201c9e0a710294eab1569">odp_term_global</a></div><div class="ttdeci">int odp_term_global(odp_instance_t instance)</div><div class="ttdoc">Global ODP termination.</div></div>
<div class="ttc" id="agroup__odp__initialization_html_ga8d362bd3c7c87ab5892ca63b15c375c0"><div class="ttname"><a href="group__odp__initialization.html#ga8d362bd3c7c87ab5892ca63b15c375c0">odp_instance_t</a></div><div class="ttdeci">uint64_t odp_instance_t</div><div class="ttdoc">ODP instance ID.</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2init_8h_source.html#l00031">api/abi-default/init.h:31</a></div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga02a3a799f7295c6ada8a6f50b71c79de"><div class="ttname"><a href="group__odp__ipsec.html#ga02a3a799f7295c6ada8a6f50b71c79de">odp_ipsec_in_enq</a></div><div class="ttdeci">int odp_ipsec_in_enq(const odp_packet_t pkt[], int num, const odp_ipsec_in_param_t *param)</div><div class="ttdoc">Inbound asynchronous IPSEC operation.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga0542160055a5dbd2974d33b10275d820"><div class="ttname"><a href="group__odp__ipsec.html#ga0542160055a5dbd2974d33b10275d820">odp_ipsec_in</a></div><div class="ttdeci">int odp_ipsec_in(const odp_packet_t pkt_in[], int num_in, odp_packet_t pkt_out[], int *num_out, const odp_ipsec_in_param_t *param)</div><div class="ttdoc">Inbound synchronous IPSEC operation.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga12a8fa1641f442de7c4b69dea8d0e774"><div class="ttname"><a href="group__odp__ipsec.html#ga12a8fa1641f442de7c4b69dea8d0e774">odp_ipsec_auth_capability</a></div><div class="ttdeci">int odp_ipsec_auth_capability(odp_auth_alg_t auth, odp_ipsec_auth_capability_t capa[], int num)</div><div class="ttdoc">Query supported IPSEC authentication algorithm capabilities.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga2199ba574b77edc06c1a341021a6f993"><div class="ttname"><a href="group__odp__ipsec.html#ga2199ba574b77edc06c1a341021a6f993">ODP_IPSEC_OK</a></div><div class="ttdeci">#define ODP_IPSEC_OK</div><div class="ttdoc">IPSEC operation status has no errors.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01104">api/spec/ipsec_types.h:1104</a></div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga2cf54f017249dde280072e48251d2d31"><div class="ttname"><a href="group__odp__ipsec.html#ga2cf54f017249dde280072e48251d2d31">odp_ipsec_capability</a></div><div class="ttdeci">int odp_ipsec_capability(odp_ipsec_capability_t *capa)</div><div class="ttdoc">Query IPSEC capabilities.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga3cbcf39eb43d44243f24fdb1739d82d5"><div class="ttname"><a href="group__odp__ipsec.html#ga3cbcf39eb43d44243f24fdb1739d82d5">odp_ipsec_out</a></div><div class="ttdeci">int odp_ipsec_out(const odp_packet_t pkt_in[], int num_in, odp_packet_t pkt_out[], int *num_out, const odp_ipsec_out_param_t *param)</div><div class="ttdoc">Outbound synchronous IPSEC operation.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga70943ba89e0a50a2c72332301f38054d"><div class="ttname"><a href="group__odp__ipsec.html#ga70943ba89e0a50a2c72332301f38054d">odp_ipsec_config_init</a></div><div class="ttdeci">void odp_ipsec_config_init(odp_ipsec_config_t *config)</div><div class="ttdoc">Initialize IPSEC configuration options.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga7289488ac8fa8def94e90ba9de1a8e8d"><div class="ttname"><a href="group__odp__ipsec.html#ga7289488ac8fa8def94e90ba9de1a8e8d">odp_ipsec_sa_param_init</a></div><div class="ttdeci">void odp_ipsec_sa_param_init(odp_ipsec_sa_param_t *param)</div><div class="ttdoc">Initialize IPSEC SA parameters.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_ga85cc7deadb7406d340b6597fe4b516cc"><div class="ttname"><a href="group__odp__ipsec.html#ga85cc7deadb7406d340b6597fe4b516cc">odp_ipsec_config</a></div><div class="ttdeci">int odp_ipsec_config(const odp_ipsec_config_t *config)</div><div class="ttdoc">Global IPSEC configuration.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gaab44f5e8991e133f4979aee70223b314"><div class="ttname"><a href="group__odp__ipsec.html#gaab44f5e8991e133f4979aee70223b314">odp_ipsec_sa_disable</a></div><div class="ttdeci">int odp_ipsec_sa_disable(odp_ipsec_sa_t sa)</div><div class="ttdoc">Disable IPSEC SA.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gab431efd3643880dee137c5e6d8ec28a9"><div class="ttname"><a href="group__odp__ipsec.html#gab431efd3643880dee137c5e6d8ec28a9">odp_ipsec_out_enq</a></div><div class="ttdeci">int odp_ipsec_out_enq(const odp_packet_t pkt[], int num, const odp_ipsec_out_param_t *param)</div><div class="ttdoc">Outbound asynchronous IPSEC operation.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gab81f2a38a01fc4ac01fb59dc73351a43"><div class="ttname"><a href="group__odp__ipsec.html#gab81f2a38a01fc4ac01fb59dc73351a43">odp_ipsec_status</a></div><div class="ttdeci">int odp_ipsec_status(odp_ipsec_status_t *status, odp_event_t event)</div><div class="ttdoc">Get IPSEC status information from an ODP_EVENT_IPSEC_STATUS event.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gad094aba428809ca781f5748546c7ace1"><div class="ttname"><a href="group__odp__ipsec.html#gad094aba428809ca781f5748546c7ace1">odp_ipsec_cipher_capability</a></div><div class="ttdeci">int odp_ipsec_cipher_capability(odp_cipher_alg_t cipher, odp_ipsec_cipher_capability_t capa[], int num)</div><div class="ttdoc">Query supported IPSEC cipher algorithm capabilities.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gad16586424d5ace868a99b2c3bad18fb0"><div class="ttname"><a href="group__odp__ipsec.html#gad16586424d5ace868a99b2c3bad18fb0">ODP_IPSEC_SA_INVALID</a></div><div class="ttdeci">#define ODP_IPSEC_SA_INVALID</div><div class="ttdoc">Invalid IPSEC SA.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gae4e141526c0c12948dbed9f187043b6e"><div class="ttname"><a href="group__odp__ipsec.html#gae4e141526c0c12948dbed9f187043b6e">odp_ipsec_sa_create</a></div><div class="ttdeci">odp_ipsec_sa_t odp_ipsec_sa_create(const odp_ipsec_sa_param_t *param)</div><div class="ttdoc">Create IPSEC SA.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gafd3b04ba7862bf42749911fe54cd29d1"><div class="ttname"><a href="group__odp__ipsec.html#gafd3b04ba7862bf42749911fe54cd29d1">odp_ipsec_sa_destroy</a></div><div class="ttdeci">int odp_ipsec_sa_destroy(odp_ipsec_sa_t sa)</div><div class="ttdoc">Destroy IPSEC SA.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gafff715b7d787c085f492eca8d77ed8c6"><div class="ttname"><a href="group__odp__ipsec.html#gafff715b7d787c085f492eca8d77ed8c6">odp_ipsec_result</a></div><div class="ttdeci">int odp_ipsec_result(odp_ipsec_packet_result_t *result, odp_packet_t packet)</div><div class="ttdoc">Get IPSEC operation results from an IPSEC processed packet.</div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gga62ebf20444145fe3faa4e0ceed7c121ba5c37267f141685b9df2d29a8af727e8f"><div class="ttname"><a href="group__odp__ipsec.html#gga62ebf20444145fe3faa4e0ceed7c121ba5c37267f141685b9df2d29a8af727e8f">ODP_IPSEC_OP_MODE_SYNC</a></div><div class="ttdeci">@ ODP_IPSEC_OP_MODE_SYNC</div><div class="ttdoc">Synchronous IPSEC operation.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00050">api/spec/ipsec_types.h:50</a></div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gga62ebf20444145fe3faa4e0ceed7c121baa997483371ce738cebfcc5cef437cf5e"><div class="ttname"><a href="group__odp__ipsec.html#gga62ebf20444145fe3faa4e0ceed7c121baa997483371ce738cebfcc5cef437cf5e">ODP_IPSEC_OP_MODE_ASYNC</a></div><div class="ttdeci">@ ODP_IPSEC_OP_MODE_ASYNC</div><div class="ttdoc">Asynchronous IPSEC operation.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00057">api/spec/ipsec_types.h:57</a></div></div>
<div class="ttc" id="agroup__odp__ipsec_html_gga6cd8d0662643f62d9663a927e0bb8123ab34f400b50ac3abbc96a2d659a0d26f4"><div class="ttname"><a href="group__odp__ipsec.html#gga6cd8d0662643f62d9663a927e0bb8123ab34f400b50ac3abbc96a2d659a0d26f4">ODP_IPSEC_STATUS_SA_DISABLE</a></div><div class="ttdeci">@ ODP_IPSEC_STATUS_SA_DISABLE</div><div class="ttdoc">Response to SA disable command.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01453">api/spec/ipsec_types.h:1453</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga04d67c951aff803cf718940e0783ef8f"><div class="ttname"><a href="group__odp__packet__io.html#ga04d67c951aff803cf718940e0783ef8f">odp_pktio_mac_addr</a></div><div class="ttdeci">int odp_pktio_mac_addr(odp_pktio_t pktio, void *mac_addr, int size)</div><div class="ttdoc">Get the default MAC address of a packet IO interface.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga055eabf5622e6745afbe9a1550ad1d78"><div class="ttname"><a href="group__odp__packet__io.html#ga055eabf5622e6745afbe9a1550ad1d78">odp_pktin_queue_param_init</a></div><div class="ttdeci">void odp_pktin_queue_param_init(odp_pktin_queue_param_t *param)</div><div class="ttdoc">Initialize packet input queue parameters.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga26d165a22d659770eba0c48543860881"><div class="ttname"><a href="group__odp__packet__io.html#ga26d165a22d659770eba0c48543860881">odp_pktio_param_init</a></div><div class="ttdeci">void odp_pktio_param_init(odp_pktio_param_t *param)</div><div class="ttdoc">Initialize pktio params.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga2e481c9f2f073cc337aff7f4c65cba7c"><div class="ttname"><a href="group__odp__packet__io.html#ga2e481c9f2f073cc337aff7f4c65cba7c">odp_pktio_close</a></div><div class="ttdeci">int odp_pktio_close(odp_pktio_t pktio)</div><div class="ttdoc">Close a packet IO interface.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga41a3ebb7ac489b85a5f7560e4d4f77f5"><div class="ttname"><a href="group__odp__packet__io.html#ga41a3ebb7ac489b85a5f7560e4d4f77f5">odp_pktout_queue</a></div><div class="ttdeci">int odp_pktout_queue(odp_pktio_t pktio, odp_pktout_queue_t queues[], int num)</div><div class="ttdoc">Direct packet output queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga6a1c262ef999e8a73ac107c182b67d33"><div class="ttname"><a href="group__odp__packet__io.html#ga6a1c262ef999e8a73ac107c182b67d33">odp_pktio_config_init</a></div><div class="ttdeci">void odp_pktio_config_init(odp_pktio_config_t *config)</div><div class="ttdoc">Initialize packet IO configuration options.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga7ae4f96ab09d468fff3623d90db306f9"><div class="ttname"><a href="group__odp__packet__io.html#ga7ae4f96ab09d468fff3623d90db306f9">odp_pktio_open</a></div><div class="ttdeci">odp_pktio_t odp_pktio_open(const char *name, odp_pool_t pool, const odp_pktio_param_t *param)</div><div class="ttdoc">Open a packet IO interface.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga7f9faaf250d3d0d87478ff9f13680bf1"><div class="ttname"><a href="group__odp__packet__io.html#ga7f9faaf250d3d0d87478ff9f13680bf1">odp_pktio_config</a></div><div class="ttdeci">int odp_pktio_config(odp_pktio_t pktio, const odp_pktio_config_t *config)</div><div class="ttdoc">Configure packet IO interface options.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga9a5746e73616297fabb8d4caaa6d0333"><div class="ttname"><a href="group__odp__packet__io.html#ga9a5746e73616297fabb8d4caaa6d0333">odp_pktio_start</a></div><div class="ttdeci">int odp_pktio_start(odp_pktio_t pktio)</div><div class="ttdoc">Start packet receive and transmit.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ga9c7d0fcaec232b5503633e42ea29f6f5"><div class="ttname"><a href="group__odp__packet__io.html#ga9c7d0fcaec232b5503633e42ea29f6f5">ODP_PKTIO_INVALID</a></div><div class="ttdeci">#define ODP_PKTIO_INVALID</div><div class="ttdoc">Invalid packet IO handle.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gaa9d5cad745c9744ce026412ccf33d019"><div class="ttname"><a href="group__odp__packet__io.html#gaa9d5cad745c9744ce026412ccf33d019">odp_pktin_queue</a></div><div class="ttdeci">int odp_pktin_queue(odp_pktio_t pktio, odp_pktin_queue_t queues[], int num)</div><div class="ttdoc">Direct packet input queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gab09475da05438a53b2d0fca96aab7515"><div class="ttname"><a href="group__odp__packet__io.html#gab09475da05438a53b2d0fca96aab7515">odp_pktout_queue_param_init</a></div><div class="ttdeci">void odp_pktout_queue_param_init(odp_pktout_queue_param_t *param)</div><div class="ttdoc">Initialize packet output queue parameters.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gab2089a43d1901927c000bc43af3b6a2b"><div class="ttname"><a href="group__odp__packet__io.html#gab2089a43d1901927c000bc43af3b6a2b">odp_pktout_event_queue</a></div><div class="ttdeci">int odp_pktout_event_queue(odp_pktio_t pktio, odp_queue_t queues[], int num)</div><div class="ttdoc">Event queues for packet output.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gab34cb9679bf99d1b3366f06a9b155c41"><div class="ttname"><a href="group__odp__packet__io.html#gab34cb9679bf99d1b3366f06a9b155c41">odp_pktio_stop</a></div><div class="ttdeci">int odp_pktio_stop(odp_pktio_t pktio)</div><div class="ttdoc">Stop packet receive and transmit.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gab3dd2331f6ba05e074333fd5badae340"><div class="ttname"><a href="group__odp__packet__io.html#gab3dd2331f6ba05e074333fd5badae340">odp_pktin_recv</a></div><div class="ttdeci">int odp_pktin_recv(odp_pktin_queue_t queue, odp_packet_t packets[], int num)</div><div class="ttdoc">Receive packets directly from an interface input queue.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gaba80778db7ec138977ed9e473bd1faaa"><div class="ttname"><a href="group__odp__packet__io.html#gaba80778db7ec138977ed9e473bd1faaa">odp_pktio_capability</a></div><div class="ttdeci">int odp_pktio_capability(odp_pktio_t pktio, odp_pktio_capability_t *capa)</div><div class="ttdoc">Query packet IO interface capabilities.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gacb5db3a908775522e316c8b8ccb36498"><div class="ttname"><a href="group__odp__packet__io.html#gacb5db3a908775522e316c8b8ccb36498">odp_pktout_send</a></div><div class="ttdeci">int odp_pktout_send(odp_pktout_queue_t queue, const odp_packet_t packets[], int num)</div><div class="ttdoc">Send packets directly to an interface output queue.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gaf9dce6b2cc13ad715e777416dce88194"><div class="ttname"><a href="group__odp__packet__io.html#gaf9dce6b2cc13ad715e777416dce88194">odp_pktin_queue_config</a></div><div class="ttdeci">int odp_pktin_queue_config(odp_pktio_t pktio, const odp_pktin_queue_param_t *param)</div><div class="ttdoc">Configure packet input queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gafc2120185a8da74540feade78623f3b3"><div class="ttname"><a href="group__odp__packet__io.html#gafc2120185a8da74540feade78623f3b3">odp_pktout_queue_config</a></div><div class="ttdeci">int odp_pktout_queue_config(odp_pktio_t pktio, const odp_pktout_queue_param_t *param)</div><div class="ttdoc">Configure packet output queues.</div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gga4e0c26e40b1166b07142302d12e8467da9e6184e8d605ce199cfa54d6c50153ff"><div class="ttname"><a href="group__odp__packet__io.html#gga4e0c26e40b1166b07142302d12e8467da9e6184e8d605ce199cfa54d6c50153ff">ODP_PKTOUT_MODE_DIRECT</a></div><div class="ttdeci">@ ODP_PKTOUT_MODE_DIRECT</div><div class="ttdoc">Direct packet output on the interface.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00109">api/spec/packet_io_types.h:109</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_gga4e0c26e40b1166b07142302d12e8467dae90395ccf6ce924a3a6cb375ca42f279"><div class="ttname"><a href="group__odp__packet__io.html#gga4e0c26e40b1166b07142302d12e8467dae90395ccf6ce924a3a6cb375ca42f279">ODP_PKTOUT_MODE_QUEUE</a></div><div class="ttdeci">@ ODP_PKTOUT_MODE_QUEUE</div><div class="ttdoc">Packet output through event queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00111">api/spec/packet_io_types.h:111</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ggacf2c32e76d9d0eef9106b5fdd68cedc8a1e3d825b302ee6213937172a6b54b140"><div class="ttname"><a href="group__odp__packet__io.html#ggacf2c32e76d9d0eef9106b5fdd68cedc8a1e3d825b302ee6213937172a6b54b140">ODP_PKTIO_OP_MT_UNSAFE</a></div><div class="ttdeci">@ ODP_PKTIO_OP_MT_UNSAFE</div><div class="ttdoc">Not multithread safe operation.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00167">api/spec/packet_io_types.h:165</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ggacf2c32e76d9d0eef9106b5fdd68cedc8af3637232af55eb954ba439b2d33120d3"><div class="ttname"><a href="group__odp__packet__io.html#ggacf2c32e76d9d0eef9106b5fdd68cedc8af3637232af55eb954ba439b2d33120d3">ODP_PKTIO_OP_MT</a></div><div class="ttdeci">@ ODP_PKTIO_OP_MT</div><div class="ttdoc">Multithread safe operation.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00157">api/spec/packet_io_types.h:157</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ggaf5d539df6fc8af55d96357c784a54b8fa36f229784bc7dcef48203b02b3938357"><div class="ttname"><a href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8fa36f229784bc7dcef48203b02b3938357">ODP_PKTIN_MODE_DIRECT</a></div><div class="ttdeci">@ ODP_PKTIN_MODE_DIRECT</div><div class="ttdoc">Direct packet input from the interface.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00095">api/spec/packet_io_types.h:95</a></div></div>
<div class="ttc" id="agroup__odp__packet__io_html_ggaf5d539df6fc8af55d96357c784a54b8faa4f62db7acbe492a3b80f3f782a04dd5"><div class="ttname"><a href="group__odp__packet__io.html#ggaf5d539df6fc8af55d96357c784a54b8faa4f62db7acbe492a3b80f3f782a04dd5">ODP_PKTIN_MODE_SCHED</a></div><div class="ttdeci">@ ODP_PKTIN_MODE_SCHED</div><div class="ttdoc">Packet input through scheduler and scheduled event queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00097">api/spec/packet_io_types.h:97</a></div></div>
<div class="ttc" id="agroup__odp__packet_html_ga1460efe82a6129a52b8b48756fce9d5c"><div class="ttname"><a href="group__odp__packet.html#ga1460efe82a6129a52b8b48756fce9d5c">odp_packet_pull_head</a></div><div class="ttdeci">void * odp_packet_pull_head(odp_packet_t pkt, uint32_t len)</div><div class="ttdoc">Pull in packet head.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga163f75fca9789a17ab4db0e75bfd9b29"><div class="ttname"><a href="group__odp__packet.html#ga163f75fca9789a17ab4db0e75bfd9b29">odp_packet_user_ptr</a></div><div class="ttdeci">void * odp_packet_user_ptr(odp_packet_t pkt)</div><div class="ttdoc">User context pointer.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga229f5a60b69678c472b6b75dcf443dfe"><div class="ttname"><a href="group__odp__packet.html#ga229f5a60b69678c472b6b75dcf443dfe">odp_packet_to_event_multi</a></div><div class="ttdeci">void odp_packet_to_event_multi(const odp_packet_t pkt[], odp_event_t ev[], int num)</div><div class="ttdoc">Convert multiple packet handles to events.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga2ed856750508efaae13d6be7aaa93695"><div class="ttname"><a href="group__odp__packet.html#ga2ed856750508efaae13d6be7aaa93695">odp_packet_push_head</a></div><div class="ttdeci">void * odp_packet_push_head(odp_packet_t pkt, uint32_t len)</div><div class="ttdoc">Push out packet head.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga3d1e523b200b887c88d9506a804f0e38"><div class="ttname"><a href="group__odp__packet.html#ga3d1e523b200b887c88d9506a804f0e38">odp_packet_l4_offset</a></div><div class="ttdeci">uint32_t odp_packet_l4_offset(odp_packet_t pkt)</div><div class="ttdoc">Layer 4 start offset.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga6a0bceb8c3c555f52638561dfce5f785"><div class="ttname"><a href="group__odp__packet.html#ga6a0bceb8c3c555f52638561dfce5f785">odp_packet_has_error</a></div><div class="ttdeci">int odp_packet_has_error(odp_packet_t pkt)</div><div class="ttdoc">Check for all parse errors in packet.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga8605e7d4629a479f7b1a59da121c601c"><div class="ttname"><a href="group__odp__packet.html#ga8605e7d4629a479f7b1a59da121c601c">odp_packet_from_event</a></div><div class="ttdeci">odp_packet_t odp_packet_from_event(odp_event_t ev)</div><div class="ttdoc">Get packet handle from event.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga8a5e2cd674828c5415f3695f266347d7"><div class="ttname"><a href="group__odp__packet.html#ga8a5e2cd674828c5415f3695f266347d7">odp_packet_free</a></div><div class="ttdeci">void odp_packet_free(odp_packet_t pkt)</div><div class="ttdoc">Free packet.</div></div>
<div class="ttc" id="agroup__odp__packet_html_ga9eb7cff2a7f32d07bcf919d7286509b1"><div class="ttname"><a href="group__odp__packet.html#ga9eb7cff2a7f32d07bcf919d7286509b1">odp_packet_l3_offset</a></div><div class="ttdeci">uint32_t odp_packet_l3_offset(odp_packet_t pkt)</div><div class="ttdoc">Layer 3 start offset.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gab67164b42ca75ae96615af7cebbfc414"><div class="ttname"><a href="group__odp__packet.html#gab67164b42ca75ae96615af7cebbfc414">odp_packet_copy_from_mem</a></div><div class="ttdeci">int odp_packet_copy_from_mem(odp_packet_t pkt, uint32_t offset, uint32_t len, const void *src)</div><div class="ttdoc">Copy data from memory to packet.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gab6a8f73fcc0f585c4a4443f9f449b69e"><div class="ttname"><a href="group__odp__packet.html#gab6a8f73fcc0f585c4a4443f9f449b69e">odp_packet_has_ipsec</a></div><div class="ttdeci">int odp_packet_has_ipsec(odp_packet_t pkt)</div><div class="ttdoc">Check for IPSec.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gabba756536217212e5570b73db24d00c8"><div class="ttname"><a href="group__odp__packet.html#gabba756536217212e5570b73db24d00c8">odp_packet_user_ptr_set</a></div><div class="ttdeci">void odp_packet_user_ptr_set(odp_packet_t pkt, const void *user_ptr)</div><div class="ttdoc">Set user context pointer.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gad190c5b094a0406b9d86da03f10c15cb"><div class="ttname"><a href="group__odp__packet.html#gad190c5b094a0406b9d86da03f10c15cb">odp_packet_free_multi</a></div><div class="ttdeci">void odp_packet_free_multi(const odp_packet_t pkt[], int num)</div><div class="ttdoc">Free multiple packets.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gadf9179122029a9dd7a000e050f68b357"><div class="ttname"><a href="group__odp__packet.html#gadf9179122029a9dd7a000e050f68b357">odp_packet_copy_to_mem</a></div><div class="ttdeci">int odp_packet_copy_to_mem(odp_packet_t pkt, uint32_t offset, uint32_t len, void *dst)</div><div class="ttdoc">Copy data from packet to memory.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gaebb6c19d5fc2ff3a722947b74e0d38a3"><div class="ttname"><a href="group__odp__packet.html#gaebb6c19d5fc2ff3a722947b74e0d38a3">odp_packet_has_udp</a></div><div class="ttdeci">int odp_packet_has_udp(odp_packet_t pkt)</div><div class="ttdoc">Check for UDP.</div></div>
<div class="ttc" id="agroup__odp__packet_html_gga428cdbec9e7bc0bc19286f9564f9828ba45a5be98c1596b05a7406f894902beaf"><div class="ttname"><a href="group__odp__packet.html#gga428cdbec9e7bc0bc19286f9564f9828ba45a5be98c1596b05a7406f894902beaf">ODP_PROTO_LAYER_L4</a></div><div class="ttdeci">@ ODP_PROTO_LAYER_L4</div><div class="ttdoc">Layer L4 protocols (UDP, TCP, SCTP)</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__types_8h_source.html#l00244">api/spec/packet_types.h:244</a></div></div>
<div class="ttc" id="agroup__odp__pool_html_ga256909a276600c25ce11b52ae274632f"><div class="ttname"><a href="group__odp__pool.html#ga256909a276600c25ce11b52ae274632f">odp_pool_create</a></div><div class="ttdeci">odp_pool_t odp_pool_create(const char *name, const odp_pool_param_t *param)</div><div class="ttdoc">Create a pool.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga2c6f42e9611904eac84872bf8f913b75"><div class="ttname"><a href="group__odp__pool.html#ga2c6f42e9611904eac84872bf8f913b75">odp_pool_capability</a></div><div class="ttdeci">int odp_pool_capability(odp_pool_capability_t *capa)</div><div class="ttdoc">Query pool capabilities.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga3dd8bcfb920f81142e9fe27cfba24073"><div class="ttname"><a href="group__odp__pool.html#ga3dd8bcfb920f81142e9fe27cfba24073">odp_pool_param_init</a></div><div class="ttdeci">void odp_pool_param_init(odp_pool_param_t *param)</div><div class="ttdoc">Initialize pool params.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ga6ad439aaef911d82b972c915850e6924"><div class="ttname"><a href="group__odp__pool.html#ga6ad439aaef911d82b972c915850e6924">odp_pool_destroy</a></div><div class="ttdeci">int odp_pool_destroy(odp_pool_t pool)</div><div class="ttdoc">Destroy a pool previously created by odp_pool_create()</div></div>
<div class="ttc" id="agroup__odp__pool_html_gafca03b58412260da754042a92f8a5e04"><div class="ttname"><a href="group__odp__pool.html#gafca03b58412260da754042a92f8a5e04">ODP_POOL_INVALID</a></div><div class="ttdeci">#define ODP_POOL_INVALID</div><div class="ttdoc">Invalid pool.</div></div>
<div class="ttc" id="agroup__odp__pool_html_ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd"><div class="ttname"><a href="group__odp__pool.html#ggac47bb33bcde80614b4b358578eaa3082aa02b3a4e37094bd277b3dfe371450acd">ODP_POOL_PACKET</a></div><div class="ttdeci">@ ODP_POOL_PACKET</div><div class="ttdoc">Packet pool.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00436">api/spec/pool_types.h:436</a></div></div>
<div class="ttc" id="agroup__odp__queue_html_ga6b3ef7c0d52f9dd31e534b9cf17eb218"><div class="ttname"><a href="group__odp__queue.html#ga6b3ef7c0d52f9dd31e534b9cf17eb218">odp_queue_enq_multi</a></div><div class="ttdeci">int odp_queue_enq_multi(odp_queue_t queue, const odp_event_t events[], int num)</div><div class="ttdoc">Enqueue multiple events to a queue.</div></div>
<div class="ttc" id="agroup__odp__queue_html_ga6fc2ea5eb86152210342f7377d1468e4"><div class="ttname"><a href="group__odp__queue.html#ga6fc2ea5eb86152210342f7377d1468e4">odp_queue_param_init</a></div><div class="ttdeci">void odp_queue_param_init(odp_queue_param_t *param)</div><div class="ttdoc">Initialize queue params.</div></div>
<div class="ttc" id="agroup__odp__queue_html_ga771259a58e71e065e0d00d2fc431b014"><div class="ttname"><a href="group__odp__queue.html#ga771259a58e71e065e0d00d2fc431b014">ODP_QUEUE_INVALID</a></div><div class="ttdeci">#define ODP_QUEUE_INVALID</div><div class="ttdoc">Invalid queue.</div></div>
<div class="ttc" id="agroup__odp__queue_html_ga8891fdf050b94cb84fcd2c59fef31bec"><div class="ttname"><a href="group__odp__queue.html#ga8891fdf050b94cb84fcd2c59fef31bec">ODP_QUEUE_NAME_LEN</a></div><div class="ttdeci">#define ODP_QUEUE_NAME_LEN</div><div class="ttdoc">Maximum queue name length, including the null character.</div></div>
<div class="ttc" id="agroup__odp__queue_html_gab985be8c3947fef3da257e16948bf0f0"><div class="ttname"><a href="group__odp__queue.html#gab985be8c3947fef3da257e16948bf0f0">odp_queue_create</a></div><div class="ttdeci">odp_queue_t odp_queue_create(const char *name, const odp_queue_param_t *param)</div><div class="ttdoc">Queue create.</div></div>
<div class="ttc" id="agroup__odp__queue_html_gad1e1d2709808385025dd5f005f7690c4"><div class="ttname"><a href="group__odp__queue.html#gad1e1d2709808385025dd5f005f7690c4">odp_queue_destroy</a></div><div class="ttdeci">int odp_queue_destroy(odp_queue_t queue)</div><div class="ttdoc">Destroy ODP queue.</div></div>
<div class="ttc" id="agroup__odp__queue_html_gga89a3439d3f3be48cac1767cba721eddaa4f49ad2143a9ba8a5914573d2794e962"><div class="ttname"><a href="group__odp__queue.html#gga89a3439d3f3be48cac1767cba721eddaa4f49ad2143a9ba8a5914573d2794e962">ODP_QUEUE_TYPE_SCHED</a></div><div class="ttdeci">@ ODP_QUEUE_TYPE_SCHED</div><div class="ttdoc">Scheduled queue.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2queue__types_8h_source.html#l00057">api/spec/queue_types.h:57</a></div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga17ae1ac2ac704684d0a7087a311c73f4"><div class="ttname"><a href="group__odp__scheduler.html#ga17ae1ac2ac704684d0a7087a311c73f4">odp_schedule_multi_no_wait</a></div><div class="ttdeci">int odp_schedule_multi_no_wait(odp_queue_t *from, odp_event_t events[], int num)</div><div class="ttdoc">Schedule, do not wait for events.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga2ba135fc660e1c050aa25ec6744ec584"><div class="ttname"><a href="group__odp__scheduler.html#ga2ba135fc660e1c050aa25ec6744ec584">ODP_SCHED_SYNC_PARALLEL</a></div><div class="ttdeci">#define ODP_SCHED_SYNC_PARALLEL</div><div class="ttdoc">Parallel scheduled queues.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga4df3696ebf4528ecc6e69ae3fff040fd"><div class="ttname"><a href="group__odp__scheduler.html#ga4df3696ebf4528ecc6e69ae3fff040fd">ODP_SCHED_SYNC_ORDERED</a></div><div class="ttdeci">#define ODP_SCHED_SYNC_ORDERED</div><div class="ttdoc">Ordered queue synchronization.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga9116776b8262a74af7dac7ef46fc7ace"><div class="ttname"><a href="group__odp__scheduler.html#ga9116776b8262a74af7dac7ef46fc7ace">ODP_SCHED_NO_WAIT</a></div><div class="ttdeci">#define ODP_SCHED_NO_WAIT</div><div class="ttdoc">Do not wait.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga94034a7f591f3f549099aebb098f7e05"><div class="ttname"><a href="group__odp__scheduler.html#ga94034a7f591f3f549099aebb098f7e05">odp_schedule_default_prio</a></div><div class="ttdeci">int odp_schedule_default_prio(void)</div><div class="ttdoc">Default scheduling priority level.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_ga9d91b9144cf2ccdcb112b7376a38aeaf"><div class="ttname"><a href="group__odp__scheduler.html#ga9d91b9144cf2ccdcb112b7376a38aeaf">odp_schedule_max_prio</a></div><div class="ttdeci">int odp_schedule_max_prio(void)</div><div class="ttdoc">Maximum scheduling priority level.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_gaa1b51ebd46adeb6aa7805fccb00144df"><div class="ttname"><a href="group__odp__scheduler.html#gaa1b51ebd46adeb6aa7805fccb00144df">odp_schedule_config</a></div><div class="ttdeci">int odp_schedule_config(const odp_schedule_config_t *config)</div><div class="ttdoc">Global schedule configuration.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_gae4ca1012ebb16ff8b9752b958dc45ce6"><div class="ttname"><a href="group__odp__scheduler.html#gae4ca1012ebb16ff8b9752b958dc45ce6">odp_schedule</a></div><div class="ttdeci">odp_event_t odp_schedule(odp_queue_t *from, uint64_t wait)</div><div class="ttdoc">Schedule an event.</div></div>
<div class="ttc" id="agroup__odp__scheduler_html_gaf463b15ad978dac0bf77c0110232b504"><div class="ttname"><a href="group__odp__scheduler.html#gaf463b15ad978dac0bf77c0110232b504">ODP_SCHED_GROUP_ALL</a></div><div class="ttdeci">#define ODP_SCHED_GROUP_ALL</div><div class="ttdoc">Group of all threads.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_ga0b02991b512acc119206b44c95a86ed6"><div class="ttname"><a href="group__odp__shared__memory.html#ga0b02991b512acc119206b44c95a86ed6">odp_shm_free</a></div><div class="ttdeci">int odp_shm_free(odp_shm_t shm)</div><div class="ttdoc">Free a contiguous block of shared memory.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_ga6e4289975efc279bb9f31880613a9d60"><div class="ttname"><a href="group__odp__shared__memory.html#ga6e4289975efc279bb9f31880613a9d60">ODP_SHM_INVALID</a></div><div class="ttdeci">#define ODP_SHM_INVALID</div><div class="ttdoc">Invalid shared memory block.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_gac94c4232f7cd64039bbaef601ff2c05e"><div class="ttname"><a href="group__odp__shared__memory.html#gac94c4232f7cd64039bbaef601ff2c05e">odp_shm_addr</a></div><div class="ttdeci">void * odp_shm_addr(odp_shm_t shm)</div><div class="ttdoc">Shared memory block address.</div></div>
<div class="ttc" id="agroup__odp__shared__memory_html_gacc441b0e100ec1c54e21f1745939a2d8"><div class="ttname"><a href="group__odp__shared__memory.html#gacc441b0e100ec1c54e21f1745939a2d8">odp_shm_reserve</a></div><div class="ttdeci">odp_shm_t odp_shm_reserve(const char *name, uint64_t size, uint64_t align, uint32_t flags)</div><div class="ttdoc">Reserve a contiguous block of shared memory.</div></div>
<div class="ttc" id="agroup__odp__std_html_ga0b2a7ca83ccc7af0346db309d8c06d6f"><div class="ttname"><a href="group__odp__std.html#ga0b2a7ca83ccc7af0346db309d8c06d6f">odp_bool_t</a></div><div class="ttdeci">bool odp_bool_t</div><div class="ttdoc">Boolean type.</div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2std__types_8h_source.html#l00025">api/abi-default/std_types.h:25</a></div></div>
<div class="ttc" id="agroup__odp__thread_html_gad6562e7320d48463715bbf15748ae360"><div class="ttname"><a href="group__odp__thread.html#gad6562e7320d48463715bbf15748ae360">odp_thread_id</a></div><div class="ttdeci">int odp_thread_id(void)</div><div class="ttdoc">Get thread identifier.</div></div>
<div class="ttc" id="agroup__odp__thread_html_ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a"><div class="ttname"><a href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a2182066d714db5f2a4e994ad92f25b2a">ODP_THREAD_WORKER</a></div><div class="ttdeci">@ ODP_THREAD_WORKER</div><div class="ttdoc">Worker thread.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2thread__types_8h_source.html#l00042">api/spec/thread_types.h:42</a></div></div>
<div class="ttc" id="agroup__odp__thread_html_ggafc7a7c180de9811d71b7cb050713bf53a9aab3fdb10eb2000a864bff81f23c00a"><div class="ttname"><a href="group__odp__thread.html#ggafc7a7c180de9811d71b7cb050713bf53a9aab3fdb10eb2000a864bff81f23c00a">ODP_THREAD_CONTROL</a></div><div class="ttdeci">@ ODP_THREAD_CONTROL</div><div class="ttdoc">Control thread.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2thread__types_8h_source.html#l00054">api/spec/thread_types.h:53</a></div></div>
<div class="ttc" id="aodp__api_8h_html"><div class="ttname"><a href="odp__api_8h.html">odp_api.h</a></div><div class="ttdoc">The OpenDataPlane API.</div></div>
<div class="ttc" id="astruct__odp__abi__event__t_html"><div class="ttname"><a href="struct__odp__abi__event__t.html">_odp_abi_event_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2event__types_8h_source.html#l00016">api/abi-default/event_types.h:16</a></div></div>
<div class="ttc" id="astruct__odp__abi__ipsec__sa__t_html"><div class="ttname"><a href="struct__odp__abi__ipsec__sa__t.html">_odp_abi_ipsec_sa_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2ipsec__types_8h_source.html#l00016">api/abi-default/ipsec_types.h:16</a></div></div>
<div class="ttc" id="astruct__odp__abi__packet__t_html"><div class="ttname"><a href="struct__odp__abi__packet__t.html">_odp_abi_packet_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__types_8h_source.html#l00016">api/abi-default/packet_types.h:16</a></div></div>
<div class="ttc" id="astruct__odp__abi__pktio__t_html"><div class="ttname"><a href="struct__odp__abi__pktio__t.html">_odp_abi_pktio_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__io__types_8h_source.html#l00022">api/abi-default/packet_io_types.h:22</a></div></div>
<div class="ttc" id="astruct__odp__abi__pool__t_html"><div class="ttname"><a href="struct__odp__abi__pool__t.html">_odp_abi_pool_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2pool__types_8h_source.html#l00014">api/abi-default/pool_types.h:14</a></div></div>
<div class="ttc" id="astruct__odp__abi__queue__t_html"><div class="ttname"><a href="struct__odp__abi__queue__t.html">_odp_abi_queue_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2queue__types_8h_source.html#l00014">api/abi-default/queue_types.h:14</a></div></div>
<div class="ttc" id="astruct__odp__abi__shm__t_html"><div class="ttname"><a href="struct__odp__abi__shm__t.html">_odp_abi_shm_t</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2shared__memory_8h_source.html#l00013">api/abi-default/shared_memory.h:13</a></div></div>
<div class="ttc" id="astructodp__atomic__u32__s_html"><div class="ttname"><a href="structodp__atomic__u32__s.html">odp_atomic_u32_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2atomic_8h_source.html#l00026">api/abi-default/atomic.h:26</a></div></div>
<div class="ttc" id="astructodp__barrier__s_html"><div class="ttname"><a href="structodp__barrier__s.html">odp_barrier_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2barrier_8h_source.html#l00025">api/abi-default/barrier.h:25</a></div></div>
<div class="ttc" id="astructodp__cpumask__s_html"><div class="ttname"><a href="structodp__cpumask__s.html">odp_cpumask_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2cpumask_8h_source.html#l00038">api/abi-default/cpumask.h:38</a></div></div>
<div class="ttc" id="astructodp__init__t_html"><div class="ttname"><a href="structodp__init__t.html">odp_init_t</a></div><div class="ttdoc">Global initialization parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2init_8h_source.html#l00161">api/spec/init.h:161</a></div></div>
<div class="ttc" id="astructodp__init__t_html_a7d368c740146170ebeb1651ce049919e"><div class="ttname"><a href="structodp__init__t.html#a7d368c740146170ebeb1651ce049919e">odp_init_t::mem_model</a></div><div class="ttdeci">odp_mem_model_t mem_model</div><div class="ttdoc">Application memory model.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2init_8h_source.html#l00218">api/spec/init.h:218</a></div></div>
<div class="ttc" id="astructodp__ipsec__auth__capability__t_html"><div class="ttname"><a href="structodp__ipsec__auth__capability__t.html">odp_ipsec_auth_capability_t</a></div><div class="ttdoc">Authentication algorithm capabilities.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00414">api/spec/ipsec_types.h:414</a></div></div>
<div class="ttc" id="astructodp__ipsec__capability__t_html"><div class="ttname"><a href="structodp__ipsec__capability__t.html">odp_ipsec_capability_t</a></div><div class="ttdoc">IPSEC capability.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00282">api/spec/ipsec_types.h:282</a></div></div>
<div class="ttc" id="astructodp__ipsec__capability__t_html_a279c5ccb86363d56b07dd96299148510"><div class="ttname"><a href="structodp__ipsec__capability__t.html#a279c5ccb86363d56b07dd96299148510">odp_ipsec_capability_t::ciphers</a></div><div class="ttdeci">odp_crypto_cipher_algos_t ciphers</div><div class="ttdoc">Supported cipher algorithms.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00371">api/spec/ipsec_types.h:371</a></div></div>
<div class="ttc" id="astructodp__ipsec__capability__t_html_a9241e32b688bb109b67ef130dac0cbc2"><div class="ttname"><a href="structodp__ipsec__capability__t.html#a9241e32b688bb109b67ef130dac0cbc2">odp_ipsec_capability_t::max_num_sa</a></div><div class="ttdeci">uint32_t max_num_sa</div><div class="ttdoc">Maximum number of IPSEC SAs.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00284">api/spec/ipsec_types.h:284</a></div></div>
<div class="ttc" id="astructodp__ipsec__capability__t_html_abf54129f80528108f5fdc22d68a53808"><div class="ttname"><a href="structodp__ipsec__capability__t.html#abf54129f80528108f5fdc22d68a53808">odp_ipsec_capability_t::auths</a></div><div class="ttdeci">odp_crypto_auth_algos_t auths</div><div class="ttdoc">Supported authentication algorithms.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00374">api/spec/ipsec_types.h:374</a></div></div>
<div class="ttc" id="astructodp__ipsec__capability__t_html_ad98b9759e0b8652f6dbd12c33efed808"><div class="ttname"><a href="structodp__ipsec__capability__t.html#ad98b9759e0b8652f6dbd12c33efed808">odp_ipsec_capability_t::max_queues</a></div><div class="ttdeci">uint32_t max_queues</div><div class="ttdoc">Maximum number of different destination queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00362">api/spec/ipsec_types.h:362</a></div></div>
<div class="ttc" id="astructodp__ipsec__cipher__capability__t_html"><div class="ttname"><a href="structodp__ipsec__cipher__capability__t.html">odp_ipsec_cipher_capability_t</a></div><div class="ttdoc">Cipher algorithm capabilities.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00405">api/spec/ipsec_types.h:405</a></div></div>
<div class="ttc" id="astructodp__ipsec__config__t_html"><div class="ttname"><a href="structodp__ipsec__config__t.html">odp_ipsec_config_t</a></div><div class="ttdoc">IPSEC configuration options.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00425">api/spec/ipsec_types.h:425</a></div></div>
<div class="ttc" id="astructodp__ipsec__config__t_html_a68a6a143a51129e7178f2c908fa41343"><div class="ttname"><a href="structodp__ipsec__config__t.html#a68a6a143a51129e7178f2c908fa41343">odp_ipsec_config_t::outbound_mode</a></div><div class="ttdeci">odp_ipsec_op_mode_t outbound_mode</div><div class="ttdoc">Outbound IPSEC operation mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00438">api/spec/ipsec_types.h:438</a></div></div>
<div class="ttc" id="astructodp__ipsec__config__t_html_aa75541d269385cb764421165a6e393f7"><div class="ttname"><a href="structodp__ipsec__config__t.html#aa75541d269385cb764421165a6e393f7">odp_ipsec_config_t::inbound</a></div><div class="ttdeci">odp_ipsec_inbound_config_t inbound</div><div class="ttdoc">IPSEC inbound processing configuration.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00445">api/spec/ipsec_types.h:445</a></div></div>
<div class="ttc" id="astructodp__ipsec__config__t_html_afda7c35b60666f6e19ee3e6e049c71ce"><div class="ttname"><a href="structodp__ipsec__config__t.html#afda7c35b60666f6e19ee3e6e049c71ce">odp_ipsec_config_t::inbound_mode</a></div><div class="ttdeci">odp_ipsec_op_mode_t inbound_mode</div><div class="ttdoc">Inbound IPSEC operation mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00431">api/spec/ipsec_types.h:431</a></div></div>
<div class="ttc" id="astructodp__ipsec__in__param__t_html"><div class="ttname"><a href="structodp__ipsec__in__param__t.html">odp_ipsec_in_param_t</a></div><div class="ttdoc">IPSEC inbound operation parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01315">api/spec/ipsec_types.h:1315</a></div></div>
<div class="ttc" id="astructodp__ipsec__in__param__t_html_a7de98bd0265da777b51d085b6ef6c6cc"><div class="ttname"><a href="structodp__ipsec__in__param__t.html#a7de98bd0265da777b51d085b6ef6c6cc">odp_ipsec_in_param_t::num_sa</a></div><div class="ttdeci">int num_sa</div><div class="ttdoc">Number of SAs.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01330">api/spec/ipsec_types.h:1330</a></div></div>
<div class="ttc" id="astructodp__ipsec__in__param__t_html_ad89e2bbaa4148ee47dd1856874b9bb76"><div class="ttname"><a href="structodp__ipsec__in__param__t.html#ad89e2bbaa4148ee47dd1856874b9bb76">odp_ipsec_in_param_t::sa</a></div><div class="ttdeci">const odp_ipsec_sa_t * sa</div><div class="ttdoc">Pointer to an array of IPSEC SAs.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01336">api/spec/ipsec_types.h:1336</a></div></div>
<div class="ttc" id="astructodp__ipsec__inbound__config__t_html_a5a97f8e38e05ccd1a83acd57e4c2e655"><div class="ttname"><a href="structodp__ipsec__inbound__config__t.html#a5a97f8e38e05ccd1a83acd57e4c2e655">odp_ipsec_inbound_config_t::default_queue</a></div><div class="ttdeci">odp_queue_t default_queue</div><div class="ttdoc">Default destination queue for IPSEC events.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00124">api/spec/ipsec_types.h:124</a></div></div>
<div class="ttc" id="astructodp__ipsec__inbound__config__t_html_a70dfa978b76e6bfc05b589d1caadb967"><div class="ttname"><a href="structodp__ipsec__inbound__config__t.html#a70dfa978b76e6bfc05b589d1caadb967">odp_ipsec_inbound_config_t::parse_level</a></div><div class="ttdeci">odp_proto_layer_t parse_level</div><div class="ttdoc">Parse packet headers after IPSEC transformation.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00183">api/spec/ipsec_types.h:183</a></div></div>
<div class="ttc" id="astructodp__ipsec__op__status__t_html_a22c047c8c7008047f8a67cd70c2f0d75"><div class="ttname"><a href="structodp__ipsec__op__status__t.html#a22c047c8c7008047f8a67cd70c2f0d75">odp_ipsec_op_status_t::all</a></div><div class="ttdeci">uint64_t all</div><div class="ttdoc">All status bits.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01187">api/spec/ipsec_types.h:1187</a></div></div>
<div class="ttc" id="astructodp__ipsec__out__param__t_html"><div class="ttname"><a href="structodp__ipsec__out__param__t.html">odp_ipsec_out_param_t</a></div><div class="ttdoc">IPSEC outbound operation parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01280">api/spec/ipsec_types.h:1280</a></div></div>
<div class="ttc" id="astructodp__ipsec__out__param__t_html_a5a04803b40fb0d917d10f57ef7284c48"><div class="ttname"><a href="structodp__ipsec__out__param__t.html#a5a04803b40fb0d917d10f57ef7284c48">odp_ipsec_out_param_t::sa</a></div><div class="ttdeci">const odp_ipsec_sa_t * sa</div><div class="ttdoc">Pointer to an array of IPSEC SAs.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01302">api/spec/ipsec_types.h:1302</a></div></div>
<div class="ttc" id="astructodp__ipsec__out__param__t_html_aa034994bdaee89c31815872f19f8c0e7"><div class="ttname"><a href="structodp__ipsec__out__param__t.html#aa034994bdaee89c31815872f19f8c0e7">odp_ipsec_out_param_t::num_sa</a></div><div class="ttdeci">int num_sa</div><div class="ttdoc">Number of SAs.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01290">api/spec/ipsec_types.h:1290</a></div></div>
<div class="ttc" id="astructodp__ipsec__packet__result__t_html"><div class="ttname"><a href="structodp__ipsec__packet__result__t.html">odp_ipsec_packet_result_t</a></div><div class="ttdoc">IPSEC operation result for a packet.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01393">api/spec/ipsec_types.h:1393</a></div></div>
<div class="ttc" id="astructodp__ipsec__packet__result__t_html_a97a69c8020038199cd9da5795bf352ec"><div class="ttname"><a href="structodp__ipsec__packet__result__t.html#a97a69c8020038199cd9da5795bf352ec">odp_ipsec_packet_result_t::status</a></div><div class="ttdeci">odp_ipsec_op_status_t status</div><div class="ttdoc">IPSEC operation status.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01397">api/spec/ipsec_types.h:1397</a></div></div>
<div class="ttc" id="astructodp__ipsec__sa__param__t_html"><div class="ttname"><a href="structodp__ipsec__sa__param__t.html">odp_ipsec_sa_param_t</a></div><div class="ttdoc">IPSEC Security Association (SA) parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00842">api/spec/ipsec_types.h:842</a></div></div>
<div class="ttc" id="astructodp__ipsec__sa__param__t_html_a30f487908a45f7bc3525c7b6589a0a19"><div class="ttname"><a href="structodp__ipsec__sa__param__t.html#a30f487908a45f7bc3525c7b6589a0a19">odp_ipsec_sa_param_t::spi</a></div><div class="ttdeci">uint32_t spi</div><div class="ttdoc">SPI value.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00862">api/spec/ipsec_types.h:862</a></div></div>
<div class="ttc" id="astructodp__ipsec__sa__param__t_html_a463c2cbc43b94ae61c709d782a7beda7"><div class="ttname"><a href="structodp__ipsec__sa__param__t.html#a463c2cbc43b94ae61c709d782a7beda7">odp_ipsec_sa_param_t::dest_queue</a></div><div class="ttdeci">odp_queue_t dest_queue</div><div class="ttdoc">Destination queue for IPSEC events.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00870">api/spec/ipsec_types.h:870</a></div></div>
<div class="ttc" id="astructodp__ipsec__sa__param__t_html_a8f5df06cff3180089206954511a72186"><div class="ttname"><a href="structodp__ipsec__sa__param__t.html#a8f5df06cff3180089206954511a72186">odp_ipsec_sa_param_t::dir</a></div><div class="ttdeci">odp_ipsec_dir_t dir</div><div class="ttdoc">IPSEC SA direction: inbound or outbound.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l00844">api/spec/ipsec_types.h:844</a></div></div>
<div class="ttc" id="astructodp__ipsec__status__t_html"><div class="ttname"><a href="structodp__ipsec__status__t.html">odp_ipsec_status_t</a></div><div class="ttdoc">IPSEC status content.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01472">api/spec/ipsec_types.h:1472</a></div></div>
<div class="ttc" id="astructodp__ipsec__status__t_html_a0c1bbbaad463b5b4079adb1e4e761689"><div class="ttname"><a href="structodp__ipsec__status__t.html#a0c1bbbaad463b5b4079adb1e4e761689">odp_ipsec_status_t::result</a></div><div class="ttdeci">int result</div><div class="ttdoc">Result of the operation.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01484">api/spec/ipsec_types.h:1484</a></div></div>
<div class="ttc" id="astructodp__ipsec__status__t_html_aeea7b89a23b3f2342eca6eff2860176e"><div class="ttname"><a href="structodp__ipsec__status__t.html#aeea7b89a23b3f2342eca6eff2860176e">odp_ipsec_status_t::id</a></div><div class="ttdeci">odp_ipsec_status_id_t id</div><div class="ttdoc">IPSEC status ID.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2ipsec__types_8h_source.html#l01474">api/spec/ipsec_types.h:1474</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__param__t_html"><div class="ttname"><a href="structodp__pktin__queue__param__t.html">odp_pktin_queue_param_t</a></div><div class="ttdoc">Packet input queue parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00229">api/spec/packet_io_types.h:229</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__param__t_html_a03e94f43a2e4379d7a16adb964a55ecd"><div class="ttname"><a href="structodp__pktin__queue__param__t.html#a03e94f43a2e4379d7a16adb964a55ecd">odp_pktin_queue_param_t::num_queues</a></div><div class="ttdeci">uint32_t num_queues</div><div class="ttdoc">Number of input queues to be created.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00269">api/spec/packet_io_types.h:269</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__param__t_html_a1a15c51c24187f0f12e6482761ceb553"><div class="ttname"><a href="structodp__pktin__queue__param__t.html#a1a15c51c24187f0f12e6482761ceb553">odp_pktin_queue_param_t::op_mode</a></div><div class="ttdeci">odp_pktio_op_mode_t op_mode</div><div class="ttdoc">Operation mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00235">api/spec/packet_io_types.h:235</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__param__t_html_a5a07d5e93f26a523103360c0bea4a304"><div class="ttname"><a href="structodp__pktin__queue__param__t.html#a5a07d5e93f26a523103360c0bea4a304">odp_pktin_queue_param_t::queue_param</a></div><div class="ttdeci">odp_queue_param_t queue_param</div><div class="ttdoc">Queue parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00294">api/spec/packet_io_types.h:294</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__param__t_html_a901146fbd15779b5665d3b75f3488e91"><div class="ttname"><a href="structodp__pktin__queue__param__t.html#a901146fbd15779b5665d3b75f3488e91">odp_pktin_queue_param_t::hash_proto</a></div><div class="ttdeci">odp_pktin_hash_proto_t hash_proto</div><div class="ttdoc">Protocol field selection for hashing.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00260">api/spec/packet_io_types.h:260</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__param__t_html_aa90bfc914603a90f7b1f7e7f0de07418"><div class="ttname"><a href="structodp__pktin__queue__param__t.html#aa90bfc914603a90f7b1f7e7f0de07418">odp_pktin_queue_param_t::hash_enable</a></div><div class="ttdeci">odp_bool_t hash_enable</div><div class="ttdoc">Enable flow hashing.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00254">api/spec/packet_io_types.h:254</a></div></div>
<div class="ttc" id="astructodp__pktin__queue__s_html"><div class="ttname"><a href="structodp__pktin__queue__s.html">odp_pktin_queue_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__io__types_8h_source.html#l00057">api/abi-default/packet_io_types.h:57</a></div></div>
<div class="ttc" id="astructodp__pktio__capability__t_html"><div class="ttname"><a href="structodp__pktio__capability__t.html">odp_pktio_capability_t</a></div><div class="ttdoc">Packet IO capabilities.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l01020">api/spec/packet_io_types.h:1020</a></div></div>
<div class="ttc" id="astructodp__pktio__capability__t_html_a41331b30786ec8c9a4861dfe5b220b61"><div class="ttname"><a href="structodp__pktio__capability__t.html#a41331b30786ec8c9a4861dfe5b220b61">odp_pktio_capability_t::max_input_queues</a></div><div class="ttdeci">uint32_t max_input_queues</div><div class="ttdoc">Maximum number of input queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l01024">api/spec/packet_io_types.h:1024</a></div></div>
<div class="ttc" id="astructodp__pktio__capability__t_html_a853625a680b37aeb0839c63ba04c632c"><div class="ttname"><a href="structodp__pktio__capability__t.html#a853625a680b37aeb0839c63ba04c632c">odp_pktio_capability_t::max_output_queues</a></div><div class="ttdeci">uint32_t max_output_queues</div><div class="ttdoc">Maximum number of output queues.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l01039">api/spec/packet_io_types.h:1039</a></div></div>
<div class="ttc" id="astructodp__pktio__config__t_html"><div class="ttname"><a href="structodp__pktio__config__t.html">odp_pktio_config_t</a></div><div class="ttdoc">Packet IO configuration options.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00589">api/spec/packet_io_types.h:589</a></div></div>
<div class="ttc" id="astructodp__pktio__param__t_html"><div class="ttname"><a href="structodp__pktio__param__t.html">odp_pktio_param_t</a></div><div class="ttdoc">Packet IO parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00356">api/spec/packet_io_types.h:356</a></div></div>
<div class="ttc" id="astructodp__pktio__param__t_html_a819cf5e2ef7df43a729cad159c022f4d"><div class="ttname"><a href="structodp__pktio__param__t.html#a819cf5e2ef7df43a729cad159c022f4d">odp_pktio_param_t::in_mode</a></div><div class="ttdeci">odp_pktin_mode_t in_mode</div><div class="ttdoc">Packet input mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00360">api/spec/packet_io_types.h:360</a></div></div>
<div class="ttc" id="astructodp__pktio__param__t_html_afc226fd3904618950a0d1154ffa2fd8c"><div class="ttname"><a href="structodp__pktio__param__t.html#afc226fd3904618950a0d1154ffa2fd8c">odp_pktio_param_t::out_mode</a></div><div class="ttdeci">odp_pktout_mode_t out_mode</div><div class="ttdoc">Packet output mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00365">api/spec/packet_io_types.h:365</a></div></div>
<div class="ttc" id="astructodp__pktout__queue__param__t_html"><div class="ttname"><a href="structodp__pktout__queue__param__t.html">odp_pktout_queue_param_t</a></div><div class="ttdoc">Packet output queue parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00326">api/spec/packet_io_types.h:326</a></div></div>
<div class="ttc" id="astructodp__pktout__queue__param__t_html_a066fd0a2de0efca0056cd1529d78b06e"><div class="ttname"><a href="structodp__pktout__queue__param__t.html#a066fd0a2de0efca0056cd1529d78b06e">odp_pktout_queue_param_t::op_mode</a></div><div class="ttdeci">odp_pktio_op_mode_t op_mode</div><div class="ttdoc">Operation mode.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00332">api/spec/packet_io_types.h:332</a></div></div>
<div class="ttc" id="astructodp__pktout__queue__param__t_html_acd16e77991869797adb3da1bd41a1d0c"><div class="ttname"><a href="structodp__pktout__queue__param__t.html#acd16e77991869797adb3da1bd41a1d0c">odp_pktout_queue_param_t::num_queues</a></div><div class="ttdeci">uint32_t num_queues</div><div class="ttdoc">Number of output queues to be created.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00336">api/spec/packet_io_types.h:336</a></div></div>
<div class="ttc" id="astructodp__pktout__queue__s_html"><div class="ttname"><a href="structodp__pktout__queue__s.html">odp_pktout_queue_s</a></div><div class="ttdef"><b>Definition:</b> <a href="api_2abi-default_2packet__io__types_8h_source.html#l00063">api/abi-default/packet_io_types.h:63</a></div></div>
<div class="ttc" id="astructodp__pool__capability__t_html"><div class="ttname"><a href="structodp__pool__capability__t.html">odp_pool_capability_t</a></div><div class="ttdoc">Pool capabilities.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00184">api/spec/pool_types.h:184</a></div></div>
<div class="ttc" id="astructodp__pool__capability__t_html_a11c2f0606b3bb00a72220d2352f43806"><div class="ttname"><a href="structodp__pool__capability__t.html#a11c2f0606b3bb00a72220d2352f43806">odp_pool_capability_t::pkt</a></div><div class="ttdeci">struct odp_pool_capability_t::@133 pkt</div><div class="ttdoc">Packet pool capabilities</div></div>
<div class="ttc" id="astructodp__pool__capability__t_html_a2b468c5617515bbd5d50a57a7d65e1e0"><div class="ttname"><a href="structodp__pool__capability__t.html#a2b468c5617515bbd5d50a57a7d65e1e0">odp_pool_capability_t::max_num</a></div><div class="ttdeci">uint32_t max_num</div><div class="ttdoc">Maximum number of buffers of any size.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00206">api/spec/pool_types.h:206</a></div></div>
<div class="ttc" id="astructodp__pool__capability__t_html_affefe3b2c3a473c37d08fcd2929e84c2"><div class="ttname"><a href="structodp__pool__capability__t.html#affefe3b2c3a473c37d08fcd2929e84c2">odp_pool_capability_t::max_len</a></div><div class="ttdeci">uint32_t max_len</div><div class="ttdoc">Maximum packet data length in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00247">api/spec/pool_types.h:247</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html"><div class="ttname"><a href="structodp__pool__param__t.html">odp_pool_param_t</a></div><div class="ttdoc">Pool parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00466">api/spec/pool_types.h:466</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_a3598b3a2496629cd45010c1c5e876250"><div class="ttname"><a href="structodp__pool__param__t.html#a3598b3a2496629cd45010c1c5e876250">odp_pool_param_t::num</a></div><div class="ttdeci">uint32_t num</div><div class="ttdoc">Number of buffers in the pool.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00473">api/spec/pool_types.h:473</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_a7f9ca49dc21d48da0d80860c03faec1d"><div class="ttname"><a href="structodp__pool__param__t.html#a7f9ca49dc21d48da0d80860c03faec1d">odp_pool_param_t::pkt</a></div><div class="ttdeci">struct odp_pool_param_t::@138 pkt</div><div class="ttdoc">Parameters for packet pools.</div></div>
<div class="ttc" id="astructodp__pool__param__t_html_aac72ae142dd9736a287ce63d78b71c87"><div class="ttname"><a href="structodp__pool__param__t.html#aac72ae142dd9736a287ce63d78b71c87">odp_pool_param_t::type</a></div><div class="ttdeci">odp_pool_type_t type</div><div class="ttdoc">Pool type.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00468">api/spec/pool_types.h:468</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_ac1ccfa50466f4afa9a9ab72f0bd315bf"><div class="ttname"><a href="structodp__pool__param__t.html#ac1ccfa50466f4afa9a9ab72f0bd315bf">odp_pool_param_t::len</a></div><div class="ttdeci">uint32_t len</div><div class="ttdoc">Minimum length of 'num' packets.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00540">api/spec/pool_types.h:540</a></div></div>
<div class="ttc" id="astructodp__pool__param__t_html_ad400db5955445ee3d1fbb36df456e7f1"><div class="ttname"><a href="structodp__pool__param__t.html#ad400db5955445ee3d1fbb36df456e7f1">odp_pool_param_t::seg_len</a></div><div class="ttdeci">uint32_t seg_len</div><div class="ttdoc">Minimum number of packet data bytes that can be stored in the first segment of a newly allocated pack...</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2pool__types_8h_source.html#l00566">api/spec/pool_types.h:566</a></div></div>
<div class="ttc" id="astructodp__queue__param__t_html"><div class="ttname"><a href="structodp__queue__param__t.html">odp_queue_param_t</a></div><div class="ttdoc">ODP Queue parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2queue__types_8h_source.html#l00239">api/spec/queue_types.h:239</a></div></div>
<div class="ttc" id="astructodp__queue__param__t_html_a371701df4d20cee95978b9265c232e32"><div class="ttname"><a href="structodp__queue__param__t.html#a371701df4d20cee95978b9265c232e32">odp_queue_param_t::sched</a></div><div class="ttdeci">odp_schedule_param_t sched</div><div class="ttdoc">Scheduler parameters.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2queue__types_8h_source.html#l00270">api/spec/queue_types.h:270</a></div></div>
<div class="ttc" id="astructodp__queue__param__t_html_a6a7251138773a3110bdc0e8d5f5b3be9"><div class="ttname"><a href="structodp__queue__param__t.html#a6a7251138773a3110bdc0e8d5f5b3be9">odp_queue_param_t::type</a></div><div class="ttdeci">odp_queue_type_t type</div><div class="ttdoc">Queue type.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2queue__types_8h_source.html#l00244">api/spec/queue_types.h:244</a></div></div>
<div class="ttc" id="astructodp__schedule__param__t_html_a0bc7830a919f31ce295a20c51a7e2648"><div class="ttname"><a href="structodp__schedule__param__t.html#a0bc7830a919f31ce295a20c51a7e2648">odp_schedule_param_t::group</a></div><div class="ttdeci">odp_schedule_group_t group</div><div class="ttdoc">Thread group.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2schedule__types_8h_source.html#l00204">api/spec/schedule_types.h:204</a></div></div>
<div class="ttc" id="astructodp__schedule__param__t_html_a3f103771c3a9319c1ec998fa8724b8ac"><div class="ttname"><a href="structodp__schedule__param__t.html#a3f103771c3a9319c1ec998fa8724b8ac">odp_schedule_param_t::prio</a></div><div class="ttdeci">odp_schedule_prio_t prio</div><div class="ttdoc">Priority level.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2schedule__types_8h_source.html#l00194">api/spec/schedule_types.h:194</a></div></div>
<div class="ttc" id="astructodp__schedule__param__t_html_ad4ca09d63edb0cec36567c26688cea14"><div class="ttname"><a href="structodp__schedule__param__t.html#ad4ca09d63edb0cec36567c26688cea14">odp_schedule_param_t::sync</a></div><div class="ttdeci">odp_schedule_sync_t sync</div><div class="ttdoc">Synchronization method.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2schedule__types_8h_source.html#l00199">api/spec/schedule_types.h:199</a></div></div>
<div class="ttc" id="aunionodp__crypto__auth__algos__t_html_a299c8a6de89108f62c532274cf6bbaef"><div class="ttname"><a href="unionodp__crypto__auth__algos__t.html#a299c8a6de89108f62c532274cf6bbaef">odp_crypto_auth_algos_t::all_bits</a></div><div class="ttdeci">uint64_t all_bits</div><div class="ttdoc">All bits of the bit field structure.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00698">api/spec/crypto_types.h:698</a></div></div>
<div class="ttc" id="aunionodp__crypto__cipher__algos__t_html_ab307f8bf680405191f6f59ccae66dfd3"><div class="ttname"><a href="unionodp__crypto__cipher__algos__t.html#ab307f8bf680405191f6f59ccae66dfd3">odp_crypto_cipher_algos_t::all_bits</a></div><div class="ttdeci">uint64_t all_bits</div><div class="ttdoc">All bits of the bit field structure.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2crypto__types_8h_source.html#l00566">api/spec/crypto_types.h:566</a></div></div>
<div class="ttc" id="aunionodp__pktin__hash__proto__t_html_a23793296c3a0299f69bdacc438ca3caf"><div class="ttname"><a href="unionodp__pktin__hash__proto__t.html#a23793296c3a0299f69bdacc438ca3caf">odp_pktin_hash_proto_t::proto</a></div><div class="ttdeci">struct odp_pktin_hash_proto_t::@106 proto</div><div class="ttdoc">Protocol header fields for hashing.</div></div>
<div class="ttc" id="aunionodp__pktin__hash__proto__t_html_a55c2478785f04914939ed859bdc16839"><div class="ttname"><a href="unionodp__pktin__hash__proto__t.html#a55c2478785f04914939ed859bdc16839">odp_pktin_hash_proto_t::ipv4_udp</a></div><div class="ttdeci">uint32_t ipv4_udp</div><div class="ttdoc">IPv4 addresses and UDP port numbers.</div><div class="ttdef"><b>Definition:</b> <a href="api_2spec_2packet__io__types_8h_source.html#l00128">api/spec/packet_io_types.h:128</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
